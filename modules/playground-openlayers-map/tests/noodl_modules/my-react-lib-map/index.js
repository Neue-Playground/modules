!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=7)}([function(t,e){t.exports=React},function(t,e,n){var r,i;function o(t){return function(t){if(Array.isArray(t))return a(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return a(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,l(r.key),r)}}function l(t){var e=function(t,e){if("object"!=c(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=c(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==c(e)?e:e+""}function c(t){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(o,a){"object"==c(e)&&void 0!==t?t.exports=a():void 0===(i="function"==typeof(r=a)?r.call(e,n,e,t):r)||(t.exports=i)}(0,(function(){"use strict";function t(r,i){for(var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:r.length-1,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:n;a>o;){if(a-o>600){var s=a-o+1,l=i-o+1,c=Math.log(s),f=.5*Math.exp(2*c/3),h=.5*Math.sqrt(c*f*(s-f)/s)*(l-s/2<0?-1:1);t(r,i,Math.max(o,Math.floor(i-l*f/s+h)),Math.min(a,Math.floor(i+(s-l)*f/s+h)),u)}var y=r[i],p=o,d=a;for(e(r,o,i),u(r[a],y)>0&&e(r,o,a);p<d;){for(e(r,p,d),p++,d--;u(r[p],y)<0;)p++;for(;u(r[d],y)>0;)d--}0===u(r[o],y)?e(r,o,d):e(r,++d,a),d<=i&&(o=d+1),i<=d&&(a=d-1)}}function e(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function n(t,e){return t<e?-1:t>e?1:0}function r(t,e,n){if(!n)return e.indexOf(t);for(var r=0;r<e.length;r++)if(n(t,e[r]))return r;return-1}function i(t,e){a(t,0,t.children.length,e,t)}function a(t,e,n,r,i){i||(i=g(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var o=e;o<n;o++){var a=t.children[o];l(i,t.leaf?r(a):a)}return i}function l(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function c(t,e){return t.minX-e.minX}function f(t,e){return t.minY-e.minY}function h(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function y(t){return t.maxX-t.minX+(t.maxY-t.minY)}function p(t,e){var n=Math.max(t.minX,e.minX),r=Math.max(t.minY,e.minY),i=Math.min(t.maxX,e.maxX),o=Math.min(t.maxY,e.maxY);return Math.max(0,i-n)*Math.max(0,o-r)}function d(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function v(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function g(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function m(e,n,r,i,o){for(var a=[n,r];a.length;)if(!((r=a.pop())-(n=a.pop())<=i)){var u=n+Math.ceil((r-n)/i/2)*i;t(e,u,n,r,o),a.push(n,u,u,r)}}return function(){return function(t,e,n){return e&&s(t.prototype,e),n&&s(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}((function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:9;u(this,t),this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()}),[{key:"all",value:function(){return this._all(this.data,[])}},{key:"search",value:function(t){var e=this.data,n=[];if(!v(t,e))return n;for(var r=this.toBBox,i=[];e;){for(var o=0;o<e.children.length;o++){var a=e.children[o],u=e.leaf?r(a):a;v(t,u)&&(e.leaf?n.push(a):d(t,u)?this._all(a,n):i.push(a))}e=i.pop()}return n}},{key:"collides",value:function(t){var e=this.data;if(!v(t,e))return!1;for(var n=[];e;){for(var r=0;r<e.children.length;r++){var i=e.children[r],o=e.leaf?this.toBBox(i):i;if(v(t,o)){if(e.leaf||d(t,o))return!0;n.push(i)}}e=n.pop()}return!1}},{key:"load",value:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this}},{key:"insert",value:function(t){return t&&this._insert(t,this.data.height-1),this}},{key:"clear",value:function(){return this.data=g([]),this}},{key:"remove",value:function(t,e){if(!t)return this;for(var n,i,o,a=this.data,u=this.toBBox(t),s=[],l=[];a||s.length;){if(a||(a=s.pop(),i=s[s.length-1],n=l.pop(),o=!0),a.leaf){var c=r(t,a.children,e);if(-1!==c)return a.children.splice(c,1),s.push(a),this._condense(s),this}o||a.leaf||!d(a,u)?i?(n++,a=i.children[n],o=!1):a=null:(s.push(a),l.push(n),n=0,i=a,a=a.children[0])}return this}},{key:"toBBox",value:function(t){return t}},{key:"compareMinX",value:function(t,e){return t.minX-e.minX}},{key:"compareMinY",value:function(t,e){return t.minY-e.minY}},{key:"toJSON",value:function(){return this.data}},{key:"fromJSON",value:function(t){return this.data=t,this}},{key:"_all",value:function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,o(t.children)):n.push.apply(n,o(t.children)),t=n.pop();return e}},{key:"_build",value:function(t,e,n,r){var o,a=n-e+1,u=this._maxEntries;if(a<=u)return i(o=g(t.slice(e,n+1)),this.toBBox),o;r||(r=Math.ceil(Math.log(a)/Math.log(u)),u=Math.ceil(a/Math.pow(u,r-1))),(o=g([])).leaf=!1,o.height=r;var s=Math.ceil(a/u),l=s*Math.ceil(Math.sqrt(u));m(t,e,n,l,this.compareMinX);for(var c=e;c<=n;c+=l){var f=Math.min(c+l-1,n);m(t,c,f,s,this.compareMinY);for(var h=c;h<=f;h+=s){var y=Math.min(h+s-1,f);o.children.push(this._build(t,h,y,r-1))}}return i(o,this.toBBox),o}},{key:"_chooseSubtree",value:function(t,e,n,r){for(;r.push(e),!e.leaf&&r.length-1!==n;){for(var i=void 0,o=1/0,a=1/0,u=0;u<e.children.length;u++){var s=e.children[u],l=h(s),c=(f=t,y=s,(Math.max(y.maxX,f.maxX)-Math.min(y.minX,f.minX))*(Math.max(y.maxY,f.maxY)-Math.min(y.minY,f.minY))-l);c<a?(a=c,o=l<o?l:o,i=s):c===a&&l<o&&(o=l,i=s)}e=i||e.children[0]}var f,y;return e}},{key:"_insert",value:function(t,e,n){var r=n?t:this.toBBox(t),i=[],o=this._chooseSubtree(r,this.data,e,i);for(o.children.push(t),l(o,r);e>=0&&i[e].children.length>this._maxEntries;)this._split(i,e),e--;this._adjustParentBBoxes(r,i,e)}},{key:"_split",value:function(t,e){var n=t[e],r=n.children.length,o=this._minEntries;this._chooseSplitAxis(n,o,r);var a=this._chooseSplitIndex(n,o,r),u=g(n.children.splice(a,n.children.length-a));u.height=n.height,u.leaf=n.leaf,i(n,this.toBBox),i(u,this.toBBox),e?t[e-1].children.push(u):this._splitRoot(n,u)}},{key:"_splitRoot",value:function(t,e){this.data=g([t,e]),this.data.height=t.height+1,this.data.leaf=!1,i(this.data,this.toBBox)}},{key:"_chooseSplitIndex",value:function(t,e,n){for(var r,i=1/0,o=1/0,u=e;u<=n-e;u++){var s=a(t,0,u,this.toBBox),l=a(t,u,n,this.toBBox),c=p(s,l),f=h(s)+h(l);c<i?(i=c,r=u,o=f<o?f:o):c===i&&f<o&&(o=f,r=u)}return r||n-e}},{key:"_chooseSplitAxis",value:function(t,e,n){var r=t.leaf?this.compareMinX:c,i=t.leaf?this.compareMinY:f;this._allDistMargin(t,e,n,r)<this._allDistMargin(t,e,n,i)&&t.children.sort(r)}},{key:"_allDistMargin",value:function(t,e,n,r){t.children.sort(r);for(var i=this.toBBox,o=a(t,0,e,i),u=a(t,n-e,n,i),s=y(o)+y(u),c=e;c<n-e;c++){var f=t.children[c];l(o,t.leaf?i(f):f),s+=y(o)}for(var h=n-e-1;h>=e;h--){var p=t.children[h];l(u,t.leaf?i(p):p),s+=y(u)}return s}},{key:"_adjustParentBBoxes",value:function(t,e,n){for(var r=n;r>=0;r--)l(e[r],t)}},{key:"_condense",value:function(t){for(var e,n=t.length-1;n>=0;n--)0===t[n].children.length?n>0?(e=t[n-1].children).splice(e.indexOf(t[n]),1):this.clear():i(t[n],this.toBBox)}}])}()}))},,,,,,function(t,e,n){var r=n(8),i=n(14).default,o=r.defineReactNode({name:"Map Component",category:"Tutorial",getReactComponent:function(){return i},inputProps:{isInteractive:{displayName:"Is Interactive",group:"Interactive",type:"boolean",default:!0},zoom:{displayName:"Zoom",group:"Coordinates",type:"number",default:2},longitude:{displayName:"Longitude",group:"Coordinates",type:"number",default:0},latitude:{displayName:"Latitude",group:"Coordinates",type:"number",default:0},pins:{displayName:"Pins",group:"Pins",type:"array",default:[{label:"Pin 1",longitude:-.1276,latitude:51.5074,description:"London, UK"},{label:"Pin 2",longitude:2.3522,latitude:48.8566,description:"Paris, France"},{label:"Pin 3",longitude:12.4964,latitude:41.9028,description:"Rome, Italy"}]},pointA:{displayName:"Point A",group:"Points",type:"object",default:{}},pointB:{displayName:"Point B",group:"Points",type:"object",default:{}}},outputProps:{onPinClicked:{type:"signal",displayName:"On Pin Clicked"},onMapClick:{type:"signal",displayName:"On Map Clicked"},onViewChange:{type:"signal",displayName:"On View Change"}}});r.defineModule({reactNodes:[o],nodes:[],setup:function(){}})},function(t,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var r={purple:"component",green:"data",default:"default",grey:"default"};Noodl.defineNode=function(t){var e={};for(var i in e.name=t.name,e.displayNodeName=t.displayName,e.usePortAsLabel=t.useInputAsLabel,e.color=r[t.color||"default"],e.category=t.category||"Modules",e.getInspectInfo=t.getInspectInfo,e.docs=t.docs,e.initialize=function(){this.inputs={};var e=this.outputs={},n=this;this.setOutputs=function(t){for(var r in t)e[r]=t[r],n.flagOutputDirty(r)},this.clearWarnings=function(){this.context.editorConnection&&this.nodeScope&&this.nodeScope.componentOwner&&this.context.editorConnection.clearWarnings(this.nodeScope.componentOwner.name,this.id)}.bind(this),this.sendWarning=function(t,e){this.context.editorConnection&&this.nodeScope&&this.nodeScope.componentOwner&&this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name,this.id,t,{message:e})}.bind(this),"function"==typeof t.initialize&&t.initialize.apply(this)},e.inputs={},e.outputs={},t.inputs)e.inputs[i]={type:"object"===n(t.inputs[i])?t.inputs[i].type:t.inputs[i],displayName:"object"===n(t.inputs[i])?t.inputs[i].displayName:void 0,group:"object"===n(t.inputs[i])?t.inputs[i].group:void 0,default:"object"===n(t.inputs[i])?t.inputs[i].default:void 0,set:function(){var e=i;return function(n){this.inputs[e]=n,t.changed&&"function"==typeof t.changed[e]&&t.changed[e].apply(this,[n])}}()};for(var i in t.signals)e.inputs[i]={type:"signal",displayName:"object"===n(t.signals[i])?t.signals[i].displayName:void 0,group:"object"===n(t.signals[i])?t.signals[i].group:void 0,valueChangedToTrue:function(){var e=i;return function(){var r=this,i="object"===n(t.signals[e])?t.signals[e].signal:t.signals[e];"function"==typeof i&&this.scheduleAfterInputsHaveUpdated((function(){i.apply(r)}))}}()};for(var i in t.outputs)"signal"===t.outputs[i]?e.outputs[i]={type:"signal"}:e.outputs[i]={type:"object"===n(t.outputs[i])?t.outputs[i].type:t.outputs[i],displayName:"object"===n(t.outputs[i])?t.outputs[i].displayName:void 0,group:"object"===n(t.outputs[i])?t.outputs[i].group:void 0,getter:function(){var t=i;return function(){return this.outputs[t]}}()};for(var i in e.methods=e.prototypeExtensions={},t.methods)e.prototypeExtensions[i]=t.methods[i];return e.methods.onNodeDeleted&&(e.methods._onNodeDeleted=function(){this.__proto__.__proto__._onNodeDeleted.call(this),e.methods.onNodeDeleted.value.call(this)}),{node:e,setup:t.setup}},Noodl.defineCollectionNode=function(t){var e={name:t.name,category:t.category,color:"data",inputs:t.inputs,outputs:Object.assign({Items:"array","Fetch Started":"signal","Fetch Completed":"signal"},t.outputs||{}),signals:Object.assign({Fetch:function(){var e=this;this.sendSignalOnOutput("Fetch Started");var n=t.fetch.call(this,(function(){e.sendSignalOnOutput("Fetch Completed")}));this.setOutputs({Items:n})}},t.signals||{})};return Noodl.defineNode(e)},Noodl.defineModelNode=function(t){var e={name:t.name,category:t.category,color:"data",inputs:{Id:"string"},outputs:{Fetched:"signal"},changed:{Id:function(t){var e=this;this._object&&this._changeListener&&this._object.off("change",this._changeListener),this._object=Noodl.Object.get(t),this._changeListener=function(t,n){var r={};r[t]=n,e.setOutputs(r)},this._object.on("change",this._changeListener),this.setOutputs(this._object.data),this.sendSignalOnOutput("Fetched")}},initialize:function(){}};for(var n in t.properties)e.inputs[n]=t.properties[n],e.outputs[n]=t.properties[n],e.changed[n]=function(){var t=n;return function(e){this._object&&this._object.set(t,e)}}();return Noodl.defineNode(e)},Noodl.defineReactNode=function(t){var e=Noodl.defineNode(t);return e.node.getReactComponent=t.getReactComponent,e.node.inputProps=t.inputProps,e.node.inputCss=t.inputCss,e.node.outputProps=t.outputProps,e.node.setup=t.setup,e.node.frame=t.frame,e.node},t.exports=Noodl},function(t,e,n){var r=n(10);"string"==typeof r&&(r=[[t.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(12)(r,i);r.locals&&(t.exports=r.locals)},function(t,e,n){(t.exports=n(11)(!1)).push([t.i,':root,\n:host {\n  --ol-background-color: white;\n  --ol-accent-background-color: #F5F5F5;\n  --ol-subtle-background-color: rgba(128, 128, 128, 0.25);\n  --ol-partial-background-color: rgba(255, 255, 255, 0.75);\n  --ol-foreground-color: #333333;\n  --ol-subtle-foreground-color: #666666;\n  --ol-brand-color: #00AAFF;\n}\n\n.ol-box {\n  box-sizing: border-box;\n  border-radius: 2px;\n  border: 1.5px solid var(--ol-background-color);\n  background-color: var(--ol-partial-background-color);\n}\n\n.ol-mouse-position {\n  top: 8px;\n  right: 8px;\n  position: absolute;\n}\n\n.ol-scale-line {\n  background: var(--ol-partial-background-color);\n  border-radius: 4px;\n  bottom: 8px;\n  left: 8px;\n  padding: 2px;\n  position: absolute;\n}\n\n.ol-scale-line-inner {\n  border: 1px solid var(--ol-subtle-foreground-color);\n  border-top: none;\n  color: var(--ol-foreground-color);\n  font-size: 10px;\n  text-align: center;\n  margin: 1px;\n  will-change: contents, width;\n  transition: all 0.25s;\n}\n\n.ol-scale-bar {\n  position: absolute;\n  bottom: 8px;\n  left: 8px;\n}\n\n.ol-scale-bar-inner {\n  display: flex;\n}\n\n.ol-scale-step-marker {\n  width: 1px;\n  height: 15px;\n  background-color: var(--ol-foreground-color);\n  float: right;\n  z-index: 10;\n}\n\n.ol-scale-step-text {\n  position: absolute;\n  bottom: -5px;\n  font-size: 10px;\n  z-index: 11;\n  color: var(--ol-foreground-color);\n  text-shadow: -1.5px 0 var(--ol-partial-background-color), 0 1.5px var(--ol-partial-background-color), 1.5px 0 var(--ol-partial-background-color), 0 -1.5px var(--ol-partial-background-color);\n}\n\n.ol-scale-text {\n  position: absolute;\n  font-size: 12px;\n  text-align: center;\n  bottom: 25px;\n  color: var(--ol-foreground-color);\n  text-shadow: -1.5px 0 var(--ol-partial-background-color), 0 1.5px var(--ol-partial-background-color), 1.5px 0 var(--ol-partial-background-color), 0 -1.5px var(--ol-partial-background-color);\n}\n\n.ol-scale-singlebar {\n  position: relative;\n  height: 10px;\n  z-index: 9;\n  box-sizing: border-box;\n  border: 1px solid var(--ol-foreground-color);\n}\n\n.ol-scale-singlebar-even {\n  background-color: var(--ol-subtle-foreground-color);\n}\n\n.ol-scale-singlebar-odd {\n  background-color: var(--ol-background-color);\n}\n\n.ol-unsupported {\n  display: none;\n}\n\n.ol-viewport,\n.ol-unselectable {\n  -webkit-touch-callout: none;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  user-select: none;\n  -webkit-tap-highlight-color: transparent;\n}\n\n.ol-viewport canvas {\n  all: unset;\n  overflow: hidden;\n}\n\n.ol-viewport {\n  touch-action: pan-x pan-y;\n}\n\n.ol-selectable {\n  -webkit-touch-callout: default;\n  -webkit-user-select: text;\n  -moz-user-select: text;\n  user-select: text;\n}\n\n.ol-grabbing {\n  cursor: -webkit-grabbing;\n  cursor: -moz-grabbing;\n  cursor: grabbing;\n}\n\n.ol-grab {\n  cursor: move;\n  cursor: -webkit-grab;\n  cursor: -moz-grab;\n  cursor: grab;\n}\n\n.ol-control {\n  position: absolute;\n  background-color: var(--ol-subtle-background-color);\n  border-radius: 4px;\n}\n\n.ol-zoom {\n  top: .5em;\n  left: .5em;\n}\n\n.ol-rotate {\n  top: .5em;\n  right: .5em;\n  transition: opacity .25s linear, visibility 0s linear;\n}\n\n.ol-rotate.ol-hidden {\n  opacity: 0;\n  visibility: hidden;\n  transition: opacity .25s linear, visibility 0s linear .25s;\n}\n\n.ol-zoom-extent {\n  top: 4.643em;\n  left: .5em;\n}\n\n.ol-full-screen {\n  right: .5em;\n  top: .5em;\n}\n\n.ol-control button {\n  display: block;\n  margin: 1px;\n  padding: 0;\n  color: var(--ol-subtle-foreground-color);\n  font-weight: bold;\n  text-decoration: none;\n  font-size: inherit;\n  text-align: center;\n  height: 1.375em;\n  width: 1.375em;\n  line-height: .4em;\n  background-color: var(--ol-background-color);\n  border: none;\n  border-radius: 2px;\n}\n\n.ol-control button::-moz-focus-inner {\n  border: none;\n  padding: 0;\n}\n\n.ol-zoom-extent button {\n  line-height: 1.4em;\n}\n\n.ol-compass {\n  display: block;\n  font-weight: normal;\n  will-change: transform;\n}\n\n.ol-touch .ol-control button {\n  font-size: 1.5em;\n}\n\n.ol-touch .ol-zoom-extent {\n  top: 5.5em;\n}\n\n.ol-control button:hover,\n.ol-control button:focus {\n  text-decoration: none;\n  outline: 1px solid var(--ol-subtle-foreground-color);\n  color: var(--ol-foreground-color);\n}\n\n.ol-zoom .ol-zoom-in {\n  border-radius: 2px 2px 0 0;\n}\n\n.ol-zoom .ol-zoom-out {\n  border-radius: 0 0 2px 2px;\n}\n\n.ol-attribution {\n  text-align: right;\n  bottom: .5em;\n  right: .5em;\n  max-width: calc(100% - 1.3em);\n  display: flex;\n  flex-flow: row-reverse;\n  align-items: center;\n}\n\n.ol-attribution a {\n  color: var(--ol-subtle-foreground-color);\n  text-decoration: none;\n}\n\n.ol-attribution ul {\n  margin: 0;\n  padding: 1px .5em;\n  color: var(--ol-foreground-color);\n  text-shadow: 0 0 2px var(--ol-background-color);\n  font-size: 12px;\n}\n\n.ol-attribution li {\n  display: inline;\n  list-style: none;\n}\n\n.ol-attribution li:not(:last-child):after {\n  content: " ";\n}\n\n.ol-attribution img {\n  max-height: 2em;\n  max-width: inherit;\n  vertical-align: middle;\n}\n\n.ol-attribution button {\n  flex-shrink: 0;\n}\n\n.ol-attribution.ol-collapsed ul {\n  display: none;\n}\n\n.ol-attribution:not(.ol-collapsed) {\n  background: var(--ol-partial-background-color);\n}\n\n.ol-attribution.ol-uncollapsible {\n  bottom: 0;\n  right: 0;\n  border-radius: 4px 0 0;\n}\n\n.ol-attribution.ol-uncollapsible img {\n  margin-top: -.2em;\n  max-height: 1.6em;\n}\n\n.ol-attribution.ol-uncollapsible button {\n  display: none;\n}\n\n.ol-zoomslider {\n  top: 4.5em;\n  left: .5em;\n  height: 200px;\n}\n\n.ol-zoomslider button {\n  position: relative;\n  height: 10px;\n}\n\n.ol-touch .ol-zoomslider {\n  top: 5.5em;\n}\n\n.ol-overviewmap {\n  left: 0.5em;\n  bottom: 0.5em;\n}\n\n.ol-overviewmap.ol-uncollapsible {\n  bottom: 0;\n  left: 0;\n  border-radius: 0 4px 0 0;\n}\n\n.ol-overviewmap .ol-overviewmap-map,\n.ol-overviewmap button {\n  display: block;\n}\n\n.ol-overviewmap .ol-overviewmap-map {\n  border: 1px solid var(--ol-subtle-foreground-color);\n  height: 150px;\n  width: 150px;\n}\n\n.ol-overviewmap:not(.ol-collapsed) button {\n  bottom: 0;\n  left: 0;\n  position: absolute;\n}\n\n.ol-overviewmap.ol-collapsed .ol-overviewmap-map,\n.ol-overviewmap.ol-uncollapsible button {\n  display: none;\n}\n\n.ol-overviewmap:not(.ol-collapsed) {\n  background: var(--ol-subtle-background-color);\n}\n\n.ol-overviewmap-box {\n  border: 1.5px dotted var(--ol-subtle-foreground-color);\n}\n\n.ol-overviewmap .ol-overviewmap-box:hover {\n  cursor: move;\n}\n\n.ol-overviewmap .ol-viewport:hover {\n  cursor: pointer;\n}\n',""])},function(t,e,n){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n=function(t,e){var n=t[1]||"",r=t[3];if(!r)return n;if(e&&"function"==typeof btoa){var i=(a=r,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(a))))+" */"),o=r.sources.map((function(t){return"/*# sourceURL="+r.sourceRoot+t+" */"}));return[n].concat(o).concat([i]).join("\n")}var a;return[n].join("\n")}(e,t);return e[2]?"@media "+e[2]+"{"+n+"}":n})).join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var r={},i=0;i<this.length;i++){var o=this[i][0];null!=o&&(r[o]=!0)}for(i=0;i<t.length;i++){var a=t[i];null!=a[0]&&r[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),e.push(a))}},e}},function(t,e,n){var r,i,o={},a=(r=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===i&&(i=r.apply(this,arguments)),i}),u=function(t,e){return e?e.querySelector(t):document.querySelector(t)},s=function(t){var e={};return function(t,n){if("function"==typeof t)return t();if(void 0===e[t]){var r=u.call(this,t,n);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(t){r=null}e[t]=r}return e[t]}}(),l=null,c=0,f=[],h=n(13);function y(t,e){for(var n=0;n<t.length;n++){var r=t[n],i=o[r.id];if(i){i.refs++;for(var a=0;a<i.parts.length;a++)i.parts[a](r.parts[a]);for(;a<r.parts.length;a++)i.parts.push(b(r.parts[a],e))}else{var u=[];for(a=0;a<r.parts.length;a++)u.push(b(r.parts[a],e));o[r.id]={id:r.id,refs:1,parts:u}}}}function p(t,e){for(var n=[],r={},i=0;i<t.length;i++){var o=t[i],a=e.base?o[0]+e.base:o[0],u={css:o[1],media:o[2],sourceMap:o[3]};r[a]?r[a].parts.push(u):n.push(r[a]={id:a,parts:[u]})}return n}function d(t,e){var n=s(t.insertInto);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var r=f[f.length-1];if("top"===t.insertAt)r?r.nextSibling?n.insertBefore(e,r.nextSibling):n.appendChild(e):n.insertBefore(e,n.firstChild),f.push(e);else if("bottom"===t.insertAt)n.appendChild(e);else{if("object"!=typeof t.insertAt||!t.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var i=s(t.insertAt.before,n);n.insertBefore(e,i)}}function v(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t);var e=f.indexOf(t);e>=0&&f.splice(e,1)}function g(t){var e=document.createElement("style");if(void 0===t.attrs.type&&(t.attrs.type="text/css"),void 0===t.attrs.nonce){var r=function(){0;return n.nc}();r&&(t.attrs.nonce=r)}return m(e,t.attrs),d(t,e),e}function m(t,e){Object.keys(e).forEach((function(n){t.setAttribute(n,e[n])}))}function b(t,e){var n,r,i,o;if(e.transform&&t.css){if(!(o="function"==typeof e.transform?e.transform(t.css):e.transform.default(t.css)))return function(){};t.css=o}if(e.singleton){var a=c++;n=l||(l=g(e)),r=S.bind(null,n,a,!1),i=S.bind(null,n,a,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=function(t){var e=document.createElement("link");return void 0===t.attrs.type&&(t.attrs.type="text/css"),t.attrs.rel="stylesheet",m(e,t.attrs),d(t,e),e}(e),r=O.bind(null,n,e),i=function(){v(n),n.href&&URL.revokeObjectURL(n.href)}):(n=g(e),r=x.bind(null,n),i=function(){v(n)});return r(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;r(t=e)}else i()}}t.exports=function(t,e){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(e=e||{}).attrs="object"==typeof e.attrs?e.attrs:{},e.singleton||"boolean"==typeof e.singleton||(e.singleton=a()),e.insertInto||(e.insertInto="head"),e.insertAt||(e.insertAt="bottom");var n=p(t,e);return y(n,e),function(t){for(var r=[],i=0;i<n.length;i++){var a=n[i];(u=o[a.id]).refs--,r.push(u)}t&&y(p(t,e),e);for(i=0;i<r.length;i++){var u;if(0===(u=r[i]).refs){for(var s=0;s<u.parts.length;s++)u.parts[s]();delete o[u.id]}}}};var _,w=(_=[],function(t,e){return _[t]=e,_.filter(Boolean).join("\n")});function S(t,e,n,r){var i=n?"":r.css;if(t.styleSheet)t.styleSheet.cssText=w(e,i);else{var o=document.createTextNode(i),a=t.childNodes;a[e]&&t.removeChild(a[e]),a.length?t.insertBefore(o,a[e]):t.appendChild(o)}}function x(t,e){var n=e.css,r=e.media;if(r&&t.setAttribute("media",r),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}function O(t,e,n){var r=n.css,i=n.sourceMap,o=void 0===e.convertToAbsoluteUrls&&i;(e.convertToAbsoluteUrls||o)&&(r=h(r)),i&&(r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */");var a=new Blob([r],{type:"text/css"}),u=t.href;t.href=URL.createObjectURL(a),u&&URL.revokeObjectURL(u)}},function(t,e){t.exports=function(t){var e="undefined"!=typeof window&&window.location;if(!e)throw new Error("fixUrls requires window.location");if(!t||"string"!=typeof t)return t;var n=e.protocol+"//"+e.host,r=n+e.pathname.replace(/\/[^\/]*$/,"/");return t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,(function(t,e){var i,o=e.trim().replace(/^"(.*)"$/,(function(t,e){return e})).replace(/^'(.*)'$/,(function(t,e){return e}));return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(o)?t:(i=0===o.indexOf("//")?o:0===o.indexOf("/")?n+o:r+o.replace(/^\.\//,""),"url("+JSON.stringify(i)+")")}))}},function(t,e,n){"use strict";n.r(e);var r=n(0),i=n.n(r);n(9);function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,u(r.key),r)}}function u(t){var e=function(t,e){if("object"!=o(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==o(e)?e:e+""}var s=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null},(e=[{key:"preventDefault",value:function(){this.defaultPrevented=!0}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}}])&&a(t.prototype,e),n&&a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}(),l="propertychange";function c(t){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,h(r.key),r)}}function h(t){var e=function(t,e){if("object"!=c(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=c(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==c(e)?e:e+""}var y=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.disposed=!1},(e=[{key:"dispose",value:function(){this.disposed||(this.disposed=!0,this.disposeInternal())}},{key:"disposeInternal",value:function(){}}])&&f(t.prototype,e),n&&f(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}();function p(t,e){return t>e?1:t<e?-1:0}function d(t,e,n){if(t[0]<=e)return 0;var r=t.length;if(e<=t[r-1])return r-1;if("function"==typeof n){for(var i=1;i<r;++i){var o=t[i];if(o===e)return i;if(o<e)return n(e,t[i-1],o)>0?i-1:i}return r-1}if(n>0){for(var a=1;a<r;++a)if(t[a]<e)return a-1;return r-1}if(n<0){for(var u=1;u<r;++u)if(t[u]<=e)return u;return r-1}for(var s=1;s<r;++s){if(t[s]==e)return s;if(t[s]<e)return t[s-1]-e<e-t[s]?s-1:s}return r-1}function v(t,e,n){for(;e<n;){var r=t[e];t[e]=t[n],t[n]=r,++e,--n}}function g(t,e){for(var n=Array.isArray(e)?e:[e],r=n.length,i=0;i<r;i++)t[t.length]=n[i]}function m(t,e){var n=t.length;if(n!==e.length)return!1;for(var r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}function b(){return!0}function _(){return!1}function w(){}function S(t){var e,n,r;return function(){var i=Array.prototype.slice.call(arguments);return n&&this===r&&m(i,n)||(r=this,n=i,e=t.apply(this,arguments)),e}}function x(t){return function(){var e;try{e=t()}catch(t){return Promise.reject(t)}return e instanceof Promise?e:Promise.resolve(e)}()}function O(t){for(var e in t)delete t[e]}function k(t){var e;for(e in t)return!1;return!e}function P(t){return(P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function E(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,j(r.key),r)}}function j(t){var e=function(t,e){if("object"!=P(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=P(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==P(e)?e:e+""}function C(t,e,n){return e=T(e),function(t,e){if(e&&("object"==P(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],T(t).constructor):e.apply(t,n))}function T(t){return(T=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function R(t,e){return(R=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var I=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=C(this,e)).eventTarget_=t,n.pendingRemovals_=null,n.dispatching_=null,n.listeners_=null,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&R(t,e)}(e,t),n=e,(r=[{key:"addEventListener",value:function(t,e){if(t&&e){var n=this.listeners_||(this.listeners_={}),r=n[t]||(n[t]=[]);r.includes(e)||r.push(e)}}},{key:"dispatchEvent",value:function(t){var e="string"==typeof t,n=e?t:t.type,r=this.listeners_&&this.listeners_[n];if(r){var i=e?new s(t):t;i.target||(i.target=this.eventTarget_||this);var o,a=this.dispatching_||(this.dispatching_={}),u=this.pendingRemovals_||(this.pendingRemovals_={});n in a||(a[n]=0,u[n]=0),++a[n];for(var l=0,c=r.length;l<c;++l)if(!1===(o="handleEvent"in r[l]?r[l].handleEvent(i):r[l].call(this,i))||i.propagationStopped){o=!1;break}if(0==--a[n]){var f=u[n];for(delete u[n];f--;)this.removeEventListener(n,w);delete a[n]}return o}}},{key:"disposeInternal",value:function(){this.listeners_&&O(this.listeners_)}},{key:"getListeners",value:function(t){return this.listeners_&&this.listeners_[t]||void 0}},{key:"hasListener",value:function(t){return!!this.listeners_&&(t?t in this.listeners_:Object.keys(this.listeners_).length>0)}},{key:"removeEventListener",value:function(t,e){if(this.listeners_){var n=this.listeners_[t];if(n){var r=n.indexOf(e);-1!==r&&(this.pendingRemovals_&&t in this.pendingRemovals_?(n[r]=w,++this.pendingRemovals_[t]):(n.splice(r,1),0===n.length&&delete this.listeners_[t]))}}}}])&&E(n.prototype,r),i&&E(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(y),M="change",L="error",A="contextmenu",F="click",D="dblclick",N="keydown",z="keypress",B="load",G="touchmove",W="wheel";function X(t,e,n,r,i){if(i){var o=n;n=function(){t.removeEventListener(e,n),o.apply(null!=r?r:this,arguments)}}else r&&r!==t&&(n=n.bind(r));var a={target:t,type:e,listener:n};return t.addEventListener(e,n),a}function Y(t,e,n,r){return X(t,e,n,r,!0)}function K(t){t&&t.target&&(t.target.removeEventListener(t.type,t.listener),O(t))}function Z(t){return(Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function U(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,V(r.key),r)}}function V(t){var e=function(t,e){if("object"!=Z(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Z(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Z(e)?e:e+""}function q(t,e,n){return e=H(e),function(t,e){if(e&&("object"==Z(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],H(t).constructor):e.apply(t,n))}function H(t){return(H=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function J(t,e){return(J=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var $=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=q(this,e)).on=t.onInternal,t.once=t.onceInternal,t.un=t.unInternal,t.revision_=0,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&J(t,e)}(e,t),n=e,(r=[{key:"changed",value:function(){++this.revision_,this.dispatchEvent(M)}},{key:"getRevision",value:function(){return this.revision_}},{key:"onInternal",value:function(t,e){if(Array.isArray(t)){for(var n=t.length,r=new Array(n),i=0;i<n;++i)r[i]=X(this,t[i],e);return r}return X(this,t,e)}},{key:"onceInternal",value:function(t,e){var n;if(Array.isArray(t)){var r=t.length;n=new Array(r);for(var i=0;i<r;++i)n[i]=Y(this,t[i],e)}else n=Y(this,t,e);return e.ol_key=n,n}},{key:"unInternal",value:function(t,e){var n=e.ol_key;if(n)!function(t){if(Array.isArray(t))for(var e=0,n=t.length;e<n;++e)K(t[e]);else K(t)}(n);else if(Array.isArray(t))for(var r=0,i=t.length;r<i;++r)this.removeEventListener(t[r],e);else this.removeEventListener(t,e)}}])&&U(n.prototype,r),i&&U(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(I);$.prototype.on,$.prototype.once,$.prototype.un;var Q=$;function tt(){throw new Error("Unimplemented abstract method.")}var et=0;function nt(t){return t.ol_uid||(t.ol_uid=String(++et))}function rt(t){return(rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function it(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,at(r.key),r)}}function ot(t,e,n){return e&&it(t.prototype,e),n&&it(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function at(t){var e=function(t,e){if("object"!=rt(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=rt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==rt(e)?e:e+""}function ut(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function st(t,e,n){return e=lt(e),function(t,e){if(e&&("object"==rt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],lt(t).constructor):e.apply(t,n))}function lt(t){return(lt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ct(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ft(t,e)}function ft(t,e){return(ft=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var ht=function(t){function e(t,n,r){var i;return ut(this,e),(i=st(this,e,[t])).key=n,i.oldValue=r,i}return ct(e,t),ot(e)}(s),yt=function(t){function e(t){var n;return ut(this,e),(n=st(this,e)).on,n.once,n.un,nt(n),n.values_=null,void 0!==t&&n.setProperties(t),n}return ct(e,t),ot(e,[{key:"get",value:function(t){var e;return this.values_&&this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e}},{key:"getKeys",value:function(){return this.values_&&Object.keys(this.values_)||[]}},{key:"getProperties",value:function(){return this.values_&&Object.assign({},this.values_)||{}}},{key:"getPropertiesInternal",value:function(){return this.values_}},{key:"hasProperties",value:function(){return!!this.values_}},{key:"notify",value:function(t,e){var n;n="change:".concat(t),this.hasListener(n)&&this.dispatchEvent(new ht(n,t,e)),n=l,this.hasListener(n)&&this.dispatchEvent(new ht(n,t,e))}},{key:"addChangeListener",value:function(t,e){this.addEventListener("change:".concat(t),e)}},{key:"removeChangeListener",value:function(t,e){this.removeEventListener("change:".concat(t),e)}},{key:"set",value:function(t,e,n){var r=this.values_||(this.values_={});if(n)r[t]=e;else{var i=r[t];r[t]=e,i!==e&&this.notify(t,i)}}},{key:"setProperties",value:function(t,e){for(var n in t)this.set(n,t[n],e)}},{key:"applyProperties",value:function(t){t.values_&&Object.assign(this.values_||(this.values_={}),t.values_)}},{key:"unset",value:function(t,e){if(this.values_&&t in this.values_){var n=this.values_[t];delete this.values_[t],k(this.values_)&&(this.values_=null),e||this.notify(t,n)}}}])}(Q),pt=0,dt=1,vt={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};var gt={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};function mt(t){return(mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function bt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_t(r.key),r)}}function _t(t){var e=function(t,e){if("object"!=mt(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=mt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==mt(e)?e:e+""}var wt=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.code_=e.code,this.units_=e.units,this.extent_=void 0!==e.extent?e.extent:null,this.worldExtent_=void 0!==e.worldExtent?e.worldExtent:null,this.axisOrientation_=void 0!==e.axisOrientation?e.axisOrientation:"enu",this.global_=void 0!==e.global&&e.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit},(e=[{key:"canWrapX",value:function(){return this.canWrapX_}},{key:"getCode",value:function(){return this.code_}},{key:"getExtent",value:function(){return this.extent_}},{key:"getUnits",value:function(){return this.units_}},{key:"getMetersPerUnit",value:function(){return this.metersPerUnit_||gt[this.units_]}},{key:"getWorldExtent",value:function(){return this.worldExtent_}},{key:"getAxisOrientation",value:function(){return this.axisOrientation_}},{key:"isGlobal",value:function(){return this.global_}},{key:"setGlobal",value:function(t){this.global_=t,this.canWrapX_=!(!t||!this.extent_)}},{key:"getDefaultTileGrid",value:function(){return this.defaultTileGrid_}},{key:"setDefaultTileGrid",value:function(t){this.defaultTileGrid_=t}},{key:"setExtent",value:function(t){this.extent_=t,this.canWrapX_=!(!this.global_||!t)}},{key:"setWorldExtent",value:function(t){this.worldExtent_=t}},{key:"setGetPointResolution",value:function(t){this.getPointResolutionFunc_=t}},{key:"getPointResolutionFunc",value:function(){return this.getPointResolutionFunc_}}])&&bt(t.prototype,e),n&&bt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}();function St(t){return(St="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ot(r.key),r)}}function Ot(t){var e=function(t,e){if("object"!=St(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=St(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==St(e)?e:e+""}function kt(t,e,n){return e=Pt(e),function(t,e){if(e&&("object"==St(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],Pt(t).constructor):e.apply(t,n))}function Pt(t){return(Pt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Et(t,e){return(Et=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var jt=6378137*Math.PI,Ct=[-jt,-jt,jt,jt],Tt=[-180,-85,180,85],Rt=6378137*Math.log(Math.tan(Math.PI/2)),It=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),kt(this,e,[{code:t,units:"m",extent:Ct,global:!0,worldExtent:Tt,getPointResolution:function(t,e){return t/Math.cosh(e[1]/6378137)}}])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Et(t,e)}(e,t),n=e,r&&xt(n.prototype,r),i&&xt(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(wt),Mt=[new It("EPSG:3857"),new It("EPSG:102100"),new It("EPSG:102113"),new It("EPSG:900913"),new It("http://www.opengis.net/def/crs/EPSG/0/3857"),new It("http://www.opengis.net/gml/srs/epsg.xml#3857")];function Lt(t,e,n,r){var i,o=t.length;n=n>1?n:2,r=null!==(i=r)&&void 0!==i?i:n,void 0===e&&(e=n>2?t.slice():new Array(o));for(var a=0;a<o;a+=r){e[a]=jt*t[a]/180;var u=6378137*Math.log(Math.tan(Math.PI*(+t[a+1]+90)/360));u>Rt?u=Rt:u<-Rt&&(u=-Rt),e[a+1]=u}return e}function At(t,e,n,r){var i,o=t.length;n=n>1?n:2,r=null!==(i=r)&&void 0!==i?i:n,void 0===e&&(e=n>2?t.slice():new Array(o));for(var a=0;a<o;a+=r)e[a]=180*t[a]/jt,e[a+1]=360*Math.atan(Math.exp(t[a+1]/6378137))/Math.PI-90;return e}function Ft(t){return(Ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Dt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Nt(r.key),r)}}function Nt(t){var e=function(t,e){if("object"!=Ft(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Ft(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Ft(e)?e:e+""}function zt(t,e,n){return e=Bt(e),function(t,e){if(e&&("object"==Ft(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],Bt(t).constructor):e.apply(t,n))}function Bt(t){return(Bt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Gt(t,e){return(Gt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Wt=[-180,-90,180,90],Xt=6378137*Math.PI/180,Yt=function(t){function e(t,n){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),zt(this,e,[{code:t,units:"degrees",extent:Wt,axisOrientation:n,global:!0,metersPerUnit:Xt,worldExtent:Wt}])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Gt(t,e)}(e,t),n=e,r&&Dt(n.prototype,r),i&&Dt(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(wt),Kt=[new Yt("CRS:84"),new Yt("EPSG:4326","neu"),new Yt("urn:ogc:def:crs:OGC:1.3:CRS84"),new Yt("urn:ogc:def:crs:OGC:2:84"),new Yt("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new Yt("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new Yt("http://www.opengis.net/def/crs/EPSG/0/4326","neu")],Zt={};var Ut={};function Vt(t,e,n){var r=t.getCode(),i=e.getCode();r in Ut||(Ut[r]={}),Ut[r][i]=n}var qt=0,Ht=1,Jt=2,$t=4,Qt=8,te=16;function ee(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,u=[],s=!0,l=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=o.call(n)).done)&&(u.push(r.value),u.length!==e);s=!0);}catch(t){l=!0,i=t}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return u}}(t,e)||function(t,e){if(t){if("string"==typeof t)return ne(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ne(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ne(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function re(t){for(var e=fe(),n=0,r=t.length;n<r;++n)ge(e,t[n]);return e}function ie(t,e,n){return n?(n[0]=t[0]-e,n[1]=t[1]-e,n[2]=t[2]+e,n[3]=t[3]+e,n):[t[0]-e,t[1]-e,t[2]+e,t[3]+e]}function oe(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t.slice()}function ae(t,e,n){var r,i;return(r=e<t[0]?t[0]-e:t[2]<e?e-t[2]:0)*r+(i=n<t[1]?t[1]-n:t[3]<n?n-t[3]:0)*i}function ue(t,e){return le(t,e[0],e[1])}function se(t,e){return t[0]<=e[0]&&e[2]<=t[2]&&t[1]<=e[1]&&e[3]<=t[3]}function le(t,e,n){return t[0]<=e&&e<=t[2]&&t[1]<=n&&n<=t[3]}function ce(t,e){var n=t[0],r=t[1],i=t[2],o=t[3],a=e[0],u=e[1],s=qt;return a<n?s|=te:a>i&&(s|=$t),u<r?s|=Qt:u>o&&(s|=Jt),s===qt&&(s=Ht),s}function fe(){return[1/0,1/0,-1/0,-1/0]}function he(t,e,n,r,i){return i?(i[0]=t,i[1]=e,i[2]=n,i[3]=r,i):[t,e,n,r]}function ye(t){return he(1/0,1/0,-1/0,-1/0,t)}function pe(t,e){var n=t[0],r=t[1];return he(n,r,n,r,e)}function de(t,e,n,r,i){return me(ye(i),t,e,n,r)}function ve(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}function ge(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function me(t,e,n,r,i){for(;n<r;n+=i)be(t,e[n],e[n+1]);return t}function be(t,e,n){t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],n),t[2]=Math.max(t[2],e),t[3]=Math.max(t[3],n)}function _e(t,e){var n;return(n=e(Se(t)))||(n=e(xe(t)))||(n=e(Te(t)))?n:(n=e(Ce(t)))||!1}function we(t){var e=0;return Me(t)||(e=Re(t)*Ee(t)),e}function Se(t){return[t[0],t[1]]}function xe(t){return[t[2],t[1]]}function Oe(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function ke(t,e){var n;if("bottom-left"===e)n=Se(t);else if("bottom-right"===e)n=xe(t);else if("top-left"===e)n=Ce(t);else{if("top-right"!==e)throw new Error("Invalid corner");n=Te(t)}return n}function Pe(t,e,n,r,i){var o=ee(function(t,e,n,r){var i=e*r[0]/2,o=e*r[1]/2,a=Math.cos(n),u=Math.sin(n),s=i*a,l=i*u,c=o*a,f=o*u,h=t[0],y=t[1];return[h-s+f,y-l-c,h-s-f,y-l+c,h+s-f,y+l+c,h+s+f,y+l-c,h-s+f,y-l-c]}(t,e,n,r),8),a=o[0],u=o[1],s=o[2],l=o[3],c=o[4],f=o[5],h=o[6],y=o[7];return he(Math.min(a,s,c,h),Math.min(u,l,f,y),Math.max(a,s,c,h),Math.max(u,l,f,y),i)}function Ee(t){return t[3]-t[1]}function je(t,e,n){var r=n||[1/0,1/0,-1/0,-1/0];return Ie(t,e)?(t[0]>e[0]?r[0]=t[0]:r[0]=e[0],t[1]>e[1]?r[1]=t[1]:r[1]=e[1],t[2]<e[2]?r[2]=t[2]:r[2]=e[2],t[3]<e[3]?r[3]=t[3]:r[3]=e[3]):ye(r),r}function Ce(t){return[t[0],t[3]]}function Te(t){return[t[2],t[3]]}function Re(t){return t[2]-t[0]}function Ie(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}function Me(t){return t[2]<t[0]||t[3]<t[1]}function Le(t,e,n,r){if(Me(t))return ye(n);var i=[];if(r>1)for(var o=t[2]-t[0],a=t[3]-t[1],u=0;u<r;++u)i.push(t[0]+o*u/r,t[1],t[2],t[1]+a*u/r,t[2]-o*u/r,t[3],t[0],t[3]-a*u/r);else i=[t[0],t[1],t[2],t[1],t[2],t[3],t[0],t[3]];e(i,i,2);for(var s=[],l=[],c=0,f=i.length;c<f;c+=2)s.push(i[c]),l.push(i[c+1]);return function(t,e,n){return he(Math.min.apply(null,t),Math.min.apply(null,e),Math.max.apply(null,t),Math.max.apply(null,e),n)}(s,l,n)}function Ae(t,e){var n=e.getExtent(),r=Oe(t);if(e.canWrapX()&&(r[0]<n[0]||r[0]>=n[2])){var i=Re(n),o=Math.floor((r[0]-n[0])/i)*i;t[0]-=o,t[2]-=o}return t}function Fe(t,e,n){if(e.canWrapX()){var r=e.getExtent();if(!isFinite(t[0])||!isFinite(t[2]))return[[r[0],t[1],r[2],t[3]]];Ae(t,e);var i=Re(r);if(Re(t)>i&&!n)return[[r[0],t[1],r[2],t[3]]];if(t[0]<r[0])return[[t[0]+i,t[1],r[2],t[3]],[r[0],t[1],t[2],t[3]]];if(t[2]>r[2])return[[t[0],t[1],r[2],t[3]],[r[0],t[1],t[2]-i,t[3]]]}return[t]}function De(t,e,n){return Math.min(Math.max(t,e),n)}function Ne(t,e,n,r,i,o){var a=i-n,u=o-r;if(0!==a||0!==u){var s=((t-n)*a+(e-r)*u)/(a*a+u*u);s>1?(n=i,r=o):s>0&&(n+=a*s,r+=u*s)}return ze(t,e,n,r)}function ze(t,e,n,r){var i=n-t,o=r-e;return i*i+o*o}function Be(t){return t*Math.PI/180}function Ge(t,e){var n=t%e;return n*e<0?n+e:n}function We(t,e,n){return t+n*(e-t)}function Xe(t,e){var n=Math.pow(10,e);return Math.round(t*n)/n}function Ye(t,e){return Math.floor(Xe(t,e))}function Ke(t,e){return Math.ceil(Xe(t,e))}function Ze(t,e){for(var n=!0,r=t.length-1;r>=0;--r)if(t[r]!=e[r]){n=!1;break}return n}function Ue(t,e){var n=Math.cos(e),r=Math.sin(e),i=t[0]*n-t[1]*r,o=t[1]*n+t[0]*r;return t[0]=i,t[1]=o,t}function Ve(t,e){if(e.canWrapX()){var n=Re(e.getExtent()),r=qe(t,e,n);r&&(t[0]-=r*n)}return t}function qe(t,e,n){var r=e.getExtent(),i=0;return e.canWrapX()&&(t[0]<r[0]||t[0]>r[2])&&(n=n||Re(r),i=Math.floor((t[0]-r[0])/n)),i}function He(t,e,n){n=n||6371008.8;var r=Be(t[1]),i=Be(e[1]),o=(i-r)/2,a=Be(e[0]-t[0])/2,u=Math.sin(o)*Math.sin(o)+Math.sin(a)*Math.sin(a)*Math.cos(r)*Math.cos(i);return 2*n*Math.atan2(Math.sqrt(u),Math.sqrt(1-u))}var Je={info:1,warn:2,error:3,none:4},$e=Je.info;function Qe(){var t;$e>Je.warn||(t=console).warn.apply(t,arguments)}var tn=!0;function en(t){tn=!(void 0===t||t)}function nn(t,e){if(void 0!==e){for(var n=0,r=t.length;n<r;++n)e[n]=t[n];e=e}else e=t.slice();return e}function rn(t,e){if(void 0!==e&&t!==e){for(var n=0,r=t.length;n<r;++n)e[n]=t[n];t=e}return t}function on(t){!function(t,e){Zt[t]=e}(t.getCode(),t),Vt(t,t,nn)}function an(t){return"string"==typeof t?Zt[e=t]||Zt[e.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null:t||null;var e}function un(t,e,n,r){var i,o=(t=an(t)).getPointResolutionFunc();if(o){if(i=o(e,n),r&&r!==t.getUnits()){var a=t.getMetersPerUnit();a&&(i=i*a/gt[r])}}else{var u=t.getUnits();if("degrees"==u&&!r||"degrees"==r)i=e;else{var s=yn(t,an("EPSG:4326"));if(s===rn&&"degrees"!==u)i=e*t.getMetersPerUnit();else{var l=[n[0]-e/2,n[1],n[0]+e/2,n[1],n[0],n[1]-e/2,n[0],n[1]+e/2];i=(He((l=s(l,l,2)).slice(0,2),l.slice(2,4))+He(l.slice(4,6),l.slice(6,8)))/2}var c=r?gt[r]:t.getMetersPerUnit();void 0!==c&&(i/=c)}}return i}function sn(t){!function(t){t.forEach(on)}(t),t.forEach((function(e){t.forEach((function(t){e!==t&&Vt(e,t,nn)}))}))}function ln(t,e){return t?"string"==typeof t?an(t):t:an(e)}function cn(t,e){return en(),dn(t,"EPSG:4326",void 0!==e?e:"EPSG:3857")}function fn(t,e){var n=dn(t,void 0!==e?e:"EPSG:3857","EPSG:4326"),r=n[0];return(r<-180||r>180)&&(n[0]=Ge(r+180,360)-180),n}function hn(t,e){if(t===e)return!0;var n=t.getUnits()===e.getUnits();return(t.getCode()===e.getCode()||yn(t,e)===nn)&&n}function yn(t,e){var n=function(t,e){var n;return t in Ut&&e in Ut[t]&&(n=Ut[t][e]),n}(t.getCode(),e.getCode());return n||(n=rn),n}function pn(t,e){return yn(an(t),an(e))}function dn(t,e,n){return pn(e,n)(t,void 0,t.length)}function vn(t,e,n,r){return Le(t,pn(e,n),void 0,r)}var gn,mn,bn,_n=null;function wn(){return _n}function Sn(t,e){return _n?dn(t,e,_n):t}function xn(t,e){return _n?dn(t,_n,e):(tn&&!Ze(t,[0,0])&&t[0]>=-180&&t[0]<=180&&t[1]>=-90&&t[1]<=90&&(tn=!1,Qe("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),t)}function On(t,e){return _n?vn(t,e,_n):t}function kn(t,e){return _n?vn(t,_n,e):t}function Pn(t,e){if(!_n)return t;var n=an(e).getMetersPerUnit(),r=_n.getMetersPerUnit();return n&&r?t*n/r:t}function En(t,e){if(!t)throw new Error(e)}function jn(t,e,n){return function(r,i,o,a,u){if(r){if(!i&&!e)return r;var s=e?0:o[0]*i,l=e?0:o[1]*i,c=u?u[0]:0,f=u?u[1]:0,h=t[0]+s/2+c,y=t[2]-s/2+c,p=t[1]+l/2+f,d=t[3]-l/2+f;h>y&&(y=h=(y+h)/2),p>d&&(d=p=(d+p)/2);var v=De(r[0],h,y),g=De(r[1],p,d);if(a&&n&&i){var m=30*i;v+=-m*Math.log(1+Math.max(0,h-r[0])/m)+m*Math.log(1+Math.max(0,r[0]-y)/m),g+=-m*Math.log(1+Math.max(0,p-r[1])/m)+m*Math.log(1+Math.max(0,r[1]-d)/m)}return[v,g]}}}function Cn(t){return t}function Tn(t,e,n,r){var i=Re(e)/n[0],o=Ee(e)/n[1];return r?Math.min(t,Math.max(i,o)):Math.min(t,Math.min(i,o))}function Rn(t,e,n){var r=Math.min(t,e);return r*=Math.log(1+50*Math.max(0,t/e-1))/50+1,n&&(r=Math.max(r,n),r/=Math.log(1+50*Math.max(0,n/t-1))/50+1),De(r,n/2,2*e)}function In(t,e,n,r,i){return n=void 0===n||n,function(o,a,u,s){if(void 0!==o){var l=r?Tn(t,r,u,i):t;return n&&s?Rn(o,l,e):De(o,e,l)}}}function Mn(t){if(void 0!==t)return 0}function Ln(t){if(void 0!==t)return t}function An(t){return Math.pow(t,3)}function Fn(t){return 1-An(1-t)}function Dn(t){return 3*t*t-2*t*t*t}function Nn(t){return t}sn(Mt),sn(Kt),gn=Mt,mn=Lt,bn=At,Kt.forEach((function(t){gn.forEach((function(e){Vt(t,e,mn),Vt(e,t,bn)}))}));new Array(6);function zn(t,e){var n=e[0],r=e[1];return e[0]=t[0]*n+t[2]*r+t[4],e[1]=t[1]*n+t[3]*r+t[5],e}function Bn(t,e,n,r,i,o,a,u){var s=Math.sin(o),l=Math.cos(o);return t[0]=r*l,t[1]=i*s,t[2]=-r*s,t[3]=i*l,t[4]=a*r*l-u*r*s+e,t[5]=a*i*s+u*i*l+n,t}function Gn(t,e){var n,r=(n=e)[0]*n[3]-n[1]*n[2];En(0!==r,"Transformation matrix cannot be inverted");var i=e[0],o=e[1],a=e[2],u=e[3],s=e[4],l=e[5];return t[0]=u/r,t[1]=-o/r,t[2]=-a/r,t[3]=i/r,t[4]=(a*l-u*s)/r,t[5]=-(i*l-o*s)/r,t}var Wn=[1e6,1e6,1e6,1e6,2,2];function Xn(t){return"matrix("+t.map((function(t,e){return Math.round(t*Wn[e])/Wn[e]})).join(", ")+")"}function Yn(t,e,n,r,i,o,a){o=o||[],a=a||2;for(var u=0,s=e;s<n;s+=r){var l=t[s],c=t[s+1];o[u++]=i[0]*l+i[2]*c+i[4],o[u++]=i[1]*l+i[3]*c+i[5];for(var f=2;f<a;f++)o[u++]=t[s+f]}return o&&o.length!=u&&(o.length=u),o}function Kn(t,e,n,r,i,o,a){a=a||[];for(var u=Math.cos(i),s=Math.sin(i),l=o[0],c=o[1],f=0,h=e;h<n;h+=r){var y=t[h]-l,p=t[h+1]-c;a[f++]=l+y*u-p*s,a[f++]=c+y*s+p*u;for(var d=h+2;d<h+r;++d)a[f++]=t[d]}return a&&a.length!=f&&(a.length=f),a}function Zn(t){return(Zn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Un(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Vn(r.key),r)}}function Vn(t){var e=function(t,e){if("object"!=Zn(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Zn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Zn(e)?e:e+""}function qn(t,e,n){return e=Hn(e),function(t,e){if(e&&("object"==Zn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],Hn(t).constructor):e.apply(t,n))}function Hn(t){return(Hn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Jn(t,e){return(Jn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var $n=[1,0,0,1,0,0];function Qn(t){return(Qn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,er(r.key),r)}}function er(t){var e=function(t,e){if("object"!=Qn(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Qn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Qn(e)?e:e+""}function nr(t,e,n){return e=rr(e),function(t,e){if(e&&("object"==Qn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],rr(t).constructor):e.apply(t,n))}function rr(t){return(rr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ir(t,e){return(ir=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function or(t){var e;return"XY"==t?e=2:"XYZ"==t||"XYM"==t?e=3:"XYZM"==t&&(e=4),e}var ar=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=nr(this,e)).layout="XY",t.stride=2,t.flatCoordinates,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ir(t,e)}(e,t),n=e,(r=[{key:"computeExtent",value:function(t){return de(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}},{key:"getCoordinates",value:function(){return tt()}},{key:"getFirstCoordinate",value:function(){return this.flatCoordinates.slice(0,this.stride)}},{key:"getFlatCoordinates",value:function(){return this.flatCoordinates}},{key:"getLastCoordinate",value:function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}},{key:"getLayout",value:function(){return this.layout}},{key:"getSimplifiedGeometry",value:function(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;var e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}},{key:"getSimplifiedGeometryInternal",value:function(t){return this}},{key:"getStride",value:function(){return this.stride}},{key:"setFlatCoordinates",value:function(t,e){this.stride=or(t),this.layout=t,this.flatCoordinates=e}},{key:"setCoordinates",value:function(t,e){tt()}},{key:"setLayout",value:function(t,e,n){var r;if(t)r=or(t);else{for(var i=0;i<n;++i){if(0===e.length)return this.layout="XY",void(this.stride=2);e=e[0]}t=function(t){var e;return 2==t?e="XY":3==t?e="XYZ":4==t&&(e="XYZM"),e}(r=e.length)}this.layout=t,this.stride=r}},{key:"applyTransform",value:function(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}},{key:"rotate",value:function(t,e){var n=this.getFlatCoordinates();if(n){var r=this.getStride();Kn(n,0,n.length,r,t,e,n),this.changed()}}},{key:"scale",value:function(t,e,n){void 0===e&&(e=t),n||(n=Oe(this.getExtent()));var r=this.getFlatCoordinates();if(r){var i=this.getStride();!function(t,e,n,r,i,o,a,u){u=u||[];for(var s=a[0],l=a[1],c=0,f=e;f<n;f+=r){var h=t[f]-s,y=t[f+1]-l;u[c++]=s+i*h,u[c++]=l+o*y;for(var p=f+2;p<f+r;++p)u[c++]=t[p]}u&&u.length!=c&&(u.length=c)}(r,0,r.length,i,t,e,n,r),this.changed()}}},{key:"translate",value:function(t,e){var n=this.getFlatCoordinates();if(n){var r=this.getStride();!function(t,e,n,r,i,o,a){a=a||[];for(var u=0,s=e;s<n;s+=r){a[u++]=t[s]+i,a[u++]=t[s+1]+o;for(var l=s+2;l<s+r;++l)a[u++]=t[l]}a&&a.length!=u&&(a.length=u)}(n,0,n.length,r,t,e,n),this.changed()}}}])&&tr(n.prototype,r),i&&tr(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=qn(this,e)).extent_=[1/0,1/0,-1/0,-1/0],t.extentRevision_=-1,t.simplifiedGeometryMaxMinSquaredTolerance=0,t.simplifiedGeometryRevision=0,t.simplifyTransformedInternal=S((function(e,n,r){if(!r)return t.getSimplifiedGeometry(n);var i=t.clone();return i.applyTransform(r),i.getSimplifiedGeometry(n)})),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Jn(t,e)}(e,t),n=e,(r=[{key:"simplifyTransformed",value:function(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)}},{key:"clone",value:function(){return tt()}},{key:"closestPointXY",value:function(t,e,n,r){return tt()}},{key:"containsXY",value:function(t,e){var n=this.getClosestPoint([t,e]);return n[0]===t&&n[1]===e}},{key:"getClosestPoint",value:function(t,e){return e=e||[NaN,NaN],this.closestPointXY(t[0],t[1],e,1/0),e}},{key:"intersectsCoordinate",value:function(t){return this.containsXY(t[0],t[1])}},{key:"computeExtent",value:function(t){return tt()}},{key:"getExtent",value:function(t){if(this.extentRevision_!=this.getRevision()){var e=this.computeExtent(this.extent_);(isNaN(e[0])||isNaN(e[1]))&&ye(e),this.extentRevision_=this.getRevision()}return function(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t}(this.extent_,t)}},{key:"rotate",value:function(t,e){tt()}},{key:"scale",value:function(t,e,n){tt()}},{key:"simplify",value:function(t){return this.getSimplifiedGeometry(t*t)}},{key:"getSimplifiedGeometry",value:function(t){return tt()}},{key:"getType",value:function(){return tt()}},{key:"applyTransform",value:function(t){tt()}},{key:"intersectsExtent",value:function(t){return tt()}},{key:"translate",value:function(t,e){tt()}},{key:"transform",value:function(t,e){var n=an(t),r="tile-pixels"==n.getUnits()?function(t,r,i){var o=n.getExtent(),a=n.getWorldExtent(),u=Ee(a)/Ee(o);return Bn($n,a[0],a[3],u,-u,0,0,0),Yn(t,0,t.length,i,$n,r),pn(n,e)(t,r,i)}:pn(n,e);return this.applyTransform(r),this}}])&&Un(n.prototype,r),i&&Un(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(yt));function ur(t,e,n,r,i,o,a){var u,s=t[e],l=t[e+1],c=t[n]-s,f=t[n+1]-l;if(0===c&&0===f)u=e;else{var h=((i-s)*c+(o-l)*f)/(c*c+f*f);if(h>1)u=n;else{if(h>0){for(var y=0;y<r;++y)a[y]=We(t[e+y],t[n+y],h);return void(a.length=r)}u=e}}for(var p=0;p<r;++p)a[p]=t[u+p];a.length=r}function sr(t,e,n,r,i){var o=t[e],a=t[e+1];for(e+=r;e<n;e+=r){var u=t[e],s=t[e+1],l=ze(o,a,u,s);l>i&&(i=l),o=u,a=s}return i}function lr(t,e,n,r,i){for(var o=0,a=n.length;o<a;++o){var u=n[o];i=sr(t,e,u,r,i),e=u}return i}function cr(t,e,n,r,i,o,a,u,s,l,c){if(e==n)return l;var f,h;if(0===i){if((h=ze(a,u,t[e],t[e+1]))<l){for(f=0;f<r;++f)s[f]=t[e+f];return s.length=r,h}return l}c=c||[NaN,NaN];for(var y=e+r;y<n;)if(ur(t,y-r,y,r,a,u,c),(h=ze(a,u,c[0],c[1]))<l){for(l=h,f=0;f<r;++f)s[f]=c[f];s.length=r,y+=r}else y+=r*Math.max((Math.sqrt(h)-Math.sqrt(l))/i|0,1);if(o&&(ur(t,n-r,e,r,a,u,c),(h=ze(a,u,c[0],c[1]))<l)){for(l=h,f=0;f<r;++f)s[f]=c[f];s.length=r}return l}function fr(t,e,n,r,i,o,a,u,s,l,c){c=c||[NaN,NaN];for(var f=0,h=n.length;f<h;++f){var y=n[f];l=cr(t,e,y,r,i,o,a,u,s,l,c),e=y}return l}function hr(t,e,n,r){for(var i=0,o=n.length;i<o;++i)for(var a=n[i],u=0;u<r;++u)t[e++]=a[u];return e}function yr(t,e,n,r,i){i=i||[];for(var o=0,a=0,u=n.length;a<u;++a){var s=hr(t,e,n[a],r);i[o++]=s,e=s}return i.length=o,i}function pr(t,e,n,r,i,o,a){var u=(n-e)/r;if(u<3){for(;e<n;e+=r)o[a++]=t[e],o[a++]=t[e+1];return a}var s=new Array(u);s[0]=1,s[u-1]=1;for(var l=[e,n-r],c=0;l.length>0;){for(var f=l.pop(),h=l.pop(),y=0,p=t[h],d=t[h+1],v=t[f],g=t[f+1],m=h+r;m<f;m+=r){var b=Ne(t[m],t[m+1],p,d,v,g);b>y&&(c=m,y=b)}y>i&&(s[(c-e)/r]=1,h+r<c&&l.push(h,c),c+r<f&&l.push(c,f))}for(var _=0;_<u;++_)s[_]&&(o[a++]=t[e+_*r],o[a++]=t[e+_*r+1]);return a}function dr(t,e,n,r,i,o,a,u){for(var s=0,l=n.length;s<l;++s){var c=n[s];a=pr(t,e,c,r,i,o,a),u.push(a),e=c}return a}function vr(t,e){return e*Math.round(t/e)}function gr(t,e,n,r,i,o,a){if(e==n)return a;var u,s,l=vr(t[e],i),c=vr(t[e+1],i);e+=r,o[a++]=l,o[a++]=c;do{if(u=vr(t[e],i),s=vr(t[e+1],i),(e+=r)==n)return o[a++]=u,o[a++]=s,a}while(u==l&&s==c);for(;e<n;){var f=vr(t[e],i),h=vr(t[e+1],i);if(e+=r,f!=u||h!=s){var y=u-l,p=s-c,d=f-l,v=h-c;y*v==p*d&&(y<0&&d<y||y==d||y>0&&d>y)&&(p<0&&v<p||p==v||p>0&&v>p)?(u=f,s=h):(o[a++]=u,o[a++]=s,l=u,c=s,u=f,s=h)}}return o[a++]=u,o[a++]=s,a}function mr(t,e,n,r,i,o,a,u){for(var s=0,l=n.length;s<l;++s){var c=n[s];a=gr(t,e,c,r,i,o,a),u.push(a),e=c}return a}function br(t,e,n,r,i){i=void 0!==i?i:[];for(var o=0,a=e;a<n;a+=r)i[o++]=t.slice(a,a+r);return i.length=o,i}function _r(t,e,n,r,i){i=void 0!==i?i:[];for(var o=0,a=0,u=n.length;a<u;++a){var s=n[a];i[o++]=br(t,e,s,r,i[o]),e=s}return i.length=o,i}function wr(t,e,n,r,i){i=void 0!==i?i:[];for(var o=0,a=0,u=n.length;a<u;++a){var s=n[a];i[o++]=1===s.length&&s[0]===e?[]:_r(t,e,s,r,i[o]),e=s[s.length-1]}return i.length=o,i}function Sr(t,e,n,r){for(var i=0,o=t[n-r],a=t[n-r+1],u=0,s=0;e<n;e+=r){var l=t[e]-o,c=t[e+1]-a;i+=s*l-u*c,u=l,s=c}return i/2}function xr(t,e,n,r){for(var i=0,o=0,a=n.length;o<a;++o){var u=n[o];i+=Sr(t,e,u,r),e=u}return i}function Or(t){return(Or="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function kr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Pr(r.key),r)}}function Pr(t){var e=function(t,e){if("object"!=Or(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Or(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Or(e)?e:e+""}function Er(t,e,n){return e=jr(e),function(t,e){if(e&&("object"==Or(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],jr(t).constructor):e.apply(t,n))}function jr(t){return(jr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Cr(t,e){return(Cr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Tr=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Er(this,e)).maxDelta_=-1,r.maxDeltaRevision_=-1,void 0===n||Array.isArray(t[0])?r.setCoordinates(t,n):r.setFlatCoordinates(n,t),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Cr(t,e)}(e,t),n=e,(r=[{key:"clone",value:function(){return new e(this.flatCoordinates.slice(),this.layout)}},{key:"closestPointXY",value:function(t,e,n,r){return r<ae(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(sr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),cr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,n,r))}},{key:"getArea",value:function(){return Sr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}},{key:"getCoordinates",value:function(){return br(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}},{key:"getSimplifiedGeometryInternal",value:function(t){var n=[];return n.length=pr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,n,0),new e(n,"XY")}},{key:"getType",value:function(){return"LinearRing"}},{key:"intersectsExtent",value:function(t){return!1}},{key:"setCoordinates",value:function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=hr(this.flatCoordinates,0,t,this.stride),this.changed()}}])&&kr(n.prototype,r),i&&kr(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(ar);function Rr(t){return(Rr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ir(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Mr(r.key),r)}}function Mr(t){var e=function(t,e){if("object"!=Rr(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Rr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Rr(e)?e:e+""}function Lr(t,e,n){return e=Ar(e),function(t,e){if(e&&("object"==Rr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],Ar(t).constructor):e.apply(t,n))}function Ar(t){return(Ar=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Fr(t,e){return(Fr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Dr=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Lr(this,e)).setCoordinates(t,n),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Fr(t,e)}(e,t),n=e,(r=[{key:"clone",value:function(){var t=new e(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}},{key:"closestPointXY",value:function(t,e,n,r){var i=this.flatCoordinates,o=ze(t,e,i[0],i[1]);if(o<r){for(var a=this.stride,u=0;u<a;++u)n[u]=i[u];return n.length=a,o}return r}},{key:"getCoordinates",value:function(){return this.flatCoordinates.slice()}},{key:"computeExtent",value:function(t){return pe(this.flatCoordinates,t)}},{key:"getType",value:function(){return"Point"}},{key:"intersectsExtent",value:function(t){return le(t,this.flatCoordinates[0],this.flatCoordinates[1])}},{key:"setCoordinates",value:function(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=function(t,e,n,r){for(var i=0,o=n.length;i<o;++i)t[e++]=n[i];return e}(this.flatCoordinates,0,t,this.stride),this.changed()}}])&&Ir(n.prototype,r),i&&Ir(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(ar);function Nr(t,e,n,r,i){return!_e(i,(function(i){return!zr(t,e,n,r,i[0],i[1])}))}function zr(t,e,n,r,i,o){for(var a=0,u=t[n-r],s=t[n-r+1];e<n;e+=r){var l=t[e],c=t[e+1];s<=o?c>o&&(l-u)*(o-s)-(i-u)*(c-s)>0&&a++:c<=o&&(l-u)*(o-s)-(i-u)*(c-s)<0&&a--,u=l,s=c}return 0!==a}function Br(t,e,n,r,i,o){if(0===n.length)return!1;if(!zr(t,e,n[0],r,i,o))return!1;for(var a=1,u=n.length;a<u;++a)if(zr(t,n[a-1],n[a],r,i,o))return!1;return!0}function Gr(t,e,n,r,i,o,a){for(var u,s,l,c,f,h,y,d=i[o+1],v=[],g=0,m=n.length;g<m;++g){var b=n[g];for(c=t[b-r],h=t[b-r+1],u=e;u<b;u+=r)f=t[u],y=t[u+1],(d<=h&&y<=d||h<=d&&d<=y)&&(l=(d-h)/(y-h)*(f-c)+c,v.push(l)),c=f,h=y}var _=NaN,w=-1/0;for(v.sort(p),c=v[0],u=1,s=v.length;u<s;++u){f=v[u];var S=Math.abs(f-c);S>w&&Br(t,e,n,r,l=(c+f)/2,d)&&(_=l,w=S),c=f}return isNaN(_)&&(_=i[o]),a?(a.push(_,d,w),a):[_,d,w]}function Wr(t,e,n,r,i){for(var o=[],a=0,u=n.length;a<u;++a){var s=n[a];o=Gr(t,e,s,r,i,2*a,o),e=s[s.length-1]}return o}function Xr(t,e,n,r,i){var o;for(e+=r;e<n;e+=r)if(o=i(t.slice(e-r,e),t.slice(e,e+r)))return o;return!1}function Yr(t,e,n,r,i){var o=me([1/0,1/0,-1/0,-1/0],t,e,n,r);return!!Ie(i,o)&&(!!se(i,o)||(o[0]>=i[0]&&o[2]<=i[2]||(o[1]>=i[1]&&o[3]<=i[3]||Xr(t,e,n,r,(function(t,e){return function(t,e,n){var r=!1,i=ce(t,e),o=ce(t,n);if(i===Ht||o===Ht)r=!0;else{var a,u,s=t[0],l=t[1],c=t[2],f=t[3],h=e[0],y=e[1],p=n[0],d=n[1],v=(d-y)/(p-h);o&Jt&&!(i&Jt)&&(r=(a=p-(d-f)/v)>=s&&a<=c),r||!(o&$t)||i&$t||(r=(u=d-(p-c)*v)>=l&&u<=f),r||!(o&Qt)||i&Qt||(r=(a=p-(d-l)/v)>=s&&a<=c),r||!(o&te)||i&te||(r=(u=d-(p-s)*v)>=l&&u<=f)}return r}(i,t,e)})))))}function Kr(t,e,n,r,i){return!!Yr(t,e,n,r,i)||(!!zr(t,e,n,r,i[0],i[1])||(!!zr(t,e,n,r,i[0],i[3])||(!!zr(t,e,n,r,i[2],i[1])||!!zr(t,e,n,r,i[2],i[3]))))}function Zr(t,e,n,r,i){if(!Kr(t,e,n[0],r,i))return!1;if(1===n.length)return!0;for(var o=1,a=n.length;o<a;++o)if(Nr(t,n[o-1],n[o],r,i)&&!Yr(t,n[o-1],n[o],r,i))return!1;return!0}function Ur(t,e,n,r){for(;e<n-r;){for(var i=0;i<r;++i){var o=t[e+i];t[e+i]=t[n-r+i],t[n-r+i]=o}e+=r,n-=r}}function Vr(t,e,n,r){for(var i=0,o=t[n-r],a=t[n-r+1];e<n;e+=r){var u=t[e],s=t[e+1];i+=(u-o)*(s+a),o=u,a=s}return 0===i?void 0:i>0}function qr(t,e,n,r,i){i=void 0!==i&&i;for(var o=0,a=n.length;o<a;++o){var u=n[o],s=Vr(t,e,u,r);if(0===o){if(i&&s||!i&&!s)return!1}else if(i&&!s||!i&&s)return!1;e=u}return!0}function Hr(t,e,n,r,i){i=void 0!==i&&i;for(var o=0,a=n.length;o<a;++o){var u=n[o],s=Vr(t,e,u,r);(0===o?i&&s||!i&&!s:i&&!s||!i&&s)&&Ur(t,e,u,r),e=u}return e}function Jr(t,e){for(var n,r=[],i=0,o=0,a=0,u=e.length;a<u;++a){var s=e[a],l=Vr(t,i,s,2);if(void 0===n&&(n=l),l===n)r.push(e.slice(o,a+1));else{if(0===r.length)continue;r[r.length-1].push(e[o])}o=a+1,i=s}return r}function $r(t){return($r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Qr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ti(r.key),r)}}function ti(t){var e=function(t,e){if("object"!=$r(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=$r(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==$r(e)?e:e+""}function ei(t,e,n){return e=ni(e),function(t,e){if(e&&("object"==$r(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],ni(t).constructor):e.apply(t,n))}function ni(t){return(ni=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ri(t,e){return(ri=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var ii=function(t){function e(t,n,r){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=ei(this,e)).ends_=[],i.flatInteriorPointRevision_=-1,i.flatInteriorPoint_=null,i.maxDelta_=-1,i.maxDeltaRevision_=-1,i.orientedRevision_=-1,i.orientedFlatCoordinates_=null,void 0!==n&&r?(i.setFlatCoordinates(n,t),i.ends_=r):i.setCoordinates(t,n),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ri(t,e)}(e,t),n=e,(r=[{key:"appendLinearRing",value:function(t){this.flatCoordinates?g(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}},{key:"clone",value:function(){var t=new e(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}},{key:"closestPointXY",value:function(t,e,n,r){return r<ae(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(lr(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),fr(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,n,r))}},{key:"containsXY",value:function(t,e){return Br(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)}},{key:"getArea",value:function(){return xr(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}},{key:"getCoordinates",value:function(t){var e;return void 0!==t?Hr(e=this.getOrientedFlatCoordinates().slice(),0,this.ends_,this.stride,t):e=this.flatCoordinates,_r(e,0,this.ends_,this.stride)}},{key:"getEnds",value:function(){return this.ends_}},{key:"getFlatInteriorPoint",value:function(){if(this.flatInteriorPointRevision_!=this.getRevision()){var t=Oe(this.getExtent());this.flatInteriorPoint_=Gr(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}},{key:"getInteriorPoint",value:function(){return new Dr(this.getFlatInteriorPoint(),"XYM")}},{key:"getLinearRingCount",value:function(){return this.ends_.length}},{key:"getLinearRing",value:function(t){return t<0||this.ends_.length<=t?null:new Tr(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)}},{key:"getLinearRings",value:function(){for(var t=this.layout,e=this.flatCoordinates,n=this.ends_,r=[],i=0,o=0,a=n.length;o<a;++o){var u=n[o],s=new Tr(e.slice(i,u),t);r.push(s),i=u}return r}},{key:"getOrientedFlatCoordinates",value:function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;qr(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Hr(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}},{key:"getSimplifiedGeometryInternal",value:function(t){var n=[],r=[];return n.length=mr(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),n,0,r),new e(n,"XY",r)}},{key:"getType",value:function(){return"Polygon"}},{key:"intersectsExtent",value:function(t){return Zr(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)}},{key:"setCoordinates",value:function(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var n=yr(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===n.length?0:n[n.length-1],this.changed()}}])&&Qr(n.prototype,r),i&&Qr(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(ar),oi=ii;function ai(t){if(Me(t))throw new Error("Cannot create polygon from empty extent");var e=t[0],n=t[1],r=t[2],i=t[3],o=[e,n,e,i,r,i,r,n,e,n];return new ii(o,"XY",[o.length])}function ui(t){return(ui="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function si(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,li(r.key),r)}}function li(t){var e=function(t,e){if("object"!=ui(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=ui(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ui(e)?e:e+""}function ci(t,e,n){return e=fi(e),function(t,e){if(e&&("object"==ui(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],fi(t).constructor):e.apply(t,n))}function fi(t){return(fi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function hi(t,e){return(hi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function yi(t,e){setTimeout((function(){t(e)}),0)}function pi(t){return!(t.sourceCenter&&t.targetCenter&&!Ze(t.sourceCenter,t.targetCenter))&&(t.sourceResolution===t.targetResolution&&t.sourceRotation===t.targetRotation)}function di(t,e,n,r,i){var o=Math.cos(-i),a=Math.sin(-i),u=t[0]*o-t[1]*a,s=t[1]*o+t[0]*a;return[(u+=(e[0]/2-n[0])*r)*o-(s+=(n[1]-e[1]/2)*r)*(a=-a),s*o+u*a]}var vi=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=ci(this,e)).on,n.once,n.un,t=Object.assign({},t),n.hints_=[0,0],n.animations_=[],n.updateAnimationKey_,n.projection_=ln(t.projection,"EPSG:3857"),n.viewportSize_=[100,100],n.targetCenter_=null,n.targetResolution_,n.targetRotation_,n.nextCenter_=null,n.nextResolution_,n.nextRotation_,n.cancelAnchor_=void 0,t.projection&&en(),t.center&&(t.center=xn(t.center,n.projection_)),t.extent&&(t.extent=kn(t.extent,n.projection_)),n.applyOptions_(t),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&hi(t,e)}(e,t),n=e,(r=[{key:"applyOptions_",value:function(t){var e=Object.assign({},t);for(var n in vt)delete e[n];this.setProperties(e,!0);var r=function(t){var e,n,r,i=void 0!==t.minZoom?t.minZoom:0,o=void 0!==t.maxZoom?t.maxZoom:28,a=void 0!==t.zoomFactor?t.zoomFactor:2,u=void 0!==t.multiWorld&&t.multiWorld,s=void 0===t.smoothResolutionConstraint||t.smoothResolutionConstraint,l=void 0!==t.showFullExtent&&t.showFullExtent,c=ln(t.projection,"EPSG:3857"),f=c.getExtent(),h=t.constrainOnlyCenter,y=t.extent;if(u||y||!c.isGlobal()||(h=!1,y=f),void 0!==t.resolutions){var p=t.resolutions;n=p[i],r=void 0!==p[o]?p[o]:p[p.length-1],e=t.constrainResolution?function(t,e,n,r){return e=void 0===e||e,function(i,o,a,u){if(void 0!==i){var s=t[0],l=t[t.length-1],c=n?Tn(s,n,a,r):s;if(u)return e?Rn(i,c,l):De(i,l,c);var f=Math.min(c,i),h=Math.floor(d(t,f,o));return t[h]>c&&h<t.length-1?t[h+1]:t[h]}}}(p,s,!h&&y,l):In(n,r,s,!h&&y,l)}else{var v=(f?Math.max(Re(f),Ee(f)):360*gt.degrees/c.getMetersPerUnit())/256/Math.pow(2,0),g=v/Math.pow(2,28);void 0!==(n=t.maxResolution)?i=0:n=v/Math.pow(a,i),void 0===(r=t.minResolution)&&(r=void 0!==t.maxZoom?void 0!==t.maxResolution?n/Math.pow(a,o):v/Math.pow(a,o):g),o=i+Math.floor(Math.log(n/r)/Math.log(a)),r=n/Math.pow(a,o-i),e=t.constrainResolution?function(t,e,n,r,i,o){return r=void 0===r||r,n=void 0!==n?n:0,function(a,u,s,l){if(void 0!==a){var c=i?Tn(e,i,s,o):e;if(l)return r?Rn(a,c,n):De(a,n,c);var f=Math.ceil(Math.log(e/c)/Math.log(t)-1e-9),h=-u*(.5-1e-9)+.5,y=Math.min(c,a),p=Math.floor(Math.log(e/y)/Math.log(t)+h),d=Math.max(f,p);return De(e/Math.pow(t,d),n,c)}}}(a,n,r,s,!h&&y,l):In(n,r,s,!h&&y,l)}return{constraint:e,maxResolution:n,minResolution:r,minZoom:i,zoomFactor:a}}(t);this.maxResolution_=r.maxResolution,this.minResolution_=r.minResolution,this.zoomFactor_=r.zoomFactor,this.resolutions_=t.resolutions,this.padding_=t.padding,this.minZoom_=r.minZoom;var i=function(t){if(void 0!==t.extent){var e=void 0===t.smoothExtentConstraint||t.smoothExtentConstraint;return jn(t.extent,t.constrainOnlyCenter,e)}var n=ln(t.projection,"EPSG:3857");if(!0!==t.multiWorld&&n.isGlobal()){var r=n.getExtent().slice();return r[0]=-1/0,r[2]=1/0,jn(r,!1,!1)}return Cn}(t),o=r.constraint,a=function(t){if(void 0===t.enableRotation||t.enableRotation){var e=t.constrainRotation;return void 0===e||!0===e?(o=void 0===i?Be(5):i,function(t,e){return e||void 0===t?t:Math.abs(t)<=o?0:t}):!1===e?Ln:"number"==typeof e?(n=e,r=2*Math.PI/n,function(t,e){return e?t:void 0!==t?t=Math.floor(t/r+.5)*r:void 0}):Ln}var n,r,i,o;return Mn}(t);this.constraints_={center:i,resolution:o,rotation:a},this.setRotation(void 0!==t.rotation?t.rotation:0),this.setCenterInternal(void 0!==t.center?t.center:null),void 0!==t.resolution?this.setResolution(t.resolution):void 0!==t.zoom&&this.setZoom(t.zoom)}},{key:"padding",get:function(){return this.padding_},set:function(t){var e=this.padding_;this.padding_=t;var n=this.getCenterInternal();if(n){var r=t||[0,0,0,0];e=e||[0,0,0,0];var i=this.getResolution(),o=i/2*(r[3]-e[3]+e[1]-r[1]),a=i/2*(r[0]-e[0]+e[2]-r[2]);this.setCenterInternal([n[0]+o,n[1]-a])}}},{key:"getUpdatedOptions_",value:function(t){var e=this.getProperties();return void 0!==e.resolution?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenterInternal(),e.rotation=this.getRotation(),Object.assign({},e,t)}},{key:"animate",value:function(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);for(var e=new Array(arguments.length),n=0;n<e.length;++n){var r=arguments[n];r.center&&((r=Object.assign({},r)).center=xn(r.center,this.getProjection())),r.anchor&&((r=Object.assign({},r)).anchor=xn(r.anchor,this.getProjection())),e[n]=r}this.animateInternal.apply(this,e)}},{key:"animateInternal",value:function(t){var e,n=arguments.length;n>1&&"function"==typeof arguments[n-1]&&(e=arguments[n-1],--n);for(var r=0;r<n&&!this.isDef();++r){var i=arguments[r];i.center&&this.setCenterInternal(i.center),void 0!==i.zoom?this.setZoom(i.zoom):i.resolution&&this.setResolution(i.resolution),void 0!==i.rotation&&this.setRotation(i.rotation)}if(r!==n){for(var o=Date.now(),a=this.targetCenter_.slice(),u=this.targetResolution_,s=this.targetRotation_,l=[];r<n;++r){var c=arguments[r],f={start:o,complete:!1,anchor:c.anchor,duration:void 0!==c.duration?c.duration:1e3,easing:c.easing||Dn,callback:e};if(c.center&&(f.sourceCenter=a,f.targetCenter=c.center.slice(),a=f.targetCenter),void 0!==c.zoom?(f.sourceResolution=u,f.targetResolution=this.getResolutionForZoom(c.zoom),u=f.targetResolution):c.resolution&&(f.sourceResolution=u,f.targetResolution=c.resolution,u=f.targetResolution),void 0!==c.rotation){f.sourceRotation=s;var h=Ge(c.rotation-s+Math.PI,2*Math.PI)-Math.PI;f.targetRotation=s+h,s=f.targetRotation}pi(f)?f.complete=!0:o+=f.duration,l.push(f)}this.animations_.push(l),this.setHint(pt,1),this.updateAnimations_()}else e&&yi(e,!0)}},{key:"getAnimating",value:function(){return this.hints_[pt]>0}},{key:"getInteracting",value:function(){return this.hints_[dt]>0}},{key:"cancelAnimations",value:function(){var t;this.setHint(pt,-this.hints_[pt]);for(var e=0,n=this.animations_.length;e<n;++e){var r=this.animations_[e];if(r[0].callback&&yi(r[0].callback,!1),!t)for(var i=0,o=r.length;i<o;++i){var a=r[i];if(!a.complete){t=a.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}},{key:"updateAnimations_",value:function(){if(void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),this.getAnimating()){for(var t=Date.now(),e=!1,n=this.animations_.length-1;n>=0;--n){for(var r=this.animations_[n],i=!0,o=0,a=r.length;o<a;++o){var u=r[o];if(!u.complete){var s=t-u.start,l=u.duration>0?s/u.duration:1;l>=1?(u.complete=!0,l=1):i=!1;var c=u.easing(l);if(u.sourceCenter){var f=u.sourceCenter[0],h=u.sourceCenter[1],y=u.targetCenter[0],p=u.targetCenter[1];this.nextCenter_=u.targetCenter;var d=f+c*(y-f),v=h+c*(p-h);this.targetCenter_=[d,v]}if(u.sourceResolution&&u.targetResolution){var g=1===c?u.targetResolution:u.sourceResolution+c*(u.targetResolution-u.sourceResolution);if(u.anchor){var m=this.getViewportSize_(this.getRotation()),b=this.constraints_.resolution(g,0,m,!0);this.targetCenter_=this.calculateCenterZoom(b,u.anchor)}this.nextResolution_=u.targetResolution,this.targetResolution_=g,this.applyTargetState_(!0)}if(void 0!==u.sourceRotation&&void 0!==u.targetRotation){var _=1===c?Ge(u.targetRotation+Math.PI,2*Math.PI)-Math.PI:u.sourceRotation+c*(u.targetRotation-u.sourceRotation);if(u.anchor){var w=this.constraints_.rotation(_,!0);this.targetCenter_=this.calculateCenterRotate(w,u.anchor)}this.nextRotation_=u.targetRotation,this.targetRotation_=_}if(this.applyTargetState_(!0),e=!0,!u.complete)break}}if(i){this.animations_[n]=null,this.setHint(pt,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;var S=r[0].callback;S&&yi(S,!0)}}this.animations_=this.animations_.filter(Boolean),e&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}}},{key:"calculateCenterRotate",value:function(t,e){var n,r,i,o=this.getCenterInternal();return void 0!==o&&(Ue(n=[o[0]-e[0],o[1]-e[1]],t-this.getRotation()),i=e,(r=n)[0]+=+i[0],r[1]+=+i[1]),n}},{key:"calculateCenterZoom",value:function(t,e){var n,r=this.getCenterInternal(),i=this.getResolution();return void 0!==r&&void 0!==i&&(n=[e[0]-t*(e[0]-r[0])/i,e[1]-t*(e[1]-r[1])/i]),n}},{key:"getViewportSize_",value:function(t){var e=this.viewportSize_;if(t){var n=e[0],r=e[1];return[Math.abs(n*Math.cos(t))+Math.abs(r*Math.sin(t)),Math.abs(n*Math.sin(t))+Math.abs(r*Math.cos(t))]}return e}},{key:"setViewportSize",value:function(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}},{key:"getCenter",value:function(){var t=this.getCenterInternal();return t?Sn(t,this.getProjection()):t}},{key:"getCenterInternal",value:function(){return this.get(vt.CENTER)}},{key:"getConstraints",value:function(){return this.constraints_}},{key:"getConstrainResolution",value:function(){return this.get("constrainResolution")}},{key:"getHints",value:function(t){return void 0!==t?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()}},{key:"calculateExtent",value:function(t){return On(this.calculateExtentInternal(t),this.getProjection())}},{key:"calculateExtentInternal",value:function(t){t=t||this.getViewportSizeMinusPadding_();var e=this.getCenterInternal();En(e,"The view center is not defined");var n=this.getResolution();En(void 0!==n,"The view resolution is not defined");var r=this.getRotation();return En(void 0!==r,"The view rotation is not defined"),Pe(e,n,r,t)}},{key:"getMaxResolution",value:function(){return this.maxResolution_}},{key:"getMinResolution",value:function(){return this.minResolution_}},{key:"getMaxZoom",value:function(){return this.getZoomForResolution(this.minResolution_)}},{key:"setMaxZoom",value:function(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))}},{key:"getMinZoom",value:function(){return this.getZoomForResolution(this.maxResolution_)}},{key:"setMinZoom",value:function(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))}},{key:"setConstrainResolution",value:function(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))}},{key:"getProjection",value:function(){return this.projection_}},{key:"getResolution",value:function(){return this.get(vt.RESOLUTION)}},{key:"getResolutions",value:function(){return this.resolutions_}},{key:"getResolutionForExtent",value:function(t,e){return this.getResolutionForExtentInternal(kn(t,this.getProjection()),e)}},{key:"getResolutionForExtentInternal",value:function(t,e){e=e||this.getViewportSizeMinusPadding_();var n=Re(t)/e[0],r=Ee(t)/e[1];return Math.max(n,r)}},{key:"getResolutionForValueFunction",value:function(t){t=t||2;var e=this.getConstrainedResolution(this.maxResolution_),n=this.minResolution_,r=Math.log(e/n)/Math.log(t);return function(n){return e/Math.pow(t,n*r)}}},{key:"getRotation",value:function(){return this.get(vt.ROTATION)}},{key:"getValueForResolutionFunction",value:function(t){var e=Math.log(t||2),n=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,i=Math.log(n/r)/e;return function(t){return Math.log(n/t)/e/i}}},{key:"getViewportSizeMinusPadding_",value:function(t){var e=this.getViewportSize_(t),n=this.padding_;return n&&(e=[e[0]-n[1]-n[3],e[1]-n[0]-n[2]]),e}},{key:"getState",value:function(){var t=this.getProjection(),e=this.getResolution(),n=this.getRotation(),r=this.getCenterInternal(),i=this.padding_;if(i){var o=this.getViewportSizeMinusPadding_();r=di(r,this.getViewportSize_(),[o[0]/2+i[3],o[1]/2+i[0]],e,n)}return{center:r.slice(0),projection:void 0!==t?t:null,resolution:e,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:n,zoom:this.getZoom()}}},{key:"getViewStateAndExtent",value:function(){return{viewState:this.getState(),extent:this.calculateExtent()}}},{key:"getZoom",value:function(){var t,e=this.getResolution();return void 0!==e&&(t=this.getZoomForResolution(e)),t}},{key:"getZoomForResolution",value:function(t){var e,n,r=this.minZoom_||0;if(this.resolutions_){var i=d(this.resolutions_,t,1);r=i,e=this.resolutions_[i],n=i==this.resolutions_.length-1?2:e/this.resolutions_[i+1]}else e=this.maxResolution_,n=this.zoomFactor_;return r+Math.log(e/t)/Math.log(n)}},{key:"getResolutionForZoom",value:function(t){if(this.resolutions_){if(this.resolutions_.length<=1)return 0;var e=De(Math.floor(t),0,this.resolutions_.length-2),n=this.resolutions_[e]/this.resolutions_[e+1];return this.resolutions_[e]/Math.pow(n,De(t-e,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)}},{key:"fit",value:function(t,e){var n;if(En(Array.isArray(t)||"function"==typeof t.getSimplifiedGeometry,"Invalid extent or geometry provided as `geometry`"),Array.isArray(t))En(!Me(t),"Cannot fit empty extent provided as `geometry`"),n=ai(kn(t,this.getProjection()));else if("Circle"===t.getType()){var r=kn(t.getExtent(),this.getProjection());(n=ai(r)).rotate(this.getRotation(),Oe(r))}else{var i=wn();n=i?t.clone().transform(i,this.getProjection()):t}this.fitInternal(n,e)}},{key:"rotatedExtentForGeometry",value:function(t){for(var e=this.getRotation(),n=Math.cos(e),r=Math.sin(-e),i=t.getFlatCoordinates(),o=t.getStride(),a=1/0,u=1/0,s=-1/0,l=-1/0,c=0,f=i.length;c<f;c+=o){var h=i[c]*n-i[c+1]*r,y=i[c]*r+i[c+1]*n;a=Math.min(a,h),u=Math.min(u,y),s=Math.max(s,h),l=Math.max(l,y)}return[a,u,s,l]}},{key:"fitInternal",value:function(t,e){var n=(e=e||{}).size;n||(n=this.getViewportSizeMinusPadding_());var r,i=void 0!==e.padding?e.padding:[0,0,0,0],o=void 0!==e.nearest&&e.nearest;r=void 0!==e.minResolution?e.minResolution:void 0!==e.maxZoom?this.getResolutionForZoom(e.maxZoom):0;var a=this.rotatedExtentForGeometry(t),u=this.getResolutionForExtentInternal(a,[n[0]-i[1]-i[3],n[1]-i[0]-i[2]]);u=isNaN(u)?r:Math.max(u,r),u=this.getConstrainedResolution(u,o?0:1);var s=this.getRotation(),l=Math.sin(s),c=Math.cos(s),f=Oe(a);f[0]+=(i[1]-i[3])/2*u,f[1]+=(i[0]-i[2])/2*u;var h=f[0]*c-f[1]*l,y=f[1]*c+f[0]*l,p=this.getConstrainedCenter([h,y],u),d=e.callback?e.callback:w;void 0!==e.duration?this.animateInternal({resolution:u,center:p,duration:e.duration,easing:e.easing},d):(this.targetResolution_=u,this.targetCenter_=p,this.applyTargetState_(!1,!0),yi(d,!0))}},{key:"centerOn",value:function(t,e,n){this.centerOnInternal(xn(t,this.getProjection()),e,n)}},{key:"centerOnInternal",value:function(t,e,n){this.setCenterInternal(di(t,e,n,this.getResolution(),this.getRotation()))}},{key:"calculateCenterShift",value:function(t,e,n,r){var i,o=this.padding_;if(o&&t){var a=this.getViewportSizeMinusPadding_(-n),u=di(t,r,[a[0]/2+o[3],a[1]/2+o[0]],e,n);i=[t[0]-u[0],t[1]-u[1]]}return i}},{key:"isDef",value:function(){return!!this.getCenterInternal()&&void 0!==this.getResolution()}},{key:"adjustCenter",value:function(t){var e=Sn(this.targetCenter_,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])}},{key:"adjustCenterInternal",value:function(t){var e=this.targetCenter_;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])}},{key:"adjustResolution",value:function(t,e){e=e&&xn(e,this.getProjection()),this.adjustResolutionInternal(t,e)}},{key:"adjustResolutionInternal",value:function(t,e){var n=this.getAnimating()||this.getInteracting(),r=this.getViewportSize_(this.getRotation()),i=this.constraints_.resolution(this.targetResolution_*t,0,r,n);e&&(this.targetCenter_=this.calculateCenterZoom(i,e)),this.targetResolution_*=t,this.applyTargetState_()}},{key:"adjustZoom",value:function(t,e){this.adjustResolution(Math.pow(this.zoomFactor_,-t),e)}},{key:"adjustRotation",value:function(t,e){e&&(e=xn(e,this.getProjection())),this.adjustRotationInternal(t,e)}},{key:"adjustRotationInternal",value:function(t,e){var n=this.getAnimating()||this.getInteracting(),r=this.constraints_.rotation(this.targetRotation_+t,n);e&&(this.targetCenter_=this.calculateCenterRotate(r,e)),this.targetRotation_+=t,this.applyTargetState_()}},{key:"setCenter",value:function(t){this.setCenterInternal(t?xn(t,this.getProjection()):t)}},{key:"setCenterInternal",value:function(t){this.targetCenter_=t,this.applyTargetState_()}},{key:"setHint",value:function(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]}},{key:"setResolution",value:function(t){this.targetResolution_=t,this.applyTargetState_()}},{key:"setRotation",value:function(t){this.targetRotation_=t,this.applyTargetState_()}},{key:"setZoom",value:function(t){this.setResolution(this.getResolutionForZoom(t))}},{key:"applyTargetState_",value:function(t,e){var n=this.getAnimating()||this.getInteracting()||e,r=this.constraints_.rotation(this.targetRotation_,n),i=this.getViewportSize_(r),o=this.constraints_.resolution(this.targetResolution_,0,i,n),a=this.constraints_.center(this.targetCenter_,o,i,n,this.calculateCenterShift(this.targetCenter_,o,r,i));this.get(vt.ROTATION)!==r&&this.set(vt.ROTATION,r),this.get(vt.RESOLUTION)!==o&&(this.set(vt.RESOLUTION,o),this.set("zoom",this.getZoom(),!0)),a&&this.get(vt.CENTER)&&Ze(this.get(vt.CENTER),a)||this.set(vt.CENTER,a),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0}},{key:"resolveConstraints",value:function(t,e,n){t=void 0!==t?t:200;var r=e||0,i=this.constraints_.rotation(this.targetRotation_),o=this.getViewportSize_(i),a=this.constraints_.resolution(this.targetResolution_,r,o),u=this.constraints_.center(this.targetCenter_,a,o,!1,this.calculateCenterShift(this.targetCenter_,a,i,o));if(0===t&&!this.cancelAnchor_)return this.targetResolution_=a,this.targetRotation_=i,this.targetCenter_=u,void this.applyTargetState_();n=n||(0===t?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,this.getResolution()===a&&this.getRotation()===i&&this.getCenterInternal()&&Ze(this.getCenterInternal(),u)||(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:i,center:u,resolution:a,duration:t,easing:Fn,anchor:n}))}},{key:"beginInteraction",value:function(){this.resolveConstraints(0),this.setHint(dt,1)}},{key:"endInteraction",value:function(t,e,n){n=n&&xn(n,this.getProjection()),this.endInteractionInternal(t,e,n)}},{key:"endInteractionInternal",value:function(t,e,n){this.getInteracting()&&(this.setHint(dt,-1),this.resolveConstraints(t,e,n))}},{key:"getConstrainedCenter",value:function(t,e){var n=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,e||this.getResolution(),n)}},{key:"getConstrainedZoom",value:function(t,e){var n=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(n,e))}},{key:"getConstrainedResolution",value:function(t,e){e=e||0;var n=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,e,n)}}])&&si(n.prototype,r),i&&si(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(yt),gi="add",mi="remove";function bi(t){return(bi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Si(r.key),r)}}function wi(t,e,n){return e&&_i(t.prototype,e),n&&_i(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Si(t){var e=function(t,e){if("object"!=bi(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=bi(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==bi(e)?e:e+""}function xi(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Oi(t,e,n){return e=ki(e),function(t,e){if(e&&("object"==bi(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],ki(t).constructor):e.apply(t,n))}function ki(t){return(ki=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Pi(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ei(t,e)}function Ei(t,e){return(Ei=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var ji="length",Ci=function(t){function e(t,n,r){var i;return xi(this,e),(i=Oi(this,e,[t])).element=n,i.index=r,i}return Pi(e,t),wi(e)}(s),Ti=function(t){function e(t,n){var r;if(xi(this,e),(r=Oi(this,e)).on,r.once,r.un,n=n||{},r.unique_=!!n.unique,r.array_=t||[],r.unique_)for(var i=0,o=r.array_.length;i<o;++i)r.assertUnique_(r.array_[i],i);return r.updateLength_(),r}return Pi(e,t),wi(e,[{key:"clear",value:function(){for(;this.getLength()>0;)this.pop()}},{key:"extend",value:function(t){for(var e=0,n=t.length;e<n;++e)this.push(t[e]);return this}},{key:"forEach",value:function(t){for(var e=this.array_,n=0,r=e.length;n<r;++n)t(e[n],n,e)}},{key:"getArray",value:function(){return this.array_}},{key:"item",value:function(t){return this.array_[t]}},{key:"getLength",value:function(){return this.get(ji)}},{key:"insertAt",value:function(t,e){if(t<0||t>this.getLength())throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new Ci(gi,e,t))}},{key:"pop",value:function(){return this.removeAt(this.getLength()-1)}},{key:"push",value:function(t){this.unique_&&this.assertUnique_(t);var e=this.getLength();return this.insertAt(e,t),this.getLength()}},{key:"remove",value:function(t){for(var e=this.array_,n=0,r=e.length;n<r;++n)if(e[n]===t)return this.removeAt(n)}},{key:"removeAt",value:function(t){if(!(t<0||t>=this.getLength())){var e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new Ci(mi,e,t)),e}}},{key:"setAt",value:function(t,e){if(t>=this.getLength())this.insertAt(t,e);else{if(t<0)throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e,t);var n=this.array_[t];this.array_[t]=e,this.dispatchEvent(new Ci(mi,n,t)),this.dispatchEvent(new Ci(gi,e,t))}}},{key:"updateLength_",value:function(){this.set(ji,this.array_.length)}},{key:"assertUnique_",value:function(t,e){for(var n=0,r=this.array_.length;n<r;++n)if(this.array_[n]===t&&n!==e)throw new Error("Duplicate item added to a unique collection")}}])}(yt),Ri="opacity",Ii="visible",Mi="extent",Li="zIndex",Ai="maxResolution",Fi="minResolution",Di="maxZoom",Ni="minZoom",zi="source",Bi="map";function Gi(t){return(Gi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Wi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Xi(r.key),r)}}function Xi(t){var e=function(t,e){if("object"!=Gi(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Gi(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Gi(e)?e:e+""}function Yi(t,e,n){return e=Ui(e),function(t,e){if(e&&("object"==Gi(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],Ui(t).constructor):e.apply(t,n))}function Ki(){return(Ki="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=Zi(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}}).apply(null,arguments)}function Zi(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=Ui(t)););return t}function Ui(t){return(Ui=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Vi(t,e){return(Vi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var qi=function(t){function e(t){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Yi(this,e)).on,n.once,n.un,n.background_=t.background;var r=Object.assign({},t);return"object"===Gi(t.properties)&&(delete r.properties,Object.assign(r,t.properties)),r[Ri]=void 0!==t.opacity?t.opacity:1,En("number"==typeof r[Ri],"Layer opacity must be a number"),r[Ii]=void 0===t.visible||t.visible,r[Li]=t.zIndex,r[Ai]=void 0!==t.maxResolution?t.maxResolution:1/0,r[Fi]=void 0!==t.minResolution?t.minResolution:0,r[Ni]=void 0!==t.minZoom?t.minZoom:-1/0,r[Di]=void 0!==t.maxZoom?t.maxZoom:1/0,n.className_=void 0!==r.className?r.className:"ol-layer",delete r.className,n.setProperties(r),n.state_=null,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Vi(t,e)}(e,t),function(t,e,n){return e&&Wi(t.prototype,e),n&&Wi(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(e,[{key:"getBackground",value:function(){return this.background_}},{key:"getClassName",value:function(){return this.className_}},{key:"getLayerState",value:function(t){var e=this.state_||{layer:this,managed:void 0===t||t},n=this.getZIndex();return e.opacity=De(Math.round(100*this.getOpacity())/100,0,1),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=void 0!==n||e.managed?n:1/0,e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),e.minZoom=this.getMinZoom(),e.maxZoom=this.getMaxZoom(),this.state_=e,e}},{key:"getLayersArray",value:function(t){return tt()}},{key:"getLayerStatesArray",value:function(t){return tt()}},{key:"getExtent",value:function(){return this.get(Mi)}},{key:"getMaxResolution",value:function(){return this.get(Ai)}},{key:"getMinResolution",value:function(){return this.get(Fi)}},{key:"getMinZoom",value:function(){return this.get(Ni)}},{key:"getMaxZoom",value:function(){return this.get(Di)}},{key:"getOpacity",value:function(){return this.get(Ri)}},{key:"getSourceState",value:function(){return tt()}},{key:"getVisible",value:function(){return this.get(Ii)}},{key:"getZIndex",value:function(){return this.get(Li)}},{key:"setBackground",value:function(t){this.background_=t,this.changed()}},{key:"setExtent",value:function(t){this.set(Mi,t)}},{key:"setMaxResolution",value:function(t){this.set(Ai,t)}},{key:"setMinResolution",value:function(t){this.set(Fi,t)}},{key:"setMaxZoom",value:function(t){this.set(Di,t)}},{key:"setMinZoom",value:function(t){this.set(Ni,t)}},{key:"setOpacity",value:function(t){En("number"==typeof t,"Layer opacity must be a number"),this.set(Ri,t)}},{key:"setVisible",value:function(t){this.set(Ii,t)}},{key:"setZIndex",value:function(t){this.set(Li,t)}},{key:"disposeInternal",value:function(){var t,n,r,i,o;this.state_&&(this.state_.layer=null,this.state_=null),(t=e,n="disposeInternal",r=this,o=Ki(Ui(1&(i=3)?t.prototype:t),n,r),2&i&&"function"==typeof o?function(t){return o.apply(r,t)}:o)([])}}])}(yt),Hi="prerender",Ji="postrender",$i="precompose",Qi="postcompose",to="rendercomplete";function eo(t){return(eo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function no(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ro(r.key),r)}}function ro(t){var e=function(t,e){if("object"!=eo(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=eo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==eo(e)?e:e+""}function io(t,e,n){return e=uo(e),function(t,e){if(e&&("object"==eo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],uo(t).constructor):e.apply(t,n))}function oo(){return(oo="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=ao(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}}).apply(null,arguments)}function ao(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=uo(t)););return t}function uo(t){return(uo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function so(t,e){return(so=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function lo(t,e){if(!t.visible)return!1;var n=e.resolution;if(n<t.minResolution||n>=t.maxResolution)return!1;var r=e.zoom;return r>t.minZoom&&r<=t.maxZoom}var co=function(t){function e(t){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=Object.assign({},t);delete r.source,(n=io(this,e,[r])).on,n.once,n.un,n.mapPrecomposeKey_=null,n.mapRenderKey_=null,n.sourceChangeKey_=null,n.renderer_=null,n.sourceReady_=!1,n.rendered=!1,t.render&&(n.render=t.render),t.map&&n.setMap(t.map),n.addChangeListener(zi,n.handleSourcePropertyChange_);var i=t.source?t.source:null;return n.setSource(i),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&so(t,e)}(e,t),function(t,e,n){return e&&no(t.prototype,e),n&&no(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(e,[{key:"getLayersArray",value:function(t){return(t=t||[]).push(this),t}},{key:"getLayerStatesArray",value:function(t){return(t=t||[]).push(this.getLayerState()),t}},{key:"getSource",value:function(){return this.get(zi)||null}},{key:"getRenderSource",value:function(){return this.getSource()}},{key:"getSourceState",value:function(){var t=this.getSource();return t?t.getState():"undefined"}},{key:"handleSourceChange_",value:function(){this.changed(),this.sourceReady_||"ready"!==this.getSource().getState()||(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}},{key:"handleSourcePropertyChange_",value:function(){var t=this;this.sourceChangeKey_&&(K(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;var e=this.getSource();e&&(this.sourceChangeKey_=X(e,M,this.handleSourceChange_,this),"ready"===e.getState()&&(this.sourceReady_=!0,setTimeout((function(){t.dispatchEvent("sourceready")}),0))),this.changed()}},{key:"getFeatures",value:function(t){return this.renderer_?this.renderer_.getFeatures(t):Promise.resolve([])}},{key:"getData",value:function(t){return this.renderer_&&this.rendered?this.renderer_.getData(t):null}},{key:"isVisible",value:function(t){var e,n,r=this,i=this.getMapInternal();!t&&i&&(t=i.getView()),!(e=t instanceof vi?{viewState:t.getState(),extent:t.calculateExtent()}:t).layerStatesArray&&i&&(e.layerStatesArray=i.getLayerGroup().getLayerStatesArray()),n=e.layerStatesArray?e.layerStatesArray.find((function(t){return t.layer===r})):this.getLayerState();var o=this.getExtent();return lo(n,e.viewState)&&(!o||Ie(o,e.extent))}},{key:"getAttributions",value:function(t){var e;if(!this.isVisible(t))return[];var n=null===(e=this.getSource())||void 0===e?void 0:e.getAttributions();if(!n)return[];var r=n(t instanceof vi?t.getViewStateAndExtent():t);return Array.isArray(r)||(r=[r]),r}},{key:"render",value:function(t,e){var n=this.getRenderer();return n.prepareFrame(t)?(this.rendered=!0,n.renderFrame(t,e)):null}},{key:"unrender",value:function(){this.rendered=!1}},{key:"getDeclutter",value:function(){}},{key:"renderDeclutter",value:function(t,e){}},{key:"renderDeferred",value:function(t){var e=this.getRenderer();e&&e.renderDeferred(t)}},{key:"setMapInternal",value:function(t){t||this.unrender(),this.set(Bi,t)}},{key:"getMapInternal",value:function(){return this.get(Bi)}},{key:"setMap",value:function(t){var e=this;this.mapPrecomposeKey_&&(K(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(K(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=X(t,$i,(function(t){var n=t.frameState.layerStatesArray,r=e.getLayerState(!1);En(!n.some((function(t){return t.layer===r.layer})),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),n.push(r)})),this.mapRenderKey_=X(this,M,t.render,t),this.changed())}},{key:"setSource",value:function(t){this.set(zi,t)}},{key:"getRenderer",value:function(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}},{key:"hasRenderer",value:function(){return!!this.renderer_}},{key:"createRenderer",value:function(){return null}},{key:"disposeInternal",value:function(){var t,n,r,i,o;this.renderer_&&(this.renderer_.dispose(),delete this.renderer_),this.setSource(null),(t=e,n="disposeInternal",r=this,o=oo(uo(1&(i=3)?t.prototype:t),n,r),2&i&&"function"==typeof o?function(t){return o.apply(r,t)}:o)([])}}])}(qi),fo=n(1),ho=n.n(fo),yo=0,po=1,vo=2,go=3;function mo(t){return t[0]>0&&t[1]>0}function bo(t,e){return Array.isArray(t)?t:(void 0===e?e=[t,t]:(e[0]=t,e[1]=t),e)}function _o(t){return(_o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function wo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,So(r.key),r)}}function So(t){var e=function(t,e){if("object"!=_o(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=_o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==_o(e)?e:e+""}var xo=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=bo(e.scale),this.displacement_=e.displacement,this.declutterMode_=e.declutterMode}return e=t,(n=[{key:"clone",value:function(){var e=this.getScale();return new t({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}},{key:"getOpacity",value:function(){return this.opacity_}},{key:"getRotateWithView",value:function(){return this.rotateWithView_}},{key:"getRotation",value:function(){return this.rotation_}},{key:"getScale",value:function(){return this.scale_}},{key:"getScaleArray",value:function(){return this.scaleArray_}},{key:"getDisplacement",value:function(){return this.displacement_}},{key:"getDeclutterMode",value:function(){return this.declutterMode_}},{key:"getAnchor",value:function(){return tt()}},{key:"getImage",value:function(t){return tt()}},{key:"getHitDetectionImage",value:function(){return tt()}},{key:"getPixelRatio",value:function(t){return 1}},{key:"getImageState",value:function(){return tt()}},{key:"getImageSize",value:function(){return tt()}},{key:"getOrigin",value:function(){return tt()}},{key:"getSize",value:function(){return tt()}},{key:"setDisplacement",value:function(t){this.displacement_=t}},{key:"setOpacity",value:function(t){this.opacity_=t}},{key:"setRotateWithView",value:function(t){this.rotateWithView_=t}},{key:"setRotation",value:function(t){this.rotation_=t}},{key:"setScale",value:function(t){this.scale_=t,this.scaleArray_=bo(t)}},{key:"listenImageChange",value:function(t){tt()}},{key:"load",value:function(){tt()}},{key:"unlistenImageChange",value:function(t){tt()}},{key:"ready",value:function(){return Promise.resolve()}}])&&wo(e.prototype,n),r&&wo(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n,r}(),Oo={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]},ko={name:"xyz",min:[0,0,0],channel:["X","Y","Z"],alias:["XYZ","ciexyz","cie1931"],whitepoint:{2:{A:[109.85,100,35.585],C:[98.074,100,118.232],D50:[96.422,100,82.521],D55:[95.682,100,92.149],D65:[95.045592705167,100,108.9057750759878],D75:[94.972,100,122.638],F2:[99.187,100,67.395],F7:[95.044,100,108.755],F11:[100.966,100,64.37],E:[100,100,100]},10:{A:[111.144,100,35.2],C:[97.285,100,116.145],D50:[96.72,100,81.427],D55:[95.799,100,90.926],D65:[94.811,100,107.304],D75:[94.416,100,120.641],F2:[103.28,100,69.026],F7:[95.792,100,107.687],F11:[103.866,100,65.627],E:[100,100,100]}}};ko.max=ko.whitepoint[2].D65,ko.rgb=function(t,e){e=e||ko.whitepoint[2].E;var n,r,i,o=t[0]/e[0],a=t[1]/e[1],u=t[2]/e[2];return r=-.96924363628087*o+1.87596750150772*a+.041555057407175*u,i=.055630079696993*o+-.20397695888897*a+1.056971514242878*u,n=(n=3.240969941904521*o+-1.537383177570093*a+-.498610760293*u)>.0031308?1.055*Math.pow(n,1/2.4)-.055:n*=12.92,r=r>.0031308?1.055*Math.pow(r,1/2.4)-.055:r*=12.92,i=i>.0031308?1.055*Math.pow(i,1/2.4)-.055:i*=12.92,[255*(n=Math.min(Math.max(0,n),1)),255*(r=Math.min(Math.max(0,r),1)),255*(i=Math.min(Math.max(0,i),1))]},Oo.xyz=function(t,e){var n=t[0]/255,r=t[1]/255,i=t[2]/255,o=.21263900587151*(n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92)+.71516867876775*(r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92)+.072192315360733*(i=i>.04045?Math.pow((i+.055)/1.055,2.4):i/12.92),a=.019330818715591*n+.11919477979462*r+.95053215224966*i;return[(.41239079926595*n+.35758433938387*r+.18048078840183*i)*(e=e||ko.whitepoint[2].E)[0],o*e[1],a*e[2]]};var Po=ko,Eo={name:"luv",min:[0,-134,-140],max:[100,224,122],channel:["lightness","u","v"],alias:["LUV","cieluv","cie1976"],xyz:function(t,e,n){var r,i,o,a,u,s,l,c,f;if(o=t[0],a=t[1],u=t[2],0===o)return[0,0,0];return e=e||"D65",n=n||2,r=a/(13*o)+4*(l=Po.whitepoint[n][e][0])/(l+15*(c=Po.whitepoint[n][e][1])+3*(f=Po.whitepoint[n][e][2]))||0,i=u/(13*o)+9*c/(l+15*c+3*f)||0,[9*(s=o>8?c*Math.pow((o+16)/116,3):c*o*.0011070564598794539)*r/(4*i)||0,s,s*(12-3*r-20*i)/(4*i)||0]}};Po.luv=function(t,e,n){var r,i,o,a,u,s,l,c,f,h,y;e=e||"D65",n=n||2,h=4*(l=Po.whitepoint[n][e][0])/(l+15*(c=Po.whitepoint[n][e][1])+3*(f=Po.whitepoint[n][e][2])),y=9*c/(l+15*c+3*f),r=4*(a=t[0])/(a+15*(u=t[1])+3*(s=t[2]))||0,i=9*u/(a+15*u+3*s)||0;var p=u/c;return[o=p<=.008856451679035631?903.2962962962961*p:116*Math.pow(p,1/3)-16,13*o*(r-h),13*o*(i-y)]};var jo={name:"lchuv",channel:["lightness","chroma","hue"],alias:["LCHuv","cielchuv"],min:[0,0,0],max:[100,100,360],luv:function(t){var e,n=t[0],r=t[1];return e=t[2]/360*2*Math.PI,[n,r*Math.cos(e),r*Math.sin(e)]},xyz:function(t){return Eo.xyz(jo.luv(t))}},Co=jo;Eo.lchuv=function(t){var e=t[0],n=t[1],r=t[2],i=Math.sqrt(n*n+r*r),o=360*Math.atan2(r,n)/2/Math.PI;return o<0&&(o+=360),[e,i,o]},Po.lchuv=function(t){return Eo.lchuv(Po.luv(t))};var To={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},Ro=function(t){var e,n,r=[],i=1;if("number"==typeof t)return{space:"rgb",values:[t>>>16,(65280&t)>>>8,255&t],alpha:1};if("number"==typeof t)return{space:"rgb",values:[t>>>16,(65280&t)>>>8,255&t],alpha:1};if(t=String(t).toLowerCase(),To[t])r=To[t].slice(),n="rgb";else if("transparent"===t)i=0,n="rgb",r=[0,0,0];else if("#"===t[0]){var o=t.slice(1),a=o.length;i=1,a<=4?(r=[parseInt(o[0]+o[0],16),parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16)],4===a&&(i=parseInt(o[3]+o[3],16)/255)):(r=[parseInt(o[0]+o[1],16),parseInt(o[2]+o[3],16),parseInt(o[4]+o[5],16)],8===a&&(i=parseInt(o[6]+o[7],16)/255)),r[0]||(r[0]=0),r[1]||(r[1]=0),r[2]||(r[2]=0),n="rgb"}else if(e=/^((?:rgba?|hs[lvb]a?|hwba?|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms|oklch|oklab|color))\s*\(([^\)]*)\)/.exec(t)){var u=e[1],s="cmyk"===(n=u.replace(/a$/,""))?4:"gray"===n?1:3;r=e[2].trim().split(/\s*[,\/]\s*|\s+/),"color"===n&&(n=r.shift()),r=r.map((function(t,e){if("%"===t[t.length-1])return t=parseFloat(t)/100,3===e?t:"rgb"===n?255*t:"h"===n[0]?100*t:"l"!==n[0]||e?"lab"===n?125*t:"lch"===n?e<2?150*t:360*t:"o"!==n[0]||e?"oklab"===n?.4*t:"oklch"===n?e<2?.4*t:360*t:t:t:100*t;if("h"===n[e]||2===e&&"h"===n[n.length-1]){if(void 0!==Io[t])return Io[t];if(t.endsWith("deg"))return parseFloat(t);if(t.endsWith("turn"))return 360*parseFloat(t);if(t.endsWith("grad"))return 360*parseFloat(t)/400;if(t.endsWith("rad"))return 180*parseFloat(t)/Math.PI}return"none"===t?0:parseFloat(t)})),i=r.length>s?r.pop():1}else if(/[0-9](?:\s|\/|,)/.test(t)){var l;r=t.match(/([0-9]+)/g).map((function(t){return parseFloat(t)})),n=(null===(l=t.match(/([a-z])/gi))||void 0===l||null===(l=l.join(""))||void 0===l?void 0:l.toLowerCase())||"rgb"}return{space:n,values:r,alpha:i}},Io={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};var Mo={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(t){var e,n,r,i,o,a=t[0]/360,u=t[1]/100,s=t[2]/100,l=0;if(0===u)return[o=255*s,o,o];for(e=2*s-(n=s<.5?s*(1+u):s+u-s*u),i=[0,0,0];l<3;)(r=a+1/3*-(l-1))<0?r++:r>1&&r--,o=6*r<1?e+6*(n-e)*r:2*r<1?n:3*r<2?e+(n-e)*(2/3-r)*6:e,i[l++]=255*o;return i}};function Lo(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Ao(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ao(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}function Ao(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}Oo.hsl=function(t){var e,n,r=t[0]/255,i=t[1]/255,o=t[2]/255,a=Math.min(r,i,o),u=Math.max(r,i,o),s=u-a;return u===a?e=0:r===u?e=(i-o)/s:i===u?e=2+(o-r)/s:o===u&&(e=4+(r-i)/s),(e=Math.min(60*e,360))<0&&(e+=360),n=(a+u)/2,[e,100*(u===a?0:n<=.5?s/(u+a):s/(2-u-a)),100*n]};var Fo=[NaN,NaN,NaN,0];var Do={},No=0;function zo(t){if(4===t.length)return t;var e=t.slice();return e[3]=1,e}function Bo(t){var e=Po.lchuv(Oo.xyz(t));return e[3]=t[3],e}function Go(t){if("none"===t)return Fo;if(Do.hasOwnProperty(t))return Do[t];if(No>=1024){var e=0;for(var n in Do)0==(3&e++)&&(delete Do[n],--No)}var r=function(t){var e;Array.isArray(t)&&t.raw&&(t=String.raw.apply(String,arguments)),t instanceof Number&&(t=+t);var n=Ro(t);if(!n.space)return[];var r="h"===n.space[0]?Mo.min:Oo.min,i="h"===n.space[0]?Mo.max:Oo.max;return(e=Array(3))[0]=Math.min(Math.max(n.values[0],r[0]),i[0]),e[1]=Math.min(Math.max(n.values[1],r[1]),i[1]),e[2]=Math.min(Math.max(n.values[2],r[2]),i[2]),"h"===n.space[0]&&(e=Mo.rgb(e)),e.push(Math.min(Math.max(n.alpha,0),1)),e}(t);if(4!==r.length)throw new Error('failed to parse "'+t+'" as color');var i,o=Lo(r);try{for(o.s();!(i=o.n()).done;){var a=i.value;if(isNaN(a))throw new Error('failed to parse "'+t+'" as color')}}catch(t){o.e(t)}finally{o.f()}return Xo(r),Do[t]=r,++No,r}function Wo(t){return Array.isArray(t)?t:Go(t)}function Xo(t){return t[0]=De(t[0]+.5|0,0,255),t[1]=De(t[1]+.5|0,0,255),t[2]=De(t[2]+.5|0,0,255),t[3]=De(t[3],0,1),t}function Yo(t){var e=t[0];e!=(0|e)&&(e=e+.5|0);var n=t[1];n!=(0|n)&&(n=n+.5|0);var r=t[2];return r!=(0|r)&&(r=r+.5|0),"rgba("+e+","+n+","+r+","+(void 0===t[3]?1:Math.round(1e3*t[3])/1e3)+")"}var Ko,Zo="undefined"!=typeof navigator&&void 0!==navigator.userAgent?navigator.userAgent.toLowerCase():"",Uo=Zo.includes("firefox"),Vo=(Zo.includes("safari")&&!Zo.includes("chrom")&&(Zo.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(Zo)),Zo.includes("webkit")&&!Zo.includes("edge")),qo=Zo.includes("macintosh"),Ho="undefined"!=typeof devicePixelRatio?devicePixelRatio:1,Jo="undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof OffscreenCanvas&&self instanceof WorkerGlobalScope,$o="undefined"!=typeof Image&&Image.prototype.decode,Qo=function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch(t){}return t}();function ta(t,e,n,r){var i;return i=n&&n.length?n.shift():Jo?new OffscreenCanvas(t||300,e||300):document.createElement("canvas"),t&&(i.width=t),e&&(i.height=e),i.getContext("2d",r)}function ea(){return Ko||(Ko=ta(1,1)),Ko}function na(t){var e=t.canvas;e.width=1,e.height=1,t.clearRect(0,0,1,1)}function ra(t){var e=t.offsetWidth,n=getComputedStyle(t);return e+=parseInt(n.marginLeft,10)+parseInt(n.marginRight,10)}function ia(t){var e=t.offsetHeight,n=getComputedStyle(t);return e+=parseInt(n.marginTop,10)+parseInt(n.marginBottom,10)}function oa(t,e){var n=e.parentNode;n&&n.replaceChild(t,e)}function aa(t){for(;t.lastChild;)t.lastChild.remove()}function ua(t,e){return e&&(t.src=e),t.src&&$o?new Promise((function(e,n){return t.decode().then((function(){return e(t)})).catch((function(r){return t.complete&&t.width?e(t):n(r)}))})):function(t,e){return new Promise((function(n,r){function i(){a(),n(t)}function o(){a(),r(new Error("Image load error"))}function a(){t.removeEventListener("load",i),t.removeEventListener("error",o)}t.addEventListener("load",i),t.addEventListener("error",o),e&&(t.src=e)}))}(t)}function sa(t){return(sa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function la(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ca(r.key),r)}}function ca(t){var e=function(t,e){if("object"!=sa(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=sa(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==sa(e)?e:e+""}var fa=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=32},(e=[{key:"clear",value:function(){this.cache_={},this.patternCache_={},this.cacheSize_=0}},{key:"canExpireCache",value:function(){return this.cacheSize_>this.maxCacheSize_}},{key:"expire",value:function(){if(this.canExpireCache()){var t=0;for(var e in this.cache_){var n=this.cache_[e];0!=(3&t++)||n.hasListener()||(delete this.cache_[e],delete this.patternCache_[e],--this.cacheSize_)}}}},{key:"get",value:function(t,e,n){var r=ha(t,e,n);return r in this.cache_?this.cache_[r]:null}},{key:"getPattern",value:function(t,e,n){var r=ha(t,e,n);return r in this.patternCache_?this.patternCache_[r]:null}},{key:"set",value:function(t,e,n,r,i){var o=this,a=ha(t,e,n),u=a in this.cache_;this.cache_[a]=r,i&&(r.getImageState()===yo&&r.load(),r.getImageState()===po?r.ready().then((function(){o.patternCache_[a]=ea().createPattern(r.getImage(1),"repeat")})):this.patternCache_[a]=ea().createPattern(r.getImage(1),"repeat")),u||++this.cacheSize_}},{key:"setSize",value:function(t){this.maxCacheSize_=t,this.expire()}}])&&la(t.prototype,e),n&&la(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}();function ha(t,e,n){return e+":"+t+":"+(n?Wo(n):"null")}var ya=new fa;function pa(t){return(pa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function da(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,va(r.key),r)}}function va(t){var e=function(t,e){if("object"!=pa(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=pa(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==pa(e)?e:e+""}function ga(t,e,n){return e=ma(e),function(t,e){if(e&&("object"==pa(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],ma(t).constructor):e.apply(t,n))}function ma(t){return(ma=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ba(t,e){return(ba=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var _a=null,wa=function(t){function e(t,n,r,i,o){var a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(a=ga(this,e)).hitDetectionImage_=null,a.image_=t,a.crossOrigin_=r,a.canvas_={},a.color_=o,a.imageState_=void 0===i?yo:i,a.size_=t&&t.width&&t.height?[t.width,t.height]:null,a.src_=n,a.tainted_,a.ready_=null,a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ba(t,e)}(e,t),n=e,(r=[{key:"initializeImage_",value:function(){this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)}},{key:"isTainted_",value:function(){if(void 0===this.tainted_&&this.imageState_===vo){_a||(_a=ta(1,1,void 0,{willReadFrequently:!0})),_a.drawImage(this.image_,0,0);try{_a.getImageData(0,0,1,1),this.tainted_=!1}catch(t){_a=null,this.tainted_=!0}}return!0===this.tainted_}},{key:"dispatchChangeEvent_",value:function(){this.dispatchEvent(M)}},{key:"handleImageError_",value:function(){this.imageState_=go,this.dispatchChangeEvent_()}},{key:"handleImageLoad_",value:function(){this.imageState_=vo,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}},{key:"getImage",value:function(t){return this.image_||this.initializeImage_(),this.replaceColor_(t),this.canvas_[t]?this.canvas_[t]:this.image_}},{key:"getPixelRatio",value:function(t){return this.replaceColor_(t),this.canvas_[t]?t:1}},{key:"getImageState",value:function(){return this.imageState_}},{key:"getHitDetectionImage",value:function(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){var t=this.size_[0],e=this.size_[1],n=ta(t,e);n.fillRect(0,0,t,e),this.hitDetectionImage_=n.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}},{key:"getSize",value:function(){return this.size_}},{key:"getSrc",value:function(){return this.src_}},{key:"load",value:function(){var t=this;if(this.imageState_===yo){this.image_||this.initializeImage_(),this.imageState_=po;try{void 0!==this.src_&&(this.image_.src=this.src_)}catch(t){this.handleImageError_()}this.image_ instanceof HTMLImageElement&&ua(this.image_,this.src_).then((function(e){t.image_=e,t.handleImageLoad_()})).catch(this.handleImageError_.bind(this))}}},{key:"replaceColor_",value:function(t){if(this.color_&&!this.canvas_[t]&&this.imageState_===vo){var e=this.image_,n=document.createElement("canvas");n.width=Math.ceil(e.width*t),n.height=Math.ceil(e.height*t);var r,i=n.getContext("2d");i.scale(t,t),i.drawImage(e,0,0),i.globalCompositeOperation="multiply",i.fillStyle="string"==typeof(r=this.color_)?r:Yo(r),i.fillRect(0,0,n.width/t,n.height/t),i.globalCompositeOperation="destination-in",i.drawImage(e,0,0),this.canvas_[t]=n}}},{key:"ready",value:function(){var t=this;return this.ready_||(this.ready_=new Promise((function(e){if(t.imageState_===vo||t.imageState_===go)e();else{var n=function(){t.imageState_!==vo&&t.imageState_!==go||(t.removeEventListener(M,n),e())};t.addEventListener(M,n)}}))),this.ready_}}])&&da(n.prototype,r),i&&da(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(I);function Sa(t,e,n,r,i,o){var a=void 0===e?void 0:ya.get(e,n,i);return a||(a=new wa(t,t&&"src"in t?t.src||void 0:e,n,r,i),ya.set(e,n,i,a,o)),o&&a&&!ya.getPattern(e,n,i)&&ya.set(e,n,i,a,o),a}function xa(t){return(xa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Oa(t){return t?Array.isArray(t)?Yo(t):"object"===xa(t)&&"src"in t?function(t){if(!t.offset||!t.size)return ya.getPattern(t.src,"anonymous",t.color);var e=t.src+":"+t.offset,n=ya.getPattern(e,void 0,t.color);if(n)return n;var r=ya.get(t.src,"anonymous",null);if(r.getImageState()!==vo)return null;var i=ta(t.size[0],t.size[1]);return i.drawImage(r.getImage(1),t.offset[0],t.offset[1],t.size[0],t.size[1],0,0,t.size[0],t.size[1]),Sa(i.canvas,e,void 0,vo,t.color,!0),ya.getPattern(e,void 0,t.color)}(t):t:null}var ka=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))","?\\s*([-,\\\"\\'\\sa-z]+?)\\s*$"].join(""),"i"),Pa=["style","variant","weight","size","lineHeight","family"],Ea=function(t){var e=t.match(ka);if(!e)return null;for(var n={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"},r=0,i=Pa.length;r<i;++r){var o=e[r+1];void 0!==o&&(n[Pa[r]]=o)}return n.families=n.family.split(/,\s?/),n};function ja(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,u=[],s=!0,l=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=o.call(n)).done)&&(u.push(r.value),u.length!==e);s=!0);}catch(t){l=!0,i=t}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return u}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Ca(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ca(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ca(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var Ta,Ra,Ia=[],Ma=[0,0,0,0],La=new yt,Aa=null,Fa={},Da=function(){var t,e,n=["monospace","serif"],r=n.length,i="wmytzilWMYTZIL@#/&?$%10";function o(t,o,a){for(var u=!0,s=0;s<r;++s){var l=n[s];if(e=Ba(t+" "+o+" 32px "+l,i),a!=l){var c=Ba(t+" "+o+" 32px "+a+","+l,i);u=u&&c!=e}}return!!u}function a(){for(var e=!0,n=La.getKeys(),r=0,i=n.length;r<i;++r){var a=n[r];if(La.get(a)<100){var u=ja(a.split("\n"),3);o(u[0],u[1],u[2])?(O(Fa),Aa=null,Ta=void 0,La.set(a,100)):(La.set(a,La.get(a)+1,!0),e=!1)}}e&&(clearInterval(t),t=void 0)}return function(e){var n=Ea(e);if(n)for(var r=n.families,i=0,u=r.length;i<u;++i){var s=r[i],l=n.style+"\n"+n.weight+"\n"+s;void 0===La.get(l)&&(La.set(l,100,!0),o(n.style,n.weight,s)||(La.set(l,0,!0),void 0===t&&(t=setInterval(a,32))))}}}(),Na=function(t){var e=Fa[t];if(null==e){if(Jo){var n=Ea(t),r=za(t,"g");e=(isNaN(Number(n.lineHeight))?1.2:Number(n.lineHeight))*(r.actualBoundingBoxAscent+r.actualBoundingBoxDescent)}else Ra||((Ra=document.createElement("div")).innerHTML="M",Ra.style.minHeight="0",Ra.style.maxHeight="none",Ra.style.height="auto",Ra.style.padding="0",Ra.style.border="none",Ra.style.position="absolute",Ra.style.display="block",Ra.style.left="-99999px"),Ra.style.font=t,document.body.appendChild(Ra),e=Ra.offsetHeight,document.body.removeChild(Ra);Fa[t]=e}return e};function za(t,e){return Aa||(Aa=ta(1,1)),t!=Ta&&(Aa.font=t,Ta=Aa.font),Aa.measureText(e)}function Ba(t,e){return za(t,e).width}function Ga(t,e,n){if(e in n)return n[e];var r=e.split("\n").reduce((function(e,n){return Math.max(e,Ba(t,n))}),0);return n[e]=r,r}function Wa(t,e,n,r,i,o,a,u,s,l,c){t.save(),1!==n&&(void 0===t.globalAlpha?t.globalAlpha=function(t){return t.globalAlpha*=n}:t.globalAlpha*=n),e&&t.transform.apply(t,e),r.contextInstructions?(t.translate(s,l),t.scale(c[0],c[1]),function(t,e){for(var n=t.contextInstructions,r=0,i=n.length;r<i;r+=2)Array.isArray(n[r+1])?e[n[r]].apply(e,n[r+1]):e[n[r]]=n[r+1]}(r,t)):c[0]<0||c[1]<0?(t.translate(s,l),t.scale(c[0],c[1]),t.drawImage(r,i,o,a,u,0,0,a,u)):t.drawImage(r,i,o,a,u,s,l,a*c[0],u*c[1]),t.restore()}function Xa(t){return(Xa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ya(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ka(r.key),r)}}function Ka(t){var e=function(t,e){if("object"!=Xa(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Xa(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Xa(e)?e:e+""}function Za(t,e,n){return e=Ua(e),function(t,e){if(e&&("object"==Xa(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],Ua(t).constructor):e.apply(t,n))}function Ua(t){return(Ua=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Va(t,e){return(Va=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var qa=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Za(this,e,[{opacity:1,rotateWithView:void 0!==t.rotateWithView&&t.rotateWithView,rotation:void 0!==t.rotation?t.rotation:0,scale:void 0!==t.scale?t.scale:1,displacement:void 0!==t.displacement?t.displacement:[0,0],declutterMode:t.declutterMode}])).canvases_,n.hitDetectionCanvas_=null,n.fill_=void 0!==t.fill?t.fill:null,n.origin_=[0,0],n.points_=t.points,n.radius=t.radius,n.radius2_=t.radius2,n.angle_=void 0!==t.angle?t.angle:0,n.stroke_=void 0!==t.stroke?t.stroke:null,n.size_,n.renderOptions_,n.imageState_=n.fill_&&n.fill_.loading()?po:vo,n.imageState_===po&&n.ready().then((function(){return n.imageState_=vo})),n.render(),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Va(t,e)}(e,t),function(t,e,n){return e&&Ya(t.prototype,e),n&&Ya(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(e,[{key:"clone",value:function(){var t=this.getScale(),n=new e({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return n.setOpacity(this.getOpacity()),n}},{key:"getAnchor",value:function(){var t=this.size_,e=this.getDisplacement(),n=this.getScaleArray();return[t[0]/2-e[0]/n[0],t[1]/2+e[1]/n[1]]}},{key:"getAngle",value:function(){return this.angle_}},{key:"getFill",value:function(){return this.fill_}},{key:"setFill",value:function(t){this.fill_=t,this.render()}},{key:"getHitDetectionImage",value:function(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}},{key:"getImage",value:function(t){var e=this.canvases_[t];if(!e){var n=this.renderOptions_,r=ta(n.size*t,n.size*t);this.draw_(n,r,t),e=r.canvas,this.canvases_[t]=e}return e}},{key:"getPixelRatio",value:function(t){return t}},{key:"getImageSize",value:function(){return this.size_}},{key:"getImageState",value:function(){return this.imageState_}},{key:"getOrigin",value:function(){return this.origin_}},{key:"getPoints",value:function(){return this.points_}},{key:"getRadius",value:function(){return this.radius}},{key:"getRadius2",value:function(){return this.radius2_}},{key:"getSize",value:function(){return this.size_}},{key:"getStroke",value:function(){return this.stroke_}},{key:"setStroke",value:function(t){this.stroke_=t,this.render()}},{key:"listenImageChange",value:function(t){}},{key:"load",value:function(){}},{key:"unlistenImageChange",value:function(t){}},{key:"calculateLineJoinSize_",value:function(t,e,n){if(0===e||this.points_===1/0||"bevel"!==t&&"miter"!==t)return e;var r=this.radius,i=void 0===this.radius2_?r:this.radius2_;if(r<i){var o=r;r=i,i=o}var a=void 0===this.radius2_?this.points_:2*this.points_,u=2*Math.PI/a,s=i*Math.sin(u),l=r-Math.sqrt(i*i-s*s),c=Math.sqrt(s*s+l*l),f=c/s;if("miter"===t&&f<=n)return f*e;var h=e/2/f,y=e/2*(l/c),p=Math.sqrt((r+h)*(r+h)+y*y)-r;if(void 0===this.radius2_||"bevel"===t)return 2*p;var d=r*Math.sin(u),v=i-Math.sqrt(r*r-d*d),g=Math.sqrt(d*d+v*v)/d;if(g<=n){var m=g*e/2-i-r;return 2*Math.max(p,m)}return 2*p}},{key:"createRenderOptions",value:function(){var t,e,n,r,i,o,a,u="round",s="round",l=0,c=null,f=0,h=0;this.stroke_&&(t=Oa(null!==(e=this.stroke_.getColor())&&void 0!==e?e:"#000"),h=null!==(n=this.stroke_.getWidth())&&void 0!==n?n:1,c=this.stroke_.getLineDash(),f=null!==(r=this.stroke_.getLineDashOffset())&&void 0!==r?r:0,s=null!==(i=this.stroke_.getLineJoin())&&void 0!==i?i:"round",u=null!==(o=this.stroke_.getLineCap())&&void 0!==o?o:"round",l=null!==(a=this.stroke_.getMiterLimit())&&void 0!==a?a:10);var y=this.calculateLineJoinSize_(s,h,l),p=Math.max(this.radius,this.radius2_||0);return{strokeStyle:t,strokeWidth:h,size:Math.ceil(2*p+y),lineCap:u,lineDash:c,lineDashOffset:f,lineJoin:s,miterLimit:l}}},{key:"render",value:function(){this.renderOptions_=this.createRenderOptions();var t=this.renderOptions_.size;this.canvases_={},this.hitDetectionCanvas_=null,this.size_=[t,t]}},{key:"draw_",value:function(t,e,n){if(e.scale(n,n),e.translate(t.size/2,t.size/2),this.createPath_(e),this.fill_){var r=this.fill_.getColor();null===r&&(r="#000"),e.fillStyle=Oa(r),e.fill()}t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}},{key:"createHitDetectionCanvas_",value:function(t){var e;if(this.fill_){var n=this.fill_.getColor(),r=0;"string"==typeof n&&(n=Wo(n)),null===n?r=1:Array.isArray(n)&&(r=4===n.length?n[3]:1),0===r&&(e=ta(t.size,t.size),this.drawHitDetectionCanvas_(t,e))}return e?e.canvas:this.getImage(1)}},{key:"createPath_",value:function(t){var e=this.points_,n=this.radius;if(e===1/0)t.arc(0,0,n,0,2*Math.PI);else{var r=void 0===this.radius2_?n:this.radius2_;void 0!==this.radius2_&&(e*=2);for(var i=this.angle_-Math.PI/2,o=2*Math.PI/e,a=0;a<e;a++){var u=i+a*o,s=a%2==0?n:r;t.lineTo(s*Math.cos(u),s*Math.sin(u))}t.closePath()}}},{key:"drawHitDetectionCanvas_",value:function(t,e){e.translate(t.size/2,t.size/2),this.createPath_(e),e.fillStyle="#000",e.fill(),t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}},{key:"ready",value:function(){return this.fill_?this.fill_.ready():Promise.resolve()}}])}(xo);function Ha(t){return(Ha="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ja(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,$a(r.key),r)}}function $a(t){var e=function(t,e){if("object"!=Ha(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Ha(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Ha(e)?e:e+""}function Qa(t,e,n){return e=tu(e),function(t,e){if(e&&("object"==Ha(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],tu(t).constructor):e.apply(t,n))}function tu(t){return(tu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function eu(t,e){return(eu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var nu=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Qa(this,e,[{points:1/0,fill:(t=t||{radius:5}).fill,radius:t.radius,stroke:t.stroke,scale:void 0!==t.scale?t.scale:1,rotation:void 0!==t.rotation?t.rotation:0,rotateWithView:void 0!==t.rotateWithView&&t.rotateWithView,displacement:void 0!==t.displacement?t.displacement:[0,0],declutterMode:t.declutterMode}])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&eu(t,e)}(e,t),n=e,(r=[{key:"clone",value:function(){var t=this.getScale(),n=new e({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return n.setOpacity(this.getOpacity()),n}},{key:"setRadius",value:function(t){this.radius=t,this.render()}}])&&Ja(n.prototype,r),i&&Ja(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(qa);function ru(t){return(ru="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function iu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ou(r.key),r)}}function ou(t){var e=function(t,e){if("object"!=ru(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=ru(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ru(e)?e:e+""}var au=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=e||{},this.patternImage_=null,this.color_=null,void 0!==e.color&&this.setColor(e.color)}return e=t,(n=[{key:"clone",value:function(){var e=this.getColor();return new t({color:Array.isArray(e)?e.slice():e||void 0})}},{key:"getColor",value:function(){return this.color_}},{key:"setColor",value:function(t){var e=this;if(null!==t&&"object"===ru(t)&&"src"in t){var n=Sa(null,t.src,"anonymous",void 0,t.offset?null:t.color?t.color:null,!(t.offset&&t.size));n.ready().then((function(){e.patternImage_=null})),n.getImageState()===yo&&n.load(),n.getImageState()===po&&(this.patternImage_=n)}this.color_=t}},{key:"loading",value:function(){return!!this.patternImage_}},{key:"ready",value:function(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}])&&iu(e.prototype,n),r&&iu(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n,r}();function uu(t){return(uu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function su(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,lu(r.key),r)}}function lu(t){var e=function(t,e){if("object"!=uu(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=uu(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==uu(e)?e:e+""}var cu=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=e||{},this.color_=void 0!==e.color?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=void 0!==e.lineDash?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}return e=t,(n=[{key:"clone",value:function(){var e=this.getColor();return new t({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}},{key:"getColor",value:function(){return this.color_}},{key:"getLineCap",value:function(){return this.lineCap_}},{key:"getLineDash",value:function(){return this.lineDash_}},{key:"getLineDashOffset",value:function(){return this.lineDashOffset_}},{key:"getLineJoin",value:function(){return this.lineJoin_}},{key:"getMiterLimit",value:function(){return this.miterLimit_}},{key:"getWidth",value:function(){return this.width_}},{key:"setColor",value:function(t){this.color_=t}},{key:"setLineCap",value:function(t){this.lineCap_=t}},{key:"setLineDash",value:function(t){this.lineDash_=t}},{key:"setLineDashOffset",value:function(t){this.lineDashOffset_=t}},{key:"setLineJoin",value:function(t){this.lineJoin_=t}},{key:"setMiterLimit",value:function(t){this.miterLimit_=t}},{key:"setWidth",value:function(t){this.width_=t}}])&&su(e.prototype,n),r&&su(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n,r}();function fu(t){return(fu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function hu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,yu(r.key),r)}}function yu(t){var e=function(t,e){if("object"!=fu(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=fu(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==fu(e)?e:e+""}var pu=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=e||{},this.geometry_=null,this.geometryFunction_=gu,void 0!==e.geometry&&this.setGeometry(e.geometry),this.fill_=void 0!==e.fill?e.fill:null,this.image_=void 0!==e.image?e.image:null,this.renderer_=void 0!==e.renderer?e.renderer:null,this.hitDetectionRenderer_=void 0!==e.hitDetectionRenderer?e.hitDetectionRenderer:null,this.stroke_=void 0!==e.stroke?e.stroke:null,this.text_=void 0!==e.text?e.text:null,this.zIndex_=e.zIndex}return e=t,(n=[{key:"clone",value:function(){var e,n,r=this.getGeometry();return r&&"object"===fu(r)&&(r=r.clone()),new t({geometry:null!==(e=r)&&void 0!==e?e:void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:null!==(n=this.getRenderer())&&void 0!==n?n:void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}},{key:"getRenderer",value:function(){return this.renderer_}},{key:"setRenderer",value:function(t){this.renderer_=t}},{key:"setHitDetectionRenderer",value:function(t){this.hitDetectionRenderer_=t}},{key:"getHitDetectionRenderer",value:function(){return this.hitDetectionRenderer_}},{key:"getGeometry",value:function(){return this.geometry_}},{key:"getGeometryFunction",value:function(){return this.geometryFunction_}},{key:"getFill",value:function(){return this.fill_}},{key:"setFill",value:function(t){this.fill_=t}},{key:"getImage",value:function(){return this.image_}},{key:"setImage",value:function(t){this.image_=t}},{key:"getStroke",value:function(){return this.stroke_}},{key:"setStroke",value:function(t){this.stroke_=t}},{key:"getText",value:function(){return this.text_}},{key:"setText",value:function(t){this.text_=t}},{key:"getZIndex",value:function(){return this.zIndex_}},{key:"setGeometry",value:function(t){"function"==typeof t?this.geometryFunction_=t:"string"==typeof t?this.geometryFunction_=function(e){return e.get(t)}:t?void 0!==t&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=gu,this.geometry_=t}},{key:"setZIndex",value:function(t){this.zIndex_=t}}])&&hu(e.prototype,n),r&&hu(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n,r}();var du=null;function vu(t,e){if(!du){var n=new au({color:"rgba(255,255,255,0.4)"}),r=new cu({color:"#3399CC",width:1.25});du=[new pu({image:new nu({fill:n,stroke:r,radius:5}),fill:n,stroke:r})]}return du}function gu(t){return t.getGeometry()}var mu=pu;function bu(t){return(bu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _u(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,u=[],s=!0,l=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=o.call(n)).done)&&(u.push(r.value),u.length!==e);s=!0);}catch(t){l=!0,i=t}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return u}}(t,e)||function(t,e){if(t){if("string"==typeof t)return wu(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?wu(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function wu(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Su(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,xu(r.key),r)}}function xu(t){var e=function(t,e){if("object"!=bu(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=bu(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==bu(e)?e:e+""}function Ou(t,e,n){return e=ju(e),ku(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],ju(t).constructor):e.apply(t,n))}function ku(t,e){if(e&&("object"==bu(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Pu(){return(Pu="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=Eu(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}}).apply(null,arguments)}function Eu(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=ju(t)););return t}function ju(t){return(ju=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Cu(t,e){return(Cu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Tu(t,e,n,r){return void 0!==n&&void 0!==r?[n/t,r/e]:void 0!==n?n/t:void 0!==r?r/e:1}var Ru=function(t){function e(t){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=void 0!==(t=t||{}).opacity?t.opacity:1,i=void 0!==t.rotation?t.rotation:0,o=void 0!==t.scale?t.scale:1,a=void 0!==t.rotateWithView&&t.rotateWithView;(n=Ou(this,e,[{opacity:r,rotation:i,scale:o,displacement:void 0!==t.displacement?t.displacement:[0,0],rotateWithView:a,declutterMode:t.declutterMode}])).anchor_=void 0!==t.anchor?t.anchor:[.5,.5],n.normalizedAnchor_=null,n.anchorOrigin_=void 0!==t.anchorOrigin?t.anchorOrigin:"top-left",n.anchorXUnits_=void 0!==t.anchorXUnits?t.anchorXUnits:"fraction",n.anchorYUnits_=void 0!==t.anchorYUnits?t.anchorYUnits:"fraction",n.crossOrigin_=void 0!==t.crossOrigin?t.crossOrigin:null;var u,s=void 0!==t.img?t.img:null,l=t.src;if(En(!(void 0!==l&&s),"`image` and `src` cannot be provided at the same time"),void 0!==l&&0!==l.length||!s||(l=s.src||nt(s)),En(void 0!==l&&l.length>0,"A defined and non-empty `src` or `image` must be provided"),En(!((void 0!==t.width||void 0!==t.height)&&void 0!==t.scale),"`width` or `height` cannot be provided together with `scale`"),void 0!==t.src?u=yo:void 0!==s&&(u="complete"in s?s.complete?s.src?vo:yo:po:vo),n.color_=void 0!==t.color?Wo(t.color):null,n.iconImage_=Sa(s,l,n.crossOrigin_,u,n.color_),n.offset_=void 0!==t.offset?t.offset:[0,0],n.offsetOrigin_=void 0!==t.offsetOrigin?t.offsetOrigin:"top-left",n.origin_=null,n.size_=void 0!==t.size?t.size:null,n.initialOptions_,void 0!==t.width||void 0!==t.height){var c,f;if(t.size){var h=_u(t.size,2);c=h[0],f=h[1]}else{var y=n.getImage(1);if(y.width&&y.height)c=y.width,f=y.height;else if(y instanceof HTMLImageElement){n.initialOptions_=t;var p=function(){if(n.unlistenImageChange(p),n.initialOptions_){var e=n.iconImage_.getSize();n.setScale(Tu(e[0],e[1],t.width,t.height))}};return n.listenImageChange(p),ku(n)}}void 0!==c&&n.setScale(Tu(c,f,t.width,t.height))}return n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Cu(t,e)}(e,t),function(t,e,n){return e&&Su(t.prototype,e),n&&Su(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(e,[{key:"clone",value:function(){var t,n,r;return this.initialOptions_?(n=this.initialOptions_.width,r=this.initialOptions_.height):(t=this.getScale(),t=Array.isArray(t)?t.slice():t),new e({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:t,width:n,height:r,size:null!==this.size_?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}},{key:"getAnchor",value:function(){var t=this.normalizedAnchor_;if(!t){t=this.anchor_;var e=this.getSize();if("fraction"==this.anchorXUnits_||"fraction"==this.anchorYUnits_){if(!e)return null;t=this.anchor_.slice(),"fraction"==this.anchorXUnits_&&(t[0]*=e[0]),"fraction"==this.anchorYUnits_&&(t[1]*=e[1])}if("top-left"!=this.anchorOrigin_){if(!e)return null;t===this.anchor_&&(t=this.anchor_.slice()),"top-right"!=this.anchorOrigin_&&"bottom-right"!=this.anchorOrigin_||(t[0]=-t[0]+e[0]),"bottom-left"!=this.anchorOrigin_&&"bottom-right"!=this.anchorOrigin_||(t[1]=-t[1]+e[1])}this.normalizedAnchor_=t}var n=this.getDisplacement(),r=this.getScaleArray();return[t[0]-n[0]/r[0],t[1]+n[1]/r[1]]}},{key:"setAnchor",value:function(t){this.anchor_=t,this.normalizedAnchor_=null}},{key:"getColor",value:function(){return this.color_}},{key:"getImage",value:function(t){return this.iconImage_.getImage(t)}},{key:"getPixelRatio",value:function(t){return this.iconImage_.getPixelRatio(t)}},{key:"getImageSize",value:function(){return this.iconImage_.getSize()}},{key:"getImageState",value:function(){return this.iconImage_.getImageState()}},{key:"getHitDetectionImage",value:function(){return this.iconImage_.getHitDetectionImage()}},{key:"getOrigin",value:function(){if(this.origin_)return this.origin_;var t=this.offset_;if("top-left"!=this.offsetOrigin_){var e=this.getSize(),n=this.iconImage_.getSize();if(!e||!n)return null;t=t.slice(),"top-right"!=this.offsetOrigin_&&"bottom-right"!=this.offsetOrigin_||(t[0]=n[0]-e[0]-t[0]),"bottom-left"!=this.offsetOrigin_&&"bottom-right"!=this.offsetOrigin_||(t[1]=n[1]-e[1]-t[1])}return this.origin_=t,this.origin_}},{key:"getSrc",value:function(){return this.iconImage_.getSrc()}},{key:"getSize",value:function(){return this.size_?this.size_:this.iconImage_.getSize()}},{key:"getWidth",value:function(){var t=this.getScaleArray();return this.size_?this.size_[0]*t[0]:this.iconImage_.getImageState()==vo?this.iconImage_.getSize()[0]*t[0]:void 0}},{key:"getHeight",value:function(){var t=this.getScaleArray();return this.size_?this.size_[1]*t[1]:this.iconImage_.getImageState()==vo?this.iconImage_.getSize()[1]*t[1]:void 0}},{key:"setScale",value:function(t){var n,r,i,o,a;delete this.initialOptions_,(n=e,r="setScale",i=this,a=Pu(ju(1&(o=3)?n.prototype:n),r,i),2&o&&"function"==typeof a?function(t){return a.apply(i,t)}:a)([t])}},{key:"listenImageChange",value:function(t){this.iconImage_.addEventListener(M,t)}},{key:"load",value:function(){this.iconImage_.load()}},{key:"unlistenImageChange",value:function(t){this.iconImage_.removeEventListener(M,t)}},{key:"ready",value:function(){return this.iconImage_.ready()}}])}(xo);function Iu(t){return(Iu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Mu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Lu(r.key),r)}}function Lu(t){var e=function(t,e){if("object"!=Iu(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Iu(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Iu(e)?e:e+""}var Au,Fu=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=e||{},this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.scale_=e.scale,this.scaleArray_=bo(void 0!==e.scale?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.justify_=e.justify,this.repeat_=e.repeat,this.textBaseline_=e.textBaseline,this.fill_=void 0!==e.fill?e.fill:new au({color:"#333"}),this.maxAngle_=void 0!==e.maxAngle?e.maxAngle:Math.PI/4,this.placement_=void 0!==e.placement?e.placement:"point",this.overflow_=!!e.overflow,this.stroke_=void 0!==e.stroke?e.stroke:null,this.offsetX_=void 0!==e.offsetX?e.offsetX:0,this.offsetY_=void 0!==e.offsetY?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=void 0===e.padding?null:e.padding,this.declutterMode_=e.declutterMode}return e=t,(n=[{key:"clone",value:function(){var e=this.getScale();return new t({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}},{key:"getOverflow",value:function(){return this.overflow_}},{key:"getFont",value:function(){return this.font_}},{key:"getMaxAngle",value:function(){return this.maxAngle_}},{key:"getPlacement",value:function(){return this.placement_}},{key:"getRepeat",value:function(){return this.repeat_}},{key:"getOffsetX",value:function(){return this.offsetX_}},{key:"getOffsetY",value:function(){return this.offsetY_}},{key:"getFill",value:function(){return this.fill_}},{key:"getRotateWithView",value:function(){return this.rotateWithView_}},{key:"getRotation",value:function(){return this.rotation_}},{key:"getScale",value:function(){return this.scale_}},{key:"getScaleArray",value:function(){return this.scaleArray_}},{key:"getStroke",value:function(){return this.stroke_}},{key:"getText",value:function(){return this.text_}},{key:"getTextAlign",value:function(){return this.textAlign_}},{key:"getJustify",value:function(){return this.justify_}},{key:"getTextBaseline",value:function(){return this.textBaseline_}},{key:"getBackgroundFill",value:function(){return this.backgroundFill_}},{key:"getBackgroundStroke",value:function(){return this.backgroundStroke_}},{key:"getPadding",value:function(){return this.padding_}},{key:"getDeclutterMode",value:function(){return this.declutterMode_}},{key:"setOverflow",value:function(t){this.overflow_=t}},{key:"setFont",value:function(t){this.font_=t}},{key:"setMaxAngle",value:function(t){this.maxAngle_=t}},{key:"setOffsetX",value:function(t){this.offsetX_=t}},{key:"setOffsetY",value:function(t){this.offsetY_=t}},{key:"setPlacement",value:function(t){this.placement_=t}},{key:"setRepeat",value:function(t){this.repeat_=t}},{key:"setRotateWithView",value:function(t){this.rotateWithView_=t}},{key:"setFill",value:function(t){this.fill_=t}},{key:"setRotation",value:function(t){this.rotation_=t}},{key:"setScale",value:function(t){this.scale_=t,this.scaleArray_=bo(void 0!==t?t:1)}},{key:"setStroke",value:function(t){this.stroke_=t}},{key:"setText",value:function(t){this.text_=t}},{key:"setTextAlign",value:function(t){this.textAlign_=t}},{key:"setJustify",value:function(t){this.justify_=t}},{key:"setTextBaseline",value:function(t){this.textBaseline_=t}},{key:"setBackgroundFill",value:function(t){this.backgroundFill_=t}},{key:"setBackgroundStroke",value:function(t){this.backgroundStroke_=t}},{key:"setPadding",value:function(t){this.padding_=t}}])&&Mu(e.prototype,n),r&&Mu(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n,r}();function Du(t,e,n){if(zu())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,e);var i=new(t.bind.apply(t,r));return n&&Nu(i,n.prototype),i}function Nu(t,e){return(Nu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function zu(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(zu=function(){return!!t})()}function Bu(t){return function(t){if(Array.isArray(t))return Uu(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Zu(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Gu(t){return(Gu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Wu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,qu(r.key),r)}}function Xu(t,e,n){return e&&Wu(t.prototype,e),n&&Wu(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Yu(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ku(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=Zu(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}function Zu(t,e){if(t){if("string"==typeof t)return Uu(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Uu(t,e):void 0}}function Uu(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Vu(t,e,n){return(e=qu(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qu(t){var e=function(t,e){if("object"!=Gu(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Gu(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Gu(e)?e:e+""}var Hu=0,Ju=1<<Hu++,$u=1<<Hu++,Qu=1<<Hu++,ts=1<<Hu++,es=1<<Hu++,ns=1<<Hu++,rs=Math.pow(2,6)-1,is=Vu(Vu(Vu(Vu(Vu(Vu({},Ju,"boolean"),$u,"number"),Qu,"string"),ts,"color"),es,"number[]"),ns,"size"),os=Object.keys(is).map(Number).sort(p);function as(t){var e,n=[],r=Ku(os);try{for(r.s();!(e=r.n()).done;){var i=e.value;us(t,i)&&n.push(is[i])}}catch(t){r.e(t)}finally{r.f()}return 0===n.length?"untyped":n.length<3?n.join(" or "):n.slice(0,-1).join(", ")+", or "+n[n.length-1]}function us(t,e){return(t&e)===e}function ss(t,e){return t===e}var ls=Xu((function t(e,n){if(Yu(this,t),!function(t){return t in is}(e))throw new Error("literal expressions must have a specific type, got ".concat(as(e)));this.type=e,this.value=n})),cs=Xu((function t(e,n){Yu(this,t),this.type=e,this.operator=n;for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];this.args=i}));function fs(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1}}function hs(t,e,n){switch(Gu(t)){case"boolean":if(ss(e,Qu))return new ls(Qu,t?"true":"false");if(!us(e,Ju))throw new Error("got a boolean, but expected ".concat(as(e)));return new ls(Ju,t);case"number":if(ss(e,ns))return new ls(ns,bo(t));if(ss(e,Ju))return new ls(Ju,!!t);if(ss(e,Qu))return new ls(Qu,t.toString());if(!us(e,$u))throw new Error("got a number, but expected ".concat(as(e)));return new ls($u,t);case"string":if(ss(e,ts))return new ls(ts,Go(t));if(ss(e,Ju))return new ls(Ju,!!t);if(!us(e,Qu))throw new Error("got a string, but expected ".concat(as(e)));return new ls(Qu,t)}if(!Array.isArray(t))throw new Error("expression must be an array or a primitive value");if(0===t.length)throw new Error("empty expression");if("string"==typeof t[0])return function(t,e,n){var r=t[0],i=al[r];if(!i)throw new Error("unknown operator: ".concat(r));return i(t,e,n)}(t,e,n);var r,i=Ku(t);try{for(i.s();!(r=i.n()).done;){if("number"!=typeof r.value)throw new Error("expected an array of numbers")}}catch(t){i.e(t)}finally{i.f()}if(ss(e,ns)){if(2!==t.length)throw new Error("expected an array of two values for a size, got ".concat(t.length));return new ls(ns,t)}if(ss(e,ts)){if(3===t.length)return new ls(ts,[].concat(Bu(t),[1]));if(4===t.length)return new ls(ts,t);throw new Error("expected an array of 3 or 4 values for a color, got ".concat(t.length))}if(!us(e,es))throw new Error("got an array of numbers, but expected ".concat(as(e)));return new ls(es,t)}var ys="get",ps="var",ds="concat",vs="geometry-type",gs="line-metric",ms="any",bs="all",_s="!",ws="resolution",Ss="zoom",xs="time",Os="==",ks="!=",Ps=">",Es=">=",js="<",Cs="<=",Ts="*",Rs="/",Is="+",Ms="-",Ls="clamp",As="%",Fs="^",Ds="abs",Ns="floor",zs="ceil",Bs="round",Gs="sin",Ws="cos",Xs="atan",Ys="sqrt",Ks="match",Zs="between",Us="interpolate",Vs="coalesce",qs="case",Hs="in",Js="number",$s="string",Qs="array",tl="color",el="id",nl="band",rl="palette",il="to-string",ol="has",al=(Vu(Vu(Vu(Vu(Vu(Vu(Vu(Vu(Vu(Vu(Au={},ys,yl(ll(1,1/0),ul)),ps,yl(ll(1,1),(function(t,e,n){var r=t[1];if("string"!=typeof r)throw new Error("expected a string argument for var operation");return n.variables.add(r),[new ls(Qu,r)]}))),ol,yl(ll(1,1/0),ul)),el,yl((function(t,e,n){n.featureId=!0}),sl)),ds,yl(ll(2,1/0),fl(Qu))),vs,yl((function(t,e,n){n.geometryType=!0}),sl)),gs,yl(sl)),ws,yl(sl)),Ss,yl(sl)),xs,yl(sl)),Vu(Vu(Vu(Vu(Vu(Vu(Vu(Vu(Vu(Vu(Au,ms,yl(ll(2,1/0),fl(Ju))),bs,yl(ll(2,1/0),fl(Ju))),_s,yl(ll(1,1),fl(Ju))),Os,yl(ll(2,2),fl(rs))),ks,yl(ll(2,2),fl(rs))),Ps,yl(ll(2,2),fl($u))),Es,yl(ll(2,2),fl($u))),js,yl(ll(2,2),fl($u))),Cs,yl(ll(2,2),fl($u))),Ts,yl(ll(2,1/0),cl)),Vu(Vu(Vu(Vu(Vu(Vu(Vu(Vu(Vu(Vu(Au,Vs,yl(ll(2,1/0),cl)),Rs,yl(ll(2,2),fl($u))),Is,yl(ll(2,1/0),fl($u))),Ms,yl(ll(2,2),fl($u))),Ls,yl(ll(3,3),fl($u))),As,yl(ll(2,2),fl($u))),Fs,yl(ll(2,2),fl($u))),Ds,yl(ll(1,1),fl($u))),Ns,yl(ll(1,1),fl($u))),zs,yl(ll(1,1),fl($u))),Vu(Vu(Vu(Vu(Vu(Vu(Vu(Vu(Vu(Vu(Au,Bs,yl(ll(1,1),fl($u))),Gs,yl(ll(1,1),fl($u))),Ws,yl(ll(1,1),fl($u))),Xs,yl(ll(1,2),fl($u))),Ys,yl(ll(1,1),fl($u))),Ks,yl(ll(4,1/0),hl,(function(t,e,n){for(var r=t.length-1,i=Qu|$u|Ju,o=hs(t[1],i,n),a=hs(t[t.length-1],e,n),u=new Array(r-2),s=0;s<r-2;s+=2){try{var l=hs(t[s+2],o.type,n);u[s]=l}catch(t){throw new Error("failed to parse argument ".concat(s+1," of match expression: ").concat(t.message))}try{var c=hs(t[s+3],a.type,n);u[s+1]=c}catch(t){throw new Error("failed to parse argument ".concat(s+2," of match expression: ").concat(t.message))}}return[o].concat(u,[a])}))),Zs,yl(ll(3,3),fl($u))),Us,yl(ll(6,1/0),hl,(function(t,e,n){var r,i=t[1];switch(i[0]){case"linear":r=1;break;case"exponential":var o=i[1];if("number"!=typeof o||o<=0)throw new Error("expected a number base for exponential interpolation"+", got ".concat(JSON.stringify(o)," instead"));r=o;break;default:throw new Error("invalid interpolation type: ".concat(JSON.stringify(i)))}var a,u=new ls($u,r);try{a=hs(t[2],$u,n)}catch(t){throw new Error("failed to parse argument 1 in interpolate expression: ".concat(t.message))}for(var s=new Array(t.length-3),l=0;l<s.length;l+=2){try{var c=hs(t[l+3],$u,n);s[l]=c}catch(t){throw new Error("failed to parse argument ".concat(l+2," for interpolate expression: ").concat(t.message))}try{var f=hs(t[l+4],e,n);s[l+1]=f}catch(t){throw new Error("failed to parse argument ".concat(l+3," for interpolate expression: ").concat(t.message))}}return[u,a].concat(s)}))),qs,yl(ll(3,1/0),(function(t,e,n){var r=t[0],i=t.length-1;if(i%2==0)throw new Error("expected an odd number of arguments for ".concat(r,", got ").concat(i," instead"))}),(function(t,e,n){for(var r=hs(t[t.length-1],e,n),i=new Array(t.length-1),o=0;o<i.length-1;o+=2){try{var a=hs(t[o+1],Ju,n);i[o]=a}catch(t){throw new Error("failed to parse argument ".concat(o," of case expression: ").concat(t.message))}try{var u=hs(t[o+2],r.type,n);i[o+1]=u}catch(t){throw new Error("failed to parse argument ".concat(o+1," of case expression: ").concat(t.message))}}return i[i.length-1]=r,i}))),Hs,yl(ll(2,2),(function(t,e,n){var r,i=t[2];if(!Array.isArray(i))throw new Error('the second argument for the "in" operator must be an array');if("string"==typeof i[0]){if("literal"!==i[0])throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(i[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');i=i[1],r=Qu}else r=$u;for(var o=new Array(i.length),a=0;a<o.length;a++)try{var u=hs(i[a],r,n);o[a]=u}catch(t){throw new Error("failed to parse haystack item ".concat(a,' for "in" expression: ').concat(t.message))}return[hs(t[1],r,n)].concat(o)}))),Vu(Vu(Vu(Vu(Vu(Vu(Vu(Au,Js,yl(ll(1,1/0),fl(rs))),$s,yl(ll(1,1/0),fl(rs))),Qs,yl(ll(1,1/0),fl($u))),tl,yl(ll(1,4),fl($u))),nl,yl(ll(1,3),fl($u))),rl,yl(ll(2,2),(function(t,e,n){var r;try{r=hs(t[1],$u,n)}catch(t){throw new Error("failed to parse first argument in palette expression: ".concat(t.message))}var i=t[2];if(!Array.isArray(i))throw new Error("the second argument of palette must be an array");for(var o=new Array(i.length),a=0;a<o.length;a++){var u=void 0;try{u=hs(i[a],ts,n)}catch(t){throw new Error("failed to parse color at index ".concat(a," in palette expression: ").concat(t.message))}if(!(u instanceof ls))throw new Error("the palette color at index ".concat(a," must be a literal value"));o[a]=u}return[r].concat(o)}))),il,yl(ll(1,1),fl(Ju|$u|Qu|ts))));function ul(t,e,n){for(var r=t.length-1,i=new Array(r),o=0;o<r;++o){var a=t[o+1];switch(Gu(a)){case"number":i[o]=new ls($u,a);break;case"string":i[o]=new ls(Qu,a);break;default:throw new Error("expected a string key or numeric array index for a get operation, got ".concat(a))}0===o&&n.properties.add(String(a))}return i}function sl(t,e,n){var r=t[0];if(1!==t.length)throw new Error("expected no arguments for ".concat(r," operation"));return[]}function ll(t,e){return function(n,r,i){var o=n[0],a=n.length-1;if(t===e){if(a!==t){var u=1===t?"":"s";throw new Error("expected ".concat(t," argument").concat(u," for ").concat(o,", got ").concat(a))}}else if(a<t||a>e){var s=e===1/0?"".concat(t," or more"):"".concat(t," to ").concat(e);throw new Error("expected ".concat(s," arguments for ").concat(o,", got ").concat(a))}}}function cl(t,e,n){for(var r=t.length-1,i=new Array(r),o=0;o<r;++o){var a=hs(t[o+1],e,n);i[o]=a}return i}function fl(t){return function(e,n,r){for(var i=e.length-1,o=new Array(i),a=0;a<i;++a){var u=hs(e[a+1],t,r);o[a]=u}return o}}function hl(t,e,n){var r=t[0],i=t.length-1;if(i%2==1)throw new Error("expected an even number of arguments for operation ".concat(r,", got ").concat(i," instead"))}function yl(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(t,n,r){for(var i,o=t[0],a=0;a<e.length;a++){var u=e[a](t,n,r);if(a==e.length-1){if(!u)throw new Error("expected last argument validator to return the parsed args");i=u}}return Du(cs,[n,o].concat(Bu(i)))}}function pl(t){return(pl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function dl(t){return function(t){if(Array.isArray(t))return vl(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return vl(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?vl(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function vl(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function gl(t,e,n){return ml(hs(t,e,n),n)}function ml(t,e){if(t instanceof ls){if(t.type===ts&&"string"==typeof t.value){var n=Go(t.value);return function(){return n}}return function(){return t.value}}var r=t.operator;switch(r){case Js:case $s:case Vs:return function(t,e){for(var n=t.operator,r=t.args.length,i=new Array(r),o=0;o<r;++o)i[o]=ml(t.args[o],e);switch(n){case Vs:return function(t){for(var e=0;e<r;++e){var n=i[e](t);if(null!=n)return n}throw new Error("Expected one of the values to be non-null")};case Js:case $s:return function(t){for(var e=0;e<r;++e){var o=i[e](t);if(pl(o)===n)return o}throw new Error("Expected one of the values to be a ".concat(n))};default:throw new Error("Unsupported assertion operator ".concat(n))}}(t,e);case ys:case ps:case ol:return function(t,e){var n=t.args[0].value;switch(t.operator){case ys:return function(e){for(var r=t.args,i=e.properties[n],o=1,a=r.length;o<a;++o){i=i[r[o].value]}return i};case ps:return function(t){return t.variables[n]};case ol:return function(e){var r=t.args;if(!(n in e.properties))return!1;for(var i=e.properties[n],o=1,a=r.length;o<a;++o){var u=r[o].value;if(!i||!Object.hasOwn(i,u))return!1;i=i[u]}return!0};default:throw new Error("Unsupported accessor operator ".concat(t.operator))}}(t);case el:return function(t){return t.featureId};case vs:return function(t){return t.geometryType};case ds:var i=t.args.map((function(t){return ml(t,e)}));return function(t){var e;return(e="").concat.apply(e,dl(i.map((function(e){return e(t).toString()}))))};case ws:return function(t){return t.resolution};case ms:case bs:case Zs:case Hs:case _s:return function(t,e){for(var n=t.operator,r=t.args.length,i=new Array(r),o=0;o<r;++o)i[o]=ml(t.args[o],e);switch(n){case ms:return function(t){for(var e=0;e<r;++e)if(i[e](t))return!0;return!1};case bs:return function(t){for(var e=0;e<r;++e)if(!i[e](t))return!1;return!0};case Zs:return function(t){var e=i[0](t),n=i[1](t),r=i[2](t);return e>=n&&e<=r};case Hs:return function(t){for(var e=i[0](t),n=1;n<r;++n)if(e===i[n](t))return!0;return!1};case _s:return function(t){return!i[0](t)};default:throw new Error("Unsupported logical operator ".concat(n))}}(t,e);case Os:case ks:case js:case Cs:case Ps:case Es:return function(t,e){var n=t.operator,r=ml(t.args[0],e),i=ml(t.args[1],e);switch(n){case Os:return function(t){return r(t)===i(t)};case ks:return function(t){return r(t)!==i(t)};case js:return function(t){return r(t)<i(t)};case Cs:return function(t){return r(t)<=i(t)};case Ps:return function(t){return r(t)>i(t)};case Es:return function(t){return r(t)>=i(t)};default:throw new Error("Unsupported comparison operator ".concat(n))}}(t,e);case Ts:case Rs:case Is:case Ms:case Ls:case As:case Fs:case Ds:case Ns:case zs:case Bs:case Gs:case Ws:case Xs:case Ys:return function(t,e){for(var n=t.operator,r=t.args.length,i=new Array(r),o=0;o<r;++o)i[o]=ml(t.args[o],e);switch(n){case Ts:return function(t){for(var e=1,n=0;n<r;++n)e*=i[n](t);return e};case Rs:return function(t){return i[0](t)/i[1](t)};case Is:return function(t){for(var e=0,n=0;n<r;++n)e+=i[n](t);return e};case Ms:return function(t){return i[0](t)-i[1](t)};case Ls:return function(t){var e=i[0](t),n=i[1](t);if(e<n)return n;var r=i[2](t);return e>r?r:e};case As:return function(t){return i[0](t)%i[1](t)};case Fs:return function(t){return Math.pow(i[0](t),i[1](t))};case Ds:return function(t){return Math.abs(i[0](t))};case Ns:return function(t){return Math.floor(i[0](t))};case zs:return function(t){return Math.ceil(i[0](t))};case Bs:return function(t){return Math.round(i[0](t))};case Gs:return function(t){return Math.sin(i[0](t))};case Ws:return function(t){return Math.cos(i[0](t))};case Xs:return 2===r?function(t){return Math.atan2(i[0](t),i[1](t))}:function(t){return Math.atan(i[0](t))};case Ys:return function(t){return Math.sqrt(i[0](t))};default:throw new Error("Unsupported numeric operator ".concat(n))}}(t,e);case qs:return function(t,e){for(var n=t.args.length,r=new Array(n),i=0;i<n;++i)r[i]=ml(t.args[i],e);return function(t){for(var e=0;e<n-1;e+=2){if(r[e](t))return r[e+1](t)}return r[n-1](t)}}(t,e);case Ks:return function(t,e){for(var n=t.args.length,r=new Array(n),i=0;i<n;++i)r[i]=ml(t.args[i],e);return function(t){for(var e=r[0](t),i=1;i<n;i+=2)if(e===r[i](t))return r[i+1](t);return r[n-1](t)}}(t,e);case Us:return function(t,e){for(var n=t.args.length,r=new Array(n),i=0;i<n;++i)r[i]=ml(t.args[i],e);return function(t){for(var e,i,o=r[0](t),a=r[1](t),u=2;u<n;u+=2){var s=r[u](t),l=r[u+1](t),c=Array.isArray(l);if(c&&(l=zo(l)),s>=a)return 2===u?l:c?_l(o,a,e,i,s,l):bl(o,a,e,i,s,l);e=s,i=l}return i}}(t,e);case il:return function(t,e){for(var n=t.operator,r=t.args.length,i=new Array(r),o=0;o<r;++o)i[o]=ml(t.args[o],e);switch(n){case il:return function(e){var n=i[0](e);return t.args[0].type===ts?Yo(n):n.toString()};default:throw new Error("Unsupported convert operator ".concat(n))}}(t,e);default:throw new Error("Unsupported operator ".concat(r))}}function bl(t,e,n,r,i,o){var a=i-n;if(0===a)return r;var u=e-n;return r+(1===t?u/a:(Math.pow(t,u)-1)/(Math.pow(t,a)-1))*(o-r)}function _l(t,e,n,r,i,o){if(0===i-n)return r;var a=Bo(r),u=Bo(o),s=u[2]-a[2];s>180?s-=360:s<-180&&(s+=360);var l,c,f=[bl(t,e,n,a[0],i,u[0]),bl(t,e,n,a[1],i,u[1]),a[2]+bl(t,e,n,0,i,s),bl(t,e,n,r[3],i,o[3])];return Xo((l=f,(c=Po.rgb(Co.xyz(l)))[3]=l[3],c))}function wl(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Sl(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Sl(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}function Sl(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function xl(t){return!0}function Ol(t){var e=fs(),n=function(t,e){for(var n=t.length,r=new Array(n),i=0;i<n;++i){var o=t[i],a="filter"in o?gl(o.filter,Ju,e):xl,u=void 0;if(Array.isArray(o.style)){var s=o.style.length;u=new Array(s);for(var l=0;l<s;++l)u[l]=Pl(o.style[l],e)}else u=[Pl(o.style,e)];r[i]={filter:a,styles:u}}return function(e){for(var i=[],o=!1,a=0;a<n;++a){if((0,r[a].filter)(e)&&(!t[a].else||!o)){o=!0;var u,s=wl(r[a].styles);try{for(s.s();!(u=s.n()).done;){var l=(0,u.value)(e);l&&i.push(l)}}catch(t){s.e(t)}finally{s.f()}}}return i}}(t,e),r={variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""};return function(t,i){if(r.properties=t.getPropertiesInternal(),r.resolution=i,e.featureId){var o=t.getId();r.featureId=void 0!==o?o:null}return e.geometryType&&(r.geometryType=function t(e){if(!e)return"";var n=e.getType();switch(n){case"Point":case"LineString":case"Polygon":return n;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return n.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return t(e.getGeometries()[0]);default:return""}}(t.getGeometry())),n(r)}}function kl(t){for(var e=fs(),n=t.length,r=new Array(n),i=0;i<n;++i)r[i]=Pl(t[i],e);var o={variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""},a=new Array(n);return function(t,i){if(o.properties=t.getPropertiesInternal(),o.resolution=i,e.featureId){var u=t.getId();o.featureId=void 0!==u?u:null}for(var s=0,l=0;l<n;++l){var c=r[l](o);c&&(a[s]=c,s+=1)}return a.length=s,a}}function Pl(t,e){var n=El(t,"",e),r=jl(t,"",e),i=function(t,e){var n="text-",r=Tl(t,n+"value",e);if(!r)return null;var i=El(t,n,e),o=El(t,n+"background-",e),a=jl(t,n,e),u=jl(t,n+"background-",e),s=Tl(t,n+"font",e),l=Cl(t,n+"max-angle",e),c=Cl(t,n+"offset-x",e),f=Cl(t,n+"offset-y",e),h=Rl(t,n+"overflow",e),y=Tl(t,n+"placement",e),p=Cl(t,n+"repeat",e),d=Fl(t,n+"scale",e),v=Rl(t,n+"rotate-with-view",e),g=Cl(t,n+"rotation",e),m=Tl(t,n+"align",e),b=Tl(t,n+"justify",e),_=Tl(t,n+"baseline",e),w=Ml(t,n+"padding",e),S=Bl(t,n+"declutter-mode"),x=new Fu({declutterMode:S});return function(t){if(x.setText(r(t)),i&&x.setFill(i(t)),o&&x.setBackgroundFill(o(t)),a&&x.setStroke(a(t)),u&&x.setBackgroundStroke(u(t)),s&&x.setFont(s(t)),l&&x.setMaxAngle(l(t)),c&&x.setOffsetX(c(t)),f&&x.setOffsetY(f(t)),h&&x.setOverflow(h(t)),y){var e=y(t);if("point"!==e&&"line"!==e)throw new Error("Expected point or line for text-placement");x.setPlacement(e)}if(p&&x.setRepeat(p(t)),d&&x.setScale(d(t)),v&&x.setRotateWithView(v(t)),g&&x.setRotation(g(t)),m){var n=m(t);if("left"!==n&&"center"!==n&&"right"!==n&&"end"!==n&&"start"!==n)throw new Error("Expected left, right, center, start, or end for text-align");x.setTextAlign(n)}if(b){var S=b(t);if("left"!==S&&"right"!==S&&"center"!==S)throw new Error("Expected left, right, or center for text-justify");x.setJustify(S)}if(_){var O=_(t);if("bottom"!==O&&"top"!==O&&"middle"!==O&&"alphabetic"!==O&&"hanging"!==O)throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");x.setTextBaseline(O)}return w&&x.setPadding(w(t)),x}}(t,e),o=function(t,e){if("icon-src"in t)return function(t,e){var n="icon-",r=Wl(t["icon-src"],"icon-src"),i=Ll(t,n+"anchor",e),o=Fl(t,n+"scale",e),a=Cl(t,n+"opacity",e),u=Ll(t,n+"displacement",e),s=Cl(t,n+"rotation",e),l=Rl(t,n+"rotate-with-view",e),c=Nl(t,n+"anchor-origin"),f=zl(t,n+"anchor-x-units"),h=zl(t,n+"anchor-y-units"),y=function(t,e){var n=t[e];if(void 0===n)return;return Yl(n,e)}(t,n+"color"),p=function(t,e){var n=t[e];if(void 0===n)return;if("string"!=typeof n)throw new Error("Expected a string for ".concat(e));return n}(t,n+"cross-origin"),d=function(t,e){var n=t[e];if(void 0===n)return;return Gl(n,e)}(t,n+"offset"),v=Nl(t,n+"offset-origin"),g=Dl(t,n+"width"),m=Dl(t,n+"height"),b=function(t,e){var n=t[e];if(void 0===n)return;if("number"==typeof n)return bo(n);if(!Array.isArray(n))throw new Error("Expected a number or size array for ".concat(e));if(2!==n.length||"number"!=typeof n[0]||"number"!=typeof n[1])throw new Error("Expected a number or size array for ".concat(e));return n}(t,n+"size"),_=Bl(t,n+"declutter-mode"),w=new Ru({src:r,anchorOrigin:c,anchorXUnits:f,anchorYUnits:h,color:y,crossOrigin:p,offset:d,offsetOrigin:v,height:m,width:g,size:b,declutterMode:_});return function(t){return a&&w.setOpacity(a(t)),u&&w.setDisplacement(u(t)),s&&w.setRotation(s(t)),l&&w.setRotateWithView(l(t)),o&&w.setScale(o(t)),i&&w.setAnchor(i(t)),w}}(t,e);if("shape-points"in t)return function(t,e){var n="shape-",r=Xl(t["shape-points"],"shape-points"),i=Xl(t["shape-radius"],"shape-radius"),o=El(t,n,e),a=jl(t,n,e),u=Fl(t,n+"scale",e),s=Ll(t,n+"displacement",e),l=Cl(t,n+"rotation",e),c=Rl(t,n+"rotate-with-view",e),f=Dl(t,n+"radius2"),h=Dl(t,n+"angle"),y=Bl(t,n+"declutter-mode"),p=new qa({points:r,radius:i,radius2:f,angle:h,declutterMode:y});return function(t){return o&&p.setFill(o(t)),a&&p.setStroke(a(t)),s&&p.setDisplacement(s(t)),l&&p.setRotation(l(t)),c&&p.setRotateWithView(c(t)),u&&p.setScale(u(t)),p}}(t,e);if("circle-radius"in t)return function(t,e){var n="circle-",r=El(t,n,e),i=jl(t,n,e),o=Cl(t,n+"radius",e),a=Fl(t,n+"scale",e),u=Ll(t,n+"displacement",e),s=Cl(t,n+"rotation",e),l=Rl(t,n+"rotate-with-view",e),c=Bl(t,n+"declutter-mode"),f=new nu({radius:5,declutterMode:c});return function(t){return o&&f.setRadius(o(t)),r&&f.setFill(r(t)),i&&f.setStroke(i(t)),u&&f.setDisplacement(u(t)),s&&f.setRotation(s(t)),l&&f.setRotateWithView(l(t)),a&&f.setScale(a(t)),f}}(t,e);return null}(t,e),a=Cl(t,"z-index",e);if(!(n||r||i||o||k(t)))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(t));var u=new mu;return function(t){var e=!0;if(n){var s=n(t);s&&(e=!1),u.setFill(s)}if(r){var l=r(t);l&&(e=!1),u.setStroke(l)}if(i){var c=i(t);c&&(e=!1),u.setText(c)}if(o){var f=o(t);f&&(e=!1),u.setImage(f)}return a&&u.setZIndex(a(t)),e?null:u}}function El(t,e,n){var r;if(e+"fill-pattern-src"in t)r=function(t,e,n){var r=Tl(t,e+"pattern-src",n),i=Al(t,e+"pattern-offset",n),o=Al(t,e+"pattern-size",n),a=Il(t,e+"color",n);return function(t){return{src:r(t),offset:i&&i(t),size:o&&o(t),color:a&&a(t)}}}(t,e+"fill-",n);else{if("none"===t[e+"fill-color"])return function(t){return null};r=Il(t,e+"fill-color",n)}if(!r)return null;var i=new au;return function(t){var e=r(t);return e===Fo?null:(i.setColor(e),i)}}function jl(t,e,n){var r=Cl(t,e+"stroke-width",n),i=Il(t,e+"stroke-color",n);if(!r&&!i)return null;var o=Tl(t,e+"stroke-line-cap",n),a=Tl(t,e+"stroke-line-join",n),u=Ml(t,e+"stroke-line-dash",n),s=Cl(t,e+"stroke-line-dash-offset",n),l=Cl(t,e+"stroke-miter-limit",n),c=new cu;return function(t){if(i){var e=i(t);if(e===Fo)return null;c.setColor(e)}if(r&&c.setWidth(r(t)),o){var n=o(t);if("butt"!==n&&"round"!==n&&"square"!==n)throw new Error("Expected butt, round, or square line cap");c.setLineCap(n)}if(a){var f=a(t);if("bevel"!==f&&"round"!==f&&"miter"!==f)throw new Error("Expected bevel, round, or miter line join");c.setLineJoin(f)}return u&&c.setLineDash(u(t)),s&&c.setLineDashOffset(s(t)),l&&c.setMiterLimit(l(t)),c}}function Cl(t,e,n){if(e in t){var r=gl(t[e],$u,n);return function(t){return Xl(r(t),e)}}}function Tl(t,e,n){if(!(e in t))return null;var r=gl(t[e],Qu,n);return function(t){return Wl(r(t),e)}}function Rl(t,e,n){if(!(e in t))return null;var r=gl(t[e],Ju,n);return function(t){var n=r(t);if("boolean"!=typeof n)throw new Error("Expected a boolean for ".concat(e));return n}}function Il(t,e,n){if(!(e in t))return null;var r=gl(t[e],ts,n);return function(t){return Yl(r(t),e)}}function Ml(t,e,n){if(!(e in t))return null;var r=gl(t[e],es,n);return function(t){return Gl(r(t),e)}}function Ll(t,e,n){if(!(e in t))return null;var r=gl(t[e],es,n);return function(t){var n=Gl(r(t),e);if(2!==n.length)throw new Error("Expected two numbers for ".concat(e));return n}}function Al(t,e,n){if(!(e in t))return null;var r=gl(t[e],es,n);return function(t){return Kl(r(t),e)}}function Fl(t,e,n){if(!(e in t))return null;var r=gl(t[e],es|$u,n);return function(t){return function(t,e){if("number"==typeof t)return t;return Kl(t,e)}(r(t),e)}}function Dl(t,e){var n=t[e];if(void 0!==n){if("number"!=typeof n)throw new Error("Expected a number for ".concat(e));return n}}function Nl(t,e){var n=t[e];if(void 0!==n){if("bottom-left"!==n&&"bottom-right"!==n&&"top-left"!==n&&"top-right"!==n)throw new Error("Expected bottom-left, bottom-right, top-left, or top-right for ".concat(e));return n}}function zl(t,e){var n=t[e];if(void 0!==n){if("pixels"!==n&&"fraction"!==n)throw new Error("Expected pixels or fraction for ".concat(e));return n}}function Bl(t,e){var n=t[e];if(void 0!==n){if("string"!=typeof n)throw new Error("Expected a string for ".concat(e));if("declutter"!==n&&"obstacle"!==n&&"none"!==n)throw new Error("Expected declutter, obstacle, or none for ".concat(e));return n}}function Gl(t,e){if(!Array.isArray(t))throw new Error("Expected an array for ".concat(e));for(var n=t.length,r=0;r<n;++r)if("number"!=typeof t[r])throw new Error("Expected an array of numbers for ".concat(e));return t}function Wl(t,e){if("string"!=typeof t)throw new Error("Expected a string for ".concat(e));return t}function Xl(t,e){if("number"!=typeof t)throw new Error("Expected a number for ".concat(e));return t}function Yl(t,e){if("string"==typeof t)return t;var n=Gl(t,e),r=n.length;if(r<3||r>4)throw new Error("Expected a color with 3 or 4 values for ".concat(e));return n}function Kl(t,e){var n=Gl(t,e);if(2!==n.length)throw new Error("Expected an array of two numbers for ".concat(e));return n}function Zl(t){return(Zl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ul(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Vl(r.key),r)}}function Vl(t){var e=function(t,e){if("object"!=Zl(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Zl(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Zl(e)?e:e+""}function ql(t,e,n){return e=$l(e),function(t,e){if(e&&("object"==Zl(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],$l(t).constructor):e.apply(t,n))}function Hl(){return(Hl="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=Jl(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}}).apply(null,arguments)}function Jl(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=$l(t)););return t}function $l(t){return($l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ql(t,e){return(Ql=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var tc="renderOrder";var ec=function(t){function e(t){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t=t||{};var r=Object.assign({},t);return delete r.style,delete r.renderBuffer,delete r.updateWhileAnimating,delete r.updateWhileInteracting,(n=ql(this,e,[r])).declutter_=t.declutter?String(t.declutter):void 0,n.renderBuffer_=void 0!==t.renderBuffer?t.renderBuffer:100,n.style_=null,n.styleFunction_=void 0,n.setStyle(t.style),n.updateWhileAnimating_=void 0!==t.updateWhileAnimating&&t.updateWhileAnimating,n.updateWhileInteracting_=void 0!==t.updateWhileInteracting&&t.updateWhileInteracting,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ql(t,e)}(e,t),function(t,e,n){return e&&Ul(t.prototype,e),n&&Ul(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(e,[{key:"getDeclutter",value:function(){return this.declutter_}},{key:"getFeatures",value:function(t){return(n=e,r="getFeatures",i=this,a=Hl($l(1&(o=3)?n.prototype:n),r,i),2&o&&"function"==typeof a?function(t){return a.apply(i,t)}:a)([t]);var n,r,i,o,a}},{key:"getRenderBuffer",value:function(){return this.renderBuffer_}},{key:"getRenderOrder",value:function(){return this.get(tc)}},{key:"getStyle",value:function(){return this.style_}},{key:"getStyleFunction",value:function(){return this.styleFunction_}},{key:"getUpdateWhileAnimating",value:function(){return this.updateWhileAnimating_}},{key:"getUpdateWhileInteracting",value:function(){return this.updateWhileInteracting_}},{key:"renderDeclutter",value:function(t,e){var n=this.getDeclutter();n in t.declutter==!1&&(t.declutter[n]=new ho.a(9)),this.getRenderer().renderDeclutter(t,e)}},{key:"setRenderOrder",value:function(t){this.set(tc,t)}},{key:"setStyle",value:function(t){this.style_=void 0===t?vu:t;var e=function(t){if(void 0===t)return vu;if(!t)return null;if("function"==typeof t)return t;if(t instanceof mu)return t;if(!Array.isArray(t))return kl([t]);if(0===t.length)return[];var e=t.length,n=t[0];if(n instanceof mu){for(var r=new Array(e),i=0;i<e;++i){var o=t[i];if(!(o instanceof mu))throw new Error("Expected a list of style instances");r[i]=o}return r}if("style"in n){for(var a=new Array(e),u=0;u<e;++u){var s=t[u];if(!("style"in s))throw new Error("Expected a list of rules with a style property");a[u]=s}return Ol(a)}return kl(t)}(t);this.styleFunction_=null===t?void 0:function(t){var e;if("function"==typeof t)e=t;else{var n;if(Array.isArray(t))n=t;else En("function"==typeof t.getZIndex,"Expected an `Style` or an array of `Style`"),n=[t];e=function(){return n}}return e}(e),this.changed()}}])}(co);function nc(t){return(nc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function rc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ic(r.key),r)}}function ic(t){var e=function(t,e){if("object"!=nc(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=nc(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==nc(e)?e:e+""}function oc(t,e,n){return e=ac(e),function(t,e){if(e&&("object"==nc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],ac(t).constructor):e.apply(t,n))}function ac(t){return(ac=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function uc(t,e){return(uc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function sc(t,e){ya.expire()}var lc=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=oc(this,e)).map_=t,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&uc(t,e)}(e,t),n=e,(r=[{key:"dispatchRenderEvent",value:function(t,e){tt()}},{key:"calculateMatrices2D",value:function(t){var e=t.viewState,n=t.coordinateToPixelTransform,r=t.pixelToCoordinateTransform;Bn(n,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]),Gn(r,n)}},{key:"forEachFeatureAtCoordinate",value:function(t,e,n,r,i,o,a,u){var s,l=e.viewState;function c(t,e,n,r){return i.call(o,e,t?n:null,r)}var f=l.projection,h=Ve(t.slice(),f),y=[[0,0]];if(f.canWrapX()&&r){var p=Re(f.getExtent());y.push([-p,0],[p,0])}for(var d=e.layerStatesArray,v=d.length,g=[],m=[],b=0;b<y.length;b++)for(var _=v-1;_>=0;--_){var w=d[_],S=w.layer;if(S.hasRenderer()&&lo(w,l)&&a.call(u,S)){var x=S.getRenderer(),O=S.getSource();if(x&&O){var k=O.getWrapX()?h:t,P=c.bind(null,w.managed);m[0]=k[0]+y[b][0],m[1]=k[1]+y[b][1],s=x.forEachFeatureAtCoordinate(m,e,n,P,g)}if(s)return s}}if(0!==g.length){var E=1/g.length;return g.forEach((function(t,e){return t.distanceSq+=e*E})),g.sort((function(t,e){return t.distanceSq-e.distanceSq})),g.some((function(t){return s=t.callback(t.feature,t.layer,t.geometry)})),s}}},{key:"hasFeatureAtCoordinate",value:function(t,e,n,r,i,o){return void 0!==this.forEachFeatureAtCoordinate(t,e,n,r,b,this,i,o)}},{key:"getMap",value:function(){return this.map_}},{key:"renderFrame",value:function(t){tt()}},{key:"scheduleExpireIconCache",value:function(t){ya.canExpireCache()&&t.postRenderFunctions.push(sc)}}])&&rc(n.prototype,r),i&&rc(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(y);function cc(t){return(cc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function fc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,hc(r.key),r)}}function hc(t){var e=function(t,e){if("object"!=cc(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=cc(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==cc(e)?e:e+""}function yc(t,e,n){return e=pc(e),function(t,e){if(e&&("object"==cc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],pc(t).constructor):e.apply(t,n))}function pc(t){return(pc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function dc(t,e){return(dc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var vc=function(t){function e(t,n,r,i){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=yc(this,e,[t])).inversePixelTransform=n,o.frameState=r,o.context=i,o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&dc(t,e)}(e,t),n=e,r&&fc(n.prototype,r),i&&fc(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(s);function gc(t){return(gc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function mc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,bc(r.key),r)}}function bc(t){var e=function(t,e){if("object"!=gc(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=gc(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==gc(e)?e:e+""}function _c(t,e,n){return e=xc(e),function(t,e){if(e&&("object"==gc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],xc(t).constructor):e.apply(t,n))}function wc(){return(wc="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=Sc(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}}).apply(null,arguments)}function Sc(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=xc(t)););return t}function xc(t){return(xc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Oc(t,e){return(Oc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var kc=function(t){function e(t){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=_c(this,e,[t])).fontChangeListenerKey_=X(La,l,t.redrawText.bind(t)),n.element_=document.createElement("div");var r=n.element_.style;r.position="absolute",r.width="100%",r.height="100%",r.zIndex="0",n.element_.className="ol-unselectable ol-layers";var i=t.getViewport();return i.insertBefore(n.element_,i.firstChild||null),n.children_=[],n.renderedVisible_=!0,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Oc(t,e)}(e,t),function(t,e,n){return e&&mc(t.prototype,e),n&&mc(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(e,[{key:"dispatchRenderEvent",value:function(t,e){var n=this.getMap();if(n.hasListener(t)){var r=new vc(t,void 0,e);n.dispatchEvent(r)}}},{key:"disposeInternal",value:function(){var t,n,r,i,o;K(this.fontChangeListenerKey_),this.element_.remove(),(t=e,n="disposeInternal",r=this,o=wc(xc(1&(i=3)?t.prototype:t),n,r),2&i&&"function"==typeof o?function(t){return o.apply(r,t)}:o)([])}},{key:"renderFrame",value:function(t){if(t){this.calculateMatrices2D(t),this.dispatchRenderEvent($i,t);var e=t.layerStatesArray.sort((function(t,e){return t.zIndex-e.zIndex}));e.some((function(t){return t.layer instanceof ec&&t.layer.getDeclutter()}))&&(t.declutter={});var n=t.viewState;this.children_.length=0;for(var r=[],i=null,o=0,a=e.length;o<a;++o){var u=e[o];t.layerIndex=o;var s=u.layer,l=s.getSourceState();if(!lo(u,n)||"ready"!=l&&"undefined"!=l)s.unrender();else{var c=s.render(t,i);c&&(c!==i&&(this.children_.push(c),i=c),r.push(u))}}this.declutter(t,r),function(t,e){for(var n=t.childNodes,r=0;;++r){var i=n[r],o=e[r];if(!i&&!o)break;i!==o&&(i?o?t.insertBefore(o,i):(t.removeChild(i),--r):t.appendChild(o))}}(this.element_,this.children_),this.dispatchRenderEvent(Qi,t),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(t)}else this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1)}},{key:"declutter",value:function(t,e){if(t.declutter){for(var n=e.length-1;n>=0;--n){var r=e[n],i=r.layer;i.getDeclutter()&&i.renderDeclutter(t,r)}e.forEach((function(e){return e.layer.renderDeferred(t)}))}}}])}(lc);function Pc(t){return(Pc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ec(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Cc(r.key),r)}}function jc(t,e,n){return e&&Ec(t.prototype,e),n&&Ec(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Cc(t){var e=function(t,e){if("object"!=Pc(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Pc(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Pc(e)?e:e+""}function Tc(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Rc(t,e,n){return e=Ic(e),function(t,e){if(e&&("object"==Pc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],Ic(t).constructor):e.apply(t,n))}function Ic(t){return(Ic=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Mc(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Lc(t,e)}function Lc(t,e){return(Lc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Ac=function(t){function e(t,n){var r;return Tc(this,e),(r=Rc(this,e,[t])).layer=n,r}return Mc(e,t),jc(e)}(s),Fc="layers",Dc=function(t){function e(t){var n;Tc(this,e),t=t||{};var r=Object.assign({},t);delete r.layers;var i=t.layers;return(n=Rc(this,e,[r])).on,n.once,n.un,n.layersListenerKeys_=[],n.listenerKeys_={},n.addChangeListener(Fc,n.handleLayersChanged_),i?Array.isArray(i)?i=new Ti(i.slice(),{unique:!0}):En("function"==typeof i.getArray,"Expected `layers` to be an array or a `Collection`"):i=new Ti(void 0,{unique:!0}),n.setLayers(i),n}return Mc(e,t),jc(e,[{key:"handleLayerChange_",value:function(){this.changed()}},{key:"handleLayersChanged_",value:function(){this.layersListenerKeys_.forEach(K),this.layersListenerKeys_.length=0;var t=this.getLayers();for(var e in this.layersListenerKeys_.push(X(t,gi,this.handleLayersAdd_,this),X(t,mi,this.handleLayersRemove_,this)),this.listenerKeys_)this.listenerKeys_[e].forEach(K);O(this.listenerKeys_);for(var n=t.getArray(),r=0,i=n.length;r<i;r++){var o=n[r];this.registerLayerListeners_(o),this.dispatchEvent(new Ac("addlayer",o))}this.changed()}},{key:"registerLayerListeners_",value:function(t){var n=[X(t,l,this.handleLayerChange_,this),X(t,M,this.handleLayerChange_,this)];t instanceof e&&n.push(X(t,"addlayer",this.handleLayerGroupAdd_,this),X(t,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[nt(t)]=n}},{key:"handleLayerGroupAdd_",value:function(t){this.dispatchEvent(new Ac("addlayer",t.layer))}},{key:"handleLayerGroupRemove_",value:function(t){this.dispatchEvent(new Ac("removelayer",t.layer))}},{key:"handleLayersAdd_",value:function(t){var e=t.element;this.registerLayerListeners_(e),this.dispatchEvent(new Ac("addlayer",e)),this.changed()}},{key:"handleLayersRemove_",value:function(t){var e=t.element,n=nt(e);this.listenerKeys_[n].forEach(K),delete this.listenerKeys_[n],this.dispatchEvent(new Ac("removelayer",e)),this.changed()}},{key:"getLayers",value:function(){return this.get(Fc)}},{key:"setLayers",value:function(t){var e=this.getLayers();if(e)for(var n=e.getArray(),r=0,i=n.length;r<i;++r)this.dispatchEvent(new Ac("removelayer",n[r]));this.set(Fc,t)}},{key:"getLayersArray",value:function(t){return t=void 0!==t?t:[],this.getLayers().forEach((function(e){e.getLayersArray(t)})),t}},{key:"getLayerStatesArray",value:function(t){var e=void 0!==t?t:[],n=e.length;this.getLayers().forEach((function(t){t.getLayerStatesArray(e)}));var r=this.getLayerState(),i=r.zIndex;t||void 0!==r.zIndex||(i=0);for(var o=n,a=e.length;o<a;o++){var u=e[o];u.opacity*=r.opacity,u.visible=u.visible&&r.visible,u.maxResolution=Math.min(u.maxResolution,r.maxResolution),u.minResolution=Math.max(u.minResolution,r.minResolution),u.minZoom=Math.max(u.minZoom,r.minZoom),u.maxZoom=Math.min(u.maxZoom,r.maxZoom),void 0!==r.extent&&(void 0!==u.extent?u.extent=je(u.extent,r.extent):u.extent=r.extent),void 0===u.zIndex&&(u.zIndex=i)}return e}},{key:"getSourceState",value:function(){return"ready"}}])}(qi);function Nc(t){return(Nc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function zc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Bc(r.key),r)}}function Bc(t){var e=function(t,e){if("object"!=Nc(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Nc(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Nc(e)?e:e+""}function Gc(t,e,n){return e=Wc(e),function(t,e){if(e&&("object"==Nc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],Wc(t).constructor):e.apply(t,n))}function Wc(t){return(Wc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Xc(t,e){return(Xc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Yc=function(t){function e(t,n,r){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=Gc(this,e,[t])).map=n,i.frameState=void 0!==r?r:null,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Xc(t,e)}(e,t),n=e,r&&zc(n.prototype,r),i&&zc(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(s);function Kc(t){return(Kc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Uc(r.key),r)}}function Uc(t){var e=function(t,e){if("object"!=Kc(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Kc(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Kc(e)?e:e+""}function Vc(t,e,n){return e=$c(e),function(t,e){if(e&&("object"==Kc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],$c(t).constructor):e.apply(t,n))}function qc(t,e,n,r){var i=Hc($c(1&r?t.prototype:t),e,n);return 2&r&&"function"==typeof i?function(t){return i.apply(n,t)}:i}function Hc(){return(Hc="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=Jc(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}}).apply(null,arguments)}function Jc(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=$c(t)););return t}function $c(t){return($c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Qc(t,e){return(Qc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var tf=function(t){function e(t,n,r,i,o,a){var u;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(u=Vc(this,e,[t,n,o])).originalEvent=r,u.pixel_=null,u.coordinate_=null,u.dragging=void 0!==i&&i,u.activePointers=a,u}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Qc(t,e)}(e,t),n=e,(r=[{key:"pixel",get:function(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_},set:function(t){this.pixel_=t}},{key:"coordinate",get:function(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_},set:function(t){this.coordinate_=t}},{key:"preventDefault",value:function(){qc(e,"preventDefault",this,3)([]),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}},{key:"stopPropagation",value:function(){qc(e,"stopPropagation",this,3)([]),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}])&&Zc(n.prototype,r),i&&Zc(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(Yc),ef={SINGLECLICK:"singleclick",CLICK:F,DBLCLICK:D,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},nf="pointermove",rf="pointerdown";function of(t){return(of="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function af(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,uf(r.key),r)}}function uf(t){var e=function(t,e){if("object"!=of(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=of(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==of(e)?e:e+""}function sf(t,e,n){return e=ff(e),function(t,e){if(e&&("object"==of(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],ff(t).constructor):e.apply(t,n))}function lf(){return(lf="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=cf(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}}).apply(null,arguments)}function cf(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=ff(t)););return t}function ff(t){return(ff=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function hf(t,e){return(hf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var yf=function(t){function e(t,n){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=sf(this,e,[t])).map_=t,r.clickTimeoutId_,r.emulateClicks_=!1,r.dragging_=!1,r.dragListenerKeys_=[],r.moveTolerance_=void 0===n?1:n,r.down_=null;var i=r.map_.getViewport();return r.activePointers_=[],r.trackedTouches_={},r.element_=i,r.pointerdownListenerKey_=X(i,rf,r.handlePointerDown_,r),r.originalPointerMoveEvent_,r.relayedListenerKey_=X(i,nf,r.relayMoveEvent_,r),r.boundHandleTouchMove_=r.handleTouchMove_.bind(r),r.element_.addEventListener(G,r.boundHandleTouchMove_,!!Qo&&{passive:!1}),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&hf(t,e)}(e,t),function(t,e,n){return e&&af(t.prototype,e),n&&af(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(e,[{key:"emulateClick_",value:function(t){var e=this,n=new tf(ef.CLICK,this.map_,t);this.dispatchEvent(n),void 0!==this.clickTimeoutId_?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,n=new tf(ef.DBLCLICK,this.map_,t),this.dispatchEvent(n)):this.clickTimeoutId_=setTimeout((function(){e.clickTimeoutId_=void 0;var n=new tf(ef.SINGLECLICK,e.map_,t);e.dispatchEvent(n)}),250)}},{key:"updateActivePointers_",value:function(t){var e=t,n=e.pointerId;if(e.type==ef.POINTERUP||e.type==ef.POINTERCANCEL){for(var r in delete this.trackedTouches_[n],this.trackedTouches_)if(this.trackedTouches_[r].target!==e.target){delete this.trackedTouches_[r];break}}else e.type!=ef.POINTERDOWN&&e.type!=ef.POINTERMOVE||(this.trackedTouches_[n]=e);this.activePointers_=Object.values(this.trackedTouches_)}},{key:"handlePointerUp_",value:function(t){this.updateActivePointers_(t);var e=new tf(ef.POINTERUP,this.map_,t,void 0,void 0,this.activePointers_);this.dispatchEvent(e),this.emulateClicks_&&!e.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(t)&&this.emulateClick_(this.down_),0===this.activePointers_.length&&(this.dragListenerKeys_.forEach(K),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}},{key:"isMouseActionButton_",value:function(t){return 0===t.button}},{key:"handlePointerDown_",value:function(t){this.emulateClicks_=0===this.activePointers_.length,this.updateActivePointers_(t);var e=new tf(ef.POINTERDOWN,this.map_,t,void 0,void 0,this.activePointers_);if(this.dispatchEvent(e),this.down_=new PointerEvent(t.type,t),Object.defineProperty(this.down_,"target",{writable:!1,value:t.target}),0===this.dragListenerKeys_.length){var n=this.map_.getOwnerDocument();this.dragListenerKeys_.push(X(n,ef.POINTERMOVE,this.handlePointerMove_,this),X(n,ef.POINTERUP,this.handlePointerUp_,this),X(this.element_,ef.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==n&&this.dragListenerKeys_.push(X(this.element_.getRootNode(),ef.POINTERUP,this.handlePointerUp_,this))}}},{key:"handlePointerMove_",value:function(t){if(this.isMoving_(t)){this.updateActivePointers_(t),this.dragging_=!0;var e=new tf(ef.POINTERDRAG,this.map_,t,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(e)}}},{key:"relayMoveEvent_",value:function(t){this.originalPointerMoveEvent_=t;var e=!(!this.down_||!this.isMoving_(t));this.dispatchEvent(new tf(ef.POINTERMOVE,this.map_,t,e))}},{key:"handleTouchMove_",value:function(t){var e=this.originalPointerMoveEvent_;e&&!e.defaultPrevented||"boolean"==typeof t.cancelable&&!0!==t.cancelable||t.preventDefault()}},{key:"isMoving_",value:function(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_}},{key:"disposeInternal",value:function(){var t,n,r,i,o;this.relayedListenerKey_&&(K(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(G,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(K(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(K),this.dragListenerKeys_.length=0,this.element_=null,(t=e,n="disposeInternal",r=this,o=lf(ff(1&(i=3)?t.prototype:t),n,r),2&i&&"function"==typeof o?function(t){return o.apply(r,t)}:o)([])}}])}(I),pf="postrender",df="movestart",vf="moveend",gf="loadstart",mf="loadend",bf="layergroup",_f="size",wf="target",Sf="view";function xf(t){return(xf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Of(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,kf(r.key),r)}}function kf(t){var e=function(t,e){if("object"!=xf(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=xf(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==xf(e)?e:e+""}var Pf=0,Ef=1,jf=2,Cf=3,Tf=4;function Rf(t){return(Rf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function If(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Mf(r.key),r)}}function Mf(t){var e=function(t,e){if("object"!=Rf(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Rf(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Rf(e)?e:e+""}function Lf(t,e,n){return e=Df(e),function(t,e){if(e&&("object"==Rf(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],Df(t).constructor):e.apply(t,n))}function Af(){return(Af="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=Ff(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}}).apply(null,arguments)}function Ff(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=Df(t)););return t}function Df(t){return(Df=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Nf(t,e){return(Nf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var zf=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Lf(this,e,[function(e){return t.apply(null,e)},function(t){return t[0].getKey()}])).boundHandleTileChange_=r.handleTileChange.bind(r),r.tileChangeCallback_=n,r.tilesLoading_=0,r.tilesLoadingKeys_={},r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Nf(t,e)}(e,t),function(t,e,n){return e&&If(t.prototype,e),n&&If(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(e,[{key:"enqueue",value:function(t){var n,r,i,o,a,u=(n=e,r="enqueue",i=this,a=Af(Df(1&(o=3)?n.prototype:n),r,i),2&o&&"function"==typeof a?function(t){return a.apply(i,t)}:a)([t]);u&&t[0].addEventListener(M,this.boundHandleTileChange_);return u}},{key:"getTilesLoading",value:function(){return this.tilesLoading_}},{key:"handleTileChange",value:function(t){var e=t.target,n=e.getState();if(n===jf||n===Cf||n===Tf){n!==Cf&&e.removeEventListener(M,this.boundHandleTileChange_);var r=e.getKey();r in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[r],--this.tilesLoading_),this.tileChangeCallback_()}}},{key:"loadMoreTiles",value:function(t,e){for(var n=0;this.tilesLoading_<t&&n<e&&this.getCount()>0;){var r=this.dequeue()[0],i=r.getKey();r.getState()!==Pf||i in this.tilesLoadingKeys_||(this.tilesLoadingKeys_[i]=!0,++this.tilesLoading_,++n,r.load())}}}])}(function(){return t=function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.priorityFunction_=e,this.keyFunction_=n,this.elements_=[],this.priorities_=[],this.queuedElements_={}},(e=[{key:"clear",value:function(){this.elements_.length=0,this.priorities_.length=0,O(this.queuedElements_)}},{key:"dequeue",value:function(){var t=this.elements_,e=this.priorities_,n=t[0];1==t.length?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));var r=this.keyFunction_(n);return delete this.queuedElements_[r],n}},{key:"enqueue",value:function(t){En(!(this.keyFunction_(t)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");var e=this.priorityFunction_(t);return e!=1/0&&(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0)}},{key:"getCount",value:function(){return this.elements_.length}},{key:"getLeftChildIndex_",value:function(t){return 2*t+1}},{key:"getRightChildIndex_",value:function(t){return 2*t+2}},{key:"getParentIndex_",value:function(t){return t-1>>1}},{key:"heapify_",value:function(){var t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)}},{key:"isEmpty",value:function(){return 0===this.elements_.length}},{key:"isKeyQueued",value:function(t){return t in this.queuedElements_}},{key:"isQueued",value:function(t){return this.isKeyQueued(this.keyFunction_(t))}},{key:"siftUp_",value:function(t){for(var e=this.elements_,n=this.priorities_,r=e.length,i=e[t],o=n[t],a=t;t<r>>1;){var u=this.getLeftChildIndex_(t),s=this.getRightChildIndex_(t),l=s<r&&n[s]<n[u]?s:u;e[t]=e[l],n[t]=n[l],t=l}e[t]=i,n[t]=o,this.siftDown_(a,t)}},{key:"siftDown_",value:function(t,e){for(var n=this.elements_,r=this.priorities_,i=n[e],o=r[e];e>t;){var a=this.getParentIndex_(e);if(!(r[a]>o))break;n[e]=n[a],r[e]=r[a],e=a}n[e]=i,r[e]=o}},{key:"reprioritize",value:function(){var t,e,n,r=this.priorityFunction_,i=this.elements_,o=this.priorities_,a=0,u=i.length;for(e=0;e<u;++e)(n=r(t=i[e]))==1/0?delete this.queuedElements_[this.keyFunction_(t)]:(o[a]=n,i[a++]=t);i.length=a,o.length=a,this.heapify_()}}])&&Of(t.prototype,e),n&&Of(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}());function Bf(t){return(Bf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Gf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Wf(r.key),r)}}function Wf(t){var e=function(t,e){if("object"!=Bf(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Bf(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Bf(e)?e:e+""}function Xf(t,e,n){return e=Zf(e),function(t,e){if(e&&("object"==Bf(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],Zf(t).constructor):e.apply(t,n))}function Yf(){return(Yf="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=Kf(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}}).apply(null,arguments)}function Kf(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=Zf(t)););return t}function Zf(t){return(Zf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Uf(t,e){return(Uf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Vf=function(t){function e(t){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=Xf(this,e);var r=t.element;return!r||t.target||r.style.pointerEvents||(r.style.pointerEvents="auto"),n.element=r||null,n.target_=null,n.map_=null,n.listenerKeys=[],t.render&&(n.render=t.render),t.target&&n.setTarget(t.target),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Uf(t,e)}(e,t),function(t,e,n){return e&&Gf(t.prototype,e),n&&Gf(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(e,[{key:"disposeInternal",value:function(){var t,n,r,i,o,a;null===(t=this.element)||void 0===t||t.remove(),(n=e,r="disposeInternal",i=this,a=Yf(Zf(1&(o=3)?n.prototype:n),r,i),2&o&&"function"==typeof a?function(t){return a.apply(i,t)}:a)([])}},{key:"getMap",value:function(){return this.map_}},{key:"setMap",value:function(t){var e,n;this.map_&&(null===(e=this.element)||void 0===e||e.remove());for(var r=0,i=this.listenerKeys.length;r<i;++r)K(this.listenerKeys[r]);(this.listenerKeys.length=0,this.map_=t,t)&&((null!==(n=this.target_)&&void 0!==n?n:t.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==w&&this.listenerKeys.push(X(t,pf,this.render,this)),t.render())}},{key:"render",value:function(t){}},{key:"setTarget",value:function(t){this.target_="string"==typeof t?document.getElementById(t):t}}])}(yt);function qf(t){return(qf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Hf(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */Hf=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",u=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function l(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,n){return t[e]=n}}function c(t,e,n,r){var o=e&&e.prototype instanceof v?e:v,a=Object.create(o.prototype),u=new C(r||[]);return i(a,"_invoke",{value:k(t,n,u)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var h="suspendedStart",y="executing",p="completed",d={};function v(){}function g(){}function m(){}var b={};l(b,a,(function(){return this}));var _=Object.getPrototypeOf,w=_&&_(_(T([])));w&&w!==n&&r.call(w,a)&&(b=w);var S=m.prototype=v.prototype=Object.create(b);function x(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function O(t,e){function n(i,o,a,u){var s=f(t[i],t,o);if("throw"!==s.type){var l=s.arg,c=l.value;return c&&"object"==qf(c)&&r.call(c,"__await")?e.resolve(c.__await).then((function(t){n("next",t,a,u)}),(function(t){n("throw",t,a,u)})):e.resolve(c).then((function(t){l.value=t,a(l)}),(function(t){return n("throw",t,a,u)}))}u(s.arg)}var o;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return o=o?o.then(i,i):i()}})}function k(e,n,r){var i=h;return function(o,a){if(i===y)throw Error("Generator is already running");if(i===p){if("throw"===o)throw a;return{value:t,done:!0}}for(r.method=o,r.arg=a;;){var u=r.delegate;if(u){var s=P(u,r);if(s){if(s===d)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===h)throw i=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=y;var l=f(e,n,r);if("normal"===l.type){if(i=r.done?p:"suspendedYield",l.arg===d)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(i=p,r.method="throw",r.arg=l.arg)}}}function P(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,P(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var o=f(i,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,d;var a=o.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,d):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function T(e){if(e||""===e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(qf(e)+" is not iterable")}return g.prototype=m,i(S,"constructor",{value:m,configurable:!0}),i(m,"constructor",{value:g,configurable:!0}),g.displayName=l(m,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,l(t,s,"GeneratorFunction")),t.prototype=Object.create(S),t},e.awrap=function(t){return{__await:t}},x(O.prototype),l(O.prototype,u,(function(){return this})),e.AsyncIterator=O,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new O(c(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},x(S),l(S,s,"Generator"),l(S,a,(function(){return this})),l(S,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(j),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return u.type="throw",u.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],u=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),l=r.call(a,"finallyLoc");if(s&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),j(n),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;j(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:T(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),d}},e}function Jf(t,e,n,r,i,o,a){try{var u=t[o](a),s=u.value}catch(t){return void n(t)}u.done?e(s):Promise.resolve(s).then(r,i)}function $f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Qf(r.key),r)}}function Qf(t){var e=function(t,e){if("object"!=qf(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=qf(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==qf(e)?e:e+""}function th(t,e,n){return e=eh(e),function(t,e){if(e&&("object"==qf(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],eh(t).constructor):e.apply(t,n))}function eh(t){return(eh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function nh(t,e){return(nh=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var rh=function(t){function e(t){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t=t||{},(n=th(this,e,[{element:document.createElement("div"),render:t.render,target:t.target}])).ulElement_=document.createElement("ul"),n.collapsed_=void 0===t.collapsed||t.collapsed,n.userCollapsed_=n.collapsed_,n.overrideCollapsible_=void 0!==t.collapsible,n.collapsible_=void 0===t.collapsible||t.collapsible,n.collapsible_||(n.collapsed_=!1),n.attributions_=t.attributions;var r=void 0!==t.className?t.className:"ol-attribution",i=void 0!==t.tipLabel?t.tipLabel:"Attributions",o=void 0!==t.expandClassName?t.expandClassName:r+"-expand",a=void 0!==t.collapseLabel?t.collapseLabel:"",u=void 0!==t.collapseClassName?t.collapseClassName:r+"-collapse";"string"==typeof a?(n.collapseLabel_=document.createElement("span"),n.collapseLabel_.textContent=a,n.collapseLabel_.className=u):n.collapseLabel_=a;var s=void 0!==t.label?t.label:"i";"string"==typeof s?(n.label_=document.createElement("span"),n.label_.textContent=s,n.label_.className=o):n.label_=s;var l=n.collapsible_&&!n.collapsed_?n.collapseLabel_:n.label_;n.toggleButton_=document.createElement("button"),n.toggleButton_.setAttribute("type","button"),n.toggleButton_.setAttribute("aria-expanded",String(!n.collapsed_)),n.toggleButton_.title=i,n.toggleButton_.appendChild(l),n.toggleButton_.addEventListener(F,n.handleClick_.bind(n),!1);var c=r+" ol-unselectable ol-control"+(n.collapsed_&&n.collapsible_?" ol-collapsed":"")+(n.collapsible_?"":" ol-uncollapsible"),f=n.element;return f.className=c,f.appendChild(n.toggleButton_),f.appendChild(n.ulElement_),n.renderedAttributions_=[],n.renderedVisible_=!0,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&nh(t,e)}(e,t),function(t,e,n){return e&&$f(t.prototype,e),n&&$f(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(e,[{key:"collectSourceAttributions_",value:function(t){var e=this.getMap().getAllLayers(),n=new Set(e.flatMap((function(e){return e.getAttributions(t)})));if(void 0!==this.attributions_&&(Array.isArray(this.attributions_)?this.attributions_.forEach((function(t){return n.add(t)})):n.add(this.attributions_)),!this.overrideCollapsible_){var r=!e.some((function(t){var e;return!1===(null===(e=t.getSource())||void 0===e?void 0:e.getAttributionsCollapsible())}));this.setCollapsible(r)}return Array.from(n)}},{key:"updateElement_",value:(n=Hf().mark((function t(e){var n,r,i,o,a;return Hf().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=3;break}return this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1),t.abrupt("return");case 3:return t.next=5,Promise.all(this.collectSourceAttributions_(e).map((function(t){return x((function(){return t}))})));case 5:if(n=t.sent,r=n.length>0,this.renderedVisible_!=r&&(this.element.style.display=r?"":"none",this.renderedVisible_=r),!m(n,this.renderedAttributions_)){t.next=10;break}return t.abrupt("return");case 10:for(aa(this.ulElement_),i=0,o=n.length;i<o;++i)(a=document.createElement("li")).innerHTML=n[i],this.ulElement_.appendChild(a);this.renderedAttributions_=n;case 13:case"end":return t.stop()}}),t,this)})),r=function(){var t=this,e=arguments;return new Promise((function(r,i){var o=n.apply(t,e);function a(t){Jf(o,r,i,a,u,"next",t)}function u(t){Jf(o,r,i,a,u,"throw",t)}a(void 0)}))},function(t){return r.apply(this,arguments)})},{key:"handleClick_",value:function(t){t.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}},{key:"handleToggle_",value:function(){this.element.classList.toggle("ol-collapsed"),this.collapsed_?oa(this.collapseLabel_,this.label_):oa(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}},{key:"getCollapsible",value:function(){return this.collapsible_}},{key:"setCollapsible",value:function(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}},{key:"setCollapsed",value:function(t){this.userCollapsed_=t,this.collapsible_&&this.collapsed_!==t&&this.handleToggle_()}},{key:"getCollapsed",value:function(){return this.collapsed_}},{key:"render",value:function(t){this.updateElement_(t.frameState)}}]);var n,r}(Vf);function ih(t){return(ih="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function oh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ah(r.key),r)}}function ah(t){var e=function(t,e){if("object"!=ih(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=ih(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ih(e)?e:e+""}function uh(t,e,n){return e=sh(e),function(t,e){if(e&&("object"==ih(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],sh(t).constructor):e.apply(t,n))}function sh(t){return(sh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function lh(t,e){return(lh=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var ch=function(t){function e(t){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t=t||{},n=uh(this,e,[{element:document.createElement("div"),render:t.render,target:t.target}]);var r=void 0!==t.className?t.className:"ol-rotate",i=void 0!==t.label?t.label:"",o=void 0!==t.compassClassName?t.compassClassName:"ol-compass";n.label_=null,"string"==typeof i?(n.label_=document.createElement("span"),n.label_.className=o,n.label_.textContent=i):(n.label_=i,n.label_.classList.add(o));var a=t.tipLabel?t.tipLabel:"Reset rotation",u=document.createElement("button");u.className=r+"-reset",u.setAttribute("type","button"),u.title=a,u.appendChild(n.label_),u.addEventListener(F,n.handleClick_.bind(n),!1);var s=r+" ol-unselectable ol-control",l=n.element;return l.className=s,l.appendChild(u),n.callResetNorth_=t.resetNorth?t.resetNorth:void 0,n.duration_=void 0!==t.duration?t.duration:250,n.autoHide_=void 0===t.autoHide||t.autoHide,n.rotation_=void 0,n.autoHide_&&n.element.classList.add("ol-hidden"),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&lh(t,e)}(e,t),n=e,(r=[{key:"handleClick_",value:function(t){t.preventDefault(),void 0!==this.callResetNorth_?this.callResetNorth_():this.resetNorth_()}},{key:"resetNorth_",value:function(){var t=this.getMap().getView();if(t){var e=t.getRotation();void 0!==e&&(this.duration_>0&&e%(2*Math.PI)!=0?t.animate({rotation:0,duration:this.duration_,easing:Fn}):t.setRotation(0))}}},{key:"render",value:function(t){var e=t.frameState;if(e){var n=e.viewState.rotation;if(n!=this.rotation_){var r="rotate("+n+"rad)";if(this.autoHide_){var i=this.element.classList.contains("ol-hidden");i||0!==n?i&&0!==n&&this.element.classList.remove("ol-hidden"):this.element.classList.add("ol-hidden")}this.label_.style.transform=r}this.rotation_=n}}}])&&oh(n.prototype,r),i&&oh(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(Vf);function fh(t){return(fh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function hh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,yh(r.key),r)}}function yh(t){var e=function(t,e){if("object"!=fh(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=fh(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==fh(e)?e:e+""}function ph(t,e,n){return e=dh(e),function(t,e){if(e&&("object"==fh(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],dh(t).constructor):e.apply(t,n))}function dh(t){return(dh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function vh(t,e){return(vh=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var gh=function(t){function e(t){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t=t||{},n=ph(this,e,[{element:document.createElement("div"),target:t.target}]);var r=void 0!==t.className?t.className:"ol-zoom",i=void 0!==t.delta?t.delta:1,o=void 0!==t.zoomInClassName?t.zoomInClassName:r+"-in",a=void 0!==t.zoomOutClassName?t.zoomOutClassName:r+"-out",u=void 0!==t.zoomInLabel?t.zoomInLabel:"+",s=void 0!==t.zoomOutLabel?t.zoomOutLabel:"",l=void 0!==t.zoomInTipLabel?t.zoomInTipLabel:"Zoom in",c=void 0!==t.zoomOutTipLabel?t.zoomOutTipLabel:"Zoom out",f=document.createElement("button");f.className=o,f.setAttribute("type","button"),f.title=l,f.appendChild("string"==typeof u?document.createTextNode(u):u),f.addEventListener(F,n.handleClick_.bind(n,i),!1);var h=document.createElement("button");h.className=a,h.setAttribute("type","button"),h.title=c,h.appendChild("string"==typeof s?document.createTextNode(s):s),h.addEventListener(F,n.handleClick_.bind(n,-i),!1);var y=r+" ol-unselectable ol-control",p=n.element;return p.className=y,p.appendChild(f),p.appendChild(h),n.duration_=void 0!==t.duration?t.duration:250,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&vh(t,e)}(e,t),n=e,(r=[{key:"handleClick_",value:function(t,e){e.preventDefault(),this.zoomByDelta_(t)}},{key:"zoomByDelta_",value:function(t){var e=this.getMap().getView();if(e){var n=e.getZoom();if(void 0!==n){var r=e.getConstrainedZoom(n+t);this.duration_>0?(e.getAnimating()&&e.cancelAnimations(),e.animate({zoom:r,duration:this.duration_,easing:Fn})):e.setZoom(r)}}}}])&&hh(n.prototype,r),i&&hh(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(Vf);var mh="active";function bh(t){return(bh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _h(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,wh(r.key),r)}}function wh(t){var e=function(t,e){if("object"!=bh(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=bh(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==bh(e)?e:e+""}function Sh(t,e,n){return e=xh(e),function(t,e){if(e&&("object"==bh(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],xh(t).constructor):e.apply(t,n))}function xh(t){return(xh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Oh(t,e){return(Oh=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function kh(t,e,n,r){var i=t.getZoom();if(void 0!==i){var o=t.getConstrainedZoom(i+e),a=t.getResolutionForZoom(o);t.getAnimating()&&t.cancelAnimations(),t.animate({resolution:a,anchor:n,duration:void 0!==r?r:250,easing:Fn})}}var Ph=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Sh(this,e)).on,n.once,n.un,t&&t.handleEvent&&(n.handleEvent=t.handleEvent),n.map_=null,n.setActive(!0),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Oh(t,e)}(e,t),n=e,(r=[{key:"getActive",value:function(){return this.get(mh)}},{key:"getMap",value:function(){return this.map_}},{key:"handleEvent",value:function(t){return!0}},{key:"setActive",value:function(t){this.set(mh,t)}},{key:"setMap",value:function(t){this.map_=t}}])&&_h(n.prototype,r),i&&_h(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(yt);function Eh(t){return(Eh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function jh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ch(r.key),r)}}function Ch(t){var e=function(t,e){if("object"!=Eh(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Eh(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Eh(e)?e:e+""}function Th(t,e,n){return e=Rh(e),function(t,e){if(e&&("object"==Eh(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],Rh(t).constructor):e.apply(t,n))}function Rh(t){return(Rh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ih(t,e){return(Ih=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Mh=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t=t||{},(n=Th(this,e)).delta_=t.delta?t.delta:1,n.duration_=void 0!==t.duration?t.duration:250,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ih(t,e)}(e,t),n=e,(r=[{key:"handleEvent",value:function(t){var e=!1;if(t.type==ef.DBLCLICK){var n=t.originalEvent,r=t.map,i=t.coordinate,o=n.shiftKey?-this.delta_:this.delta_;kh(r.getView(),o,i,this.duration_),n.preventDefault(),e=!0}return!e}}])&&jh(n.prototype,r),i&&jh(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(Ph);function Lh(t){return(Lh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ah(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Fh(r.key),r)}}function Fh(t){var e=function(t,e){if("object"!=Lh(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Lh(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Lh(e)?e:e+""}function Dh(t,e,n){return e=Nh(e),function(t,e){if(e&&("object"==Lh(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],Nh(t).constructor):e.apply(t,n))}function Nh(t){return(Nh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function zh(t,e){return(zh=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Bh(t){for(var e=t.length,n=0,r=0,i=0;i<e;i++)n+=t[i].clientX,r+=t[i].clientY;return{clientX:n/e,clientY:r/e}}var Gh=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=Dh(this,e,[t=t||{}]),t.handleDownEvent&&(n.handleDownEvent=t.handleDownEvent),t.handleDragEvent&&(n.handleDragEvent=t.handleDragEvent),t.handleMoveEvent&&(n.handleMoveEvent=t.handleMoveEvent),t.handleUpEvent&&(n.handleUpEvent=t.handleUpEvent),t.stopDown&&(n.stopDown=t.stopDown),n.handlingDownUpSequence=!1,n.targetPointers=[],n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&zh(t,e)}(e,t),n=e,(r=[{key:"getPointerCount",value:function(){return this.targetPointers.length}},{key:"handleDownEvent",value:function(t){return!1}},{key:"handleDragEvent",value:function(t){}},{key:"handleEvent",value:function(t){if(!t.originalEvent)return!0;var e=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==ef.POINTERDRAG)this.handleDragEvent(t),t.originalEvent.preventDefault();else if(t.type==ef.POINTERUP){var n=this.handleUpEvent(t);this.handlingDownUpSequence=n&&this.targetPointers.length>0}}else if(t.type==ef.POINTERDOWN){var r=this.handleDownEvent(t);this.handlingDownUpSequence=r,e=this.stopDown(r)}else t.type==ef.POINTERMOVE&&this.handleMoveEvent(t);return!e}},{key:"handleMoveEvent",value:function(t){}},{key:"handleUpEvent",value:function(t){return!1}},{key:"stopDown",value:function(t){return t}},{key:"updateTrackedPointers_",value:function(t){t.activePointers&&(this.targetPointers=t.activePointers)}}])&&Ah(n.prototype,r),i&&Ah(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(Ph);function Wh(t){var e=arguments;return function(t){for(var n=!0,r=0,i=e.length;r<i&&(n=n&&e[r](t));++r);return n}}var Xh=function(t){var e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},Yh=function(t){var e=t.map.getTargetElement(),n=e.getRootNode();return!(n instanceof ShadowRoot?n.host:e).hasAttribute("tabindex")||function(t){var e=t.map.getTargetElement(),n=e.getRootNode(),r=t.map.getOwnerDocument().activeElement;return n instanceof ShadowRoot?n.host.contains(r):e.contains(r)}(t)},Kh=b,Zh=function(t){var e=t.originalEvent;return 0==e.button&&!(Vo&&qo&&e.ctrlKey)},Uh=function(t){var e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},Vh=function(t){var e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},qh=function(t){var e=t.originalEvent,n=e.target.tagName;return"INPUT"!==n&&"SELECT"!==n&&"TEXTAREA"!==n&&!e.target.isContentEditable},Hh=function(t){var e=t.originalEvent;return En(void 0!==e,"mapBrowserEvent must originate from a pointer event"),"mouse"==e.pointerType},Jh=function(t){var e=t.originalEvent;return En(void 0!==e,"mapBrowserEvent must originate from a pointer event"),e.isPrimary&&0===e.button};function $h(t){return($h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Qh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ty(r.key),r)}}function ty(t){var e=function(t,e){if("object"!=$h(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=$h(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==$h(e)?e:e+""}function ey(t,e,n){return e=ny(e),function(t,e){if(e&&("object"==$h(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],ny(t).constructor):e.apply(t,n))}function ny(t){return(ny=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ry(t,e){return(ry=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var iy=function(t){function e(t){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t=t||{},(n=ey(this,e,[{stopDown:_}])).kinetic_=t.kinetic,n.lastCentroid=null,n.lastPointersCount_,n.panning_=!1;var r=t.condition?t.condition:Wh(Uh,Jh);return n.condition_=t.onFocusOnly?Wh(Yh,r):r,n.noKinetic_=!1,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ry(t,e)}(e,t),n=e,(r=[{key:"handleDragEvent",value:function(t){var e=t.map;this.panning_||(this.panning_=!0,e.getView().beginInteraction());var n,r,i=this.targetPointers,o=e.getEventPixel(Bh(i));if(i.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(o[0],o[1]),this.lastCentroid){var a=[this.lastCentroid[0]-o[0],o[1]-this.lastCentroid[1]],u=t.map.getView();n=a,r=u.getResolution(),n[0]*=r,n[1]*=r,Ue(a,u.getRotation()),u.adjustCenterInternal(a)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=o,this.lastPointersCount_=i.length,t.originalEvent.preventDefault()}},{key:"handleUpEvent",value:function(t){var e=t.map,n=e.getView();if(0===this.targetPointers.length){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){var r=this.kinetic_.getDistance(),i=this.kinetic_.getAngle(),o=n.getCenterInternal(),a=e.getPixelFromCoordinateInternal(o),u=e.getCoordinateFromPixelInternal([a[0]-r*Math.cos(i),a[1]-r*Math.sin(i)]);n.animateInternal({center:n.getConstrainedCenter(u),duration:500,easing:Fn})}return this.panning_&&(this.panning_=!1,n.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}},{key:"handleDownEvent",value:function(t){if(this.targetPointers.length>0&&this.condition_(t)){var e=t.map.getView();return this.lastCentroid=null,e.getAnimating()&&e.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}])&&Qh(n.prototype,r),i&&Qh(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(Gh);function oy(t){return(oy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ay(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,uy(r.key),r)}}function uy(t){var e=function(t,e){if("object"!=oy(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=oy(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==oy(e)?e:e+""}function sy(t,e,n){return e=ly(e),function(t,e){if(e&&("object"==oy(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],ly(t).constructor):e.apply(t,n))}function ly(t){return(ly=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function cy(t,e){return(cy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var fy=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t=t||{},(n=sy(this,e,[{stopDown:_}])).condition_=t.condition?t.condition:Xh,n.lastAngle_=void 0,n.duration_=void 0!==t.duration?t.duration:250,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&cy(t,e)}(e,t),n=e,(r=[{key:"handleDragEvent",value:function(t){if(Hh(t)){var e=t.map,n=e.getView();if(n.getConstraints().rotation!==Mn){var r=e.getSize(),i=t.pixel,o=Math.atan2(r[1]/2-i[1],i[0]-r[0]/2);if(void 0!==this.lastAngle_){var a=o-this.lastAngle_;n.adjustRotationInternal(-a)}this.lastAngle_=o}}}},{key:"handleUpEvent",value:function(t){return!Hh(t)||(t.map.getView().endInteraction(this.duration_),!1)}},{key:"handleDownEvent",value:function(t){return!(!Hh(t)||!Zh(t)||!this.condition_(t)||(t.map.getView().beginInteraction(),this.lastAngle_=void 0,0))}}])&&ay(n.prototype,r),i&&ay(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(Gh);function hy(t){return(hy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function yy(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,py(r.key),r)}}function py(t){var e=function(t,e){if("object"!=hy(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=hy(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==hy(e)?e:e+""}function dy(t,e,n){return e=vy(e),function(t,e){if(e&&("object"==hy(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],vy(t).constructor):e.apply(t,n))}function vy(t){return(vy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function gy(t,e){return(gy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var my=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=dy(this,e)).geometry_=null,n.element_=document.createElement("div"),n.element_.style.position="absolute",n.element_.style.pointerEvents="auto",n.element_.className="ol-box "+t,n.map_=null,n.startPixel_=null,n.endPixel_=null,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&gy(t,e)}(e,t),n=e,(r=[{key:"disposeInternal",value:function(){this.setMap(null)}},{key:"render_",value:function(){var t=this.startPixel_,e=this.endPixel_,n=this.element_.style;n.left=Math.min(t[0],e[0])+"px",n.top=Math.min(t[1],e[1])+"px",n.width=Math.abs(e[0]-t[0])+"px",n.height=Math.abs(e[1]-t[1])+"px"}},{key:"setMap",value:function(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);var e=this.element_.style;e.left="inherit",e.top="inherit",e.width="inherit",e.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}},{key:"setPixels",value:function(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()}},{key:"createOrUpdateGeometry",value:function(){if(this.map_){var t=this.startPixel_,e=this.endPixel_,n=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);n[4]=n[0].slice(),this.geometry_?this.geometry_.setCoordinates([n]):this.geometry_=new oi([n])}}},{key:"getGeometry",value:function(){return this.geometry_}}])&&yy(n.prototype,r),i&&yy(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(y);function by(t){return(by="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _y(t,e,n,r){var i=wy(jy(1&r?t.prototype:t),e,n);return 2&r&&"function"==typeof i?function(t){return i.apply(n,t)}:i}function wy(){return(wy="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=Sy(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}}).apply(null,arguments)}function Sy(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=jy(t)););return t}function xy(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ky(r.key),r)}}function Oy(t,e,n){return e&&xy(t.prototype,e),n&&xy(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function ky(t){var e=function(t,e){if("object"!=by(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=by(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==by(e)?e:e+""}function Py(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ey(t,e,n){return e=jy(e),function(t,e){if(e&&("object"==by(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],jy(t).constructor):e.apply(t,n))}function jy(t){return(jy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Cy(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ty(t,e)}function Ty(t,e){return(Ty=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Ry="boxstart",Iy="boxdrag",My="boxend",Ly="boxcancel",Ay=function(t){function e(t,n,r){var i;return Py(this,e),(i=Ey(this,e,[t])).coordinate=n,i.mapBrowserEvent=r,i}return Cy(e,t),Oy(e)}(s);function Fy(t){return(Fy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Dy(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ny(r.key),r)}}function Ny(t){var e=function(t,e){if("object"!=Fy(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Fy(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Fy(e)?e:e+""}function zy(t,e,n){return e=By(e),function(t,e){if(e&&("object"==Fy(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],By(t).constructor):e.apply(t,n))}function By(t){return(By=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Gy(t,e){return(Gy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Wy=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=zy(this,e,[{condition:(t=t||{}).condition?t.condition:Vh,className:t.className||"ol-dragzoom",minArea:t.minArea}])).duration_=void 0!==t.duration?t.duration:200,n.out_=void 0!==t.out&&t.out,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Gy(t,e)}(e,t),n=e,(r=[{key:"onBoxEnd",value:function(t){var e=this.getMap().getView(),n=this.getGeometry();if(this.out_){var r=e.rotatedExtentForGeometry(n),i=e.getResolutionForExtentInternal(r),o=e.getResolution()/i;(n=n.clone()).scale(o*o)}e.fitInternal(n,{duration:this.duration_,easing:Fn})}}])&&Dy(n.prototype,r),i&&Dy(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(function(t){function e(t){var n,r,i,o,a;return Py(this,e),(a=Ey(this,e)).on,a.once,a.un,t=null!==(n=t)&&void 0!==n?n:{},a.box_=new my(t.className||"ol-dragbox"),a.minArea_=null!==(r=t.minArea)&&void 0!==r?r:64,t.onBoxEnd&&(a.onBoxEnd=t.onBoxEnd),a.startPixel_=null,a.condition_=null!==(i=t.condition)&&void 0!==i?i:Zh,a.boxEndCondition_=null!==(o=t.boxEndCondition)&&void 0!==o?o:a.defaultBoxEndCondition,a}return Cy(e,t),Oy(e,[{key:"defaultBoxEndCondition",value:function(t,e,n){var r=n[0]-e[0],i=n[1]-e[1];return r*r+i*i>=this.minArea_}},{key:"getGeometry",value:function(){return this.box_.getGeometry()}},{key:"handleDragEvent",value:function(t){this.startPixel_&&(this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new Ay(Iy,t.coordinate,t)))}},{key:"handleUpEvent",value:function(t){if(!this.startPixel_)return!1;var e=this.boxEndCondition_(t,this.startPixel_,t.pixel);return e&&this.onBoxEnd(t),this.dispatchEvent(new Ay(e?My:Ly,t.coordinate,t)),this.box_.setMap(null),this.startPixel_=null,!1}},{key:"handleDownEvent",value:function(t){return!!this.condition_(t)&&(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new Ay(Ry,t.coordinate,t)),!0)}},{key:"onBoxEnd",value:function(t){}},{key:"setActive",value:function(t){t||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new Ay(Ly,this.startPixel_,null)),this.startPixel_=null)),_y(e,"setActive",this,3)([t])}},{key:"setMap",value:function(t){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new Ay(Ly,this.startPixel_,null)),this.startPixel_=null)),_y(e,"setMap",this,3)([t])}}])}(Gh)),Xy="ArrowLeft",Yy="ArrowUp",Ky="ArrowRight",Zy="ArrowDown";function Uy(t){return(Uy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vy(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,qy(r.key),r)}}function qy(t){var e=function(t,e){if("object"!=Uy(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Uy(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Uy(e)?e:e+""}function Hy(t,e,n){return e=Jy(e),function(t,e){if(e&&("object"==Uy(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],Jy(t).constructor):e.apply(t,n))}function Jy(t){return(Jy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $y(t,e){return($y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Qy=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t=t||{},(n=Hy(this,e)).defaultCondition_=function(t){return Uh(t)&&qh(t)},n.condition_=void 0!==t.condition?t.condition:n.defaultCondition_,n.duration_=void 0!==t.duration?t.duration:100,n.pixelDelta_=void 0!==t.pixelDelta?t.pixelDelta:128,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&$y(t,e)}(e,t),n=e,(r=[{key:"handleEvent",value:function(t){var e=!1;if(t.type==N){var n=t.originalEvent,r=n.key;if(this.condition_(t)&&(r==Zy||r==Xy||r==Ky||r==Yy)){var i=t.map.getView(),o=i.getResolution()*this.pixelDelta_,a=0,u=0;r==Zy?u=-o:r==Xy?a=-o:r==Ky?a=o:u=o;var s=[a,u];Ue(s,i.getRotation()),function(t,e,n){var r=t.getCenterInternal();if(r){var i=[r[0]+e[0],r[1]+e[1]];t.animateInternal({duration:void 0!==n?n:250,easing:Nn,center:t.getConstrainedCenter(i)})}}(i,s,this.duration_),n.preventDefault(),e=!0}}return!e}}])&&Vy(n.prototype,r),i&&Vy(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(Ph);function tp(t){return(tp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ep(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,np(r.key),r)}}function np(t){var e=function(t,e){if("object"!=tp(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=tp(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==tp(e)?e:e+""}function rp(t,e,n){return e=ip(e),function(t,e){if(e&&("object"==tp(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],ip(t).constructor):e.apply(t,n))}function ip(t){return(ip=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function op(t,e){return(op=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var ap=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t=t||{},(n=rp(this,e)).condition_=t.condition?t.condition:function(t){return!function(t){var e=t.originalEvent;return qo?e.metaKey:e.ctrlKey}(t)&&qh(t)},n.delta_=t.delta?t.delta:1,n.duration_=void 0!==t.duration?t.duration:100,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&op(t,e)}(e,t),n=e,(r=[{key:"handleEvent",value:function(t){var e=!1;if(t.type==N||t.type==z){var n=t.originalEvent,r=n.key;if(this.condition_(t)&&("+"===r||"-"===r)){var i=t.map,o="+"===r?this.delta_:-this.delta_;kh(i.getView(),o,void 0,this.duration_),n.preventDefault(),e=!0}}return!e}}])&&ep(n.prototype,r),i&&ep(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(Ph);function up(t){return(up="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function sp(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,lp(r.key),r)}}function lp(t){var e=function(t,e){if("object"!=up(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=up(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==up(e)?e:e+""}var cp=function(){return t=function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.decay_=e,this.minVelocity_=n,this.delay_=r,this.points_=[],this.angle_=0,this.initialVelocity_=0},(e=[{key:"begin",value:function(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}},{key:"update",value:function(t,e){this.points_.push(t,e,Date.now())}},{key:"end",value:function(){if(this.points_.length<6)return!1;var t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[e+2]<t)return!1;for(var n=e-3;n>0&&this.points_[n+2]>t;)n-=3;var r=this.points_[e+2]-this.points_[n+2];if(r<1e3/60)return!1;var i=this.points_[e]-this.points_[n],o=this.points_[e+1]-this.points_[n+1];return this.angle_=Math.atan2(o,i),this.initialVelocity_=Math.sqrt(i*i+o*o)/r,this.initialVelocity_>this.minVelocity_}},{key:"getDistance",value:function(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}},{key:"getAngle",value:function(){return this.angle_}}])&&sp(t.prototype,e),n&&sp(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}();function fp(t){return(fp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function hp(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,yp(r.key),r)}}function yp(t){var e=function(t,e){if("object"!=fp(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=fp(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==fp(e)?e:e+""}function pp(t,e,n){return e=dp(e),function(t,e){if(e&&("object"==fp(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],dp(t).constructor):e.apply(t,n))}function dp(t){return(dp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function vp(t,e){return(vp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var gp=function(t){function e(t){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=pp(this,e,[t=t||{}])).totalDelta_=0,n.lastDelta_=0,n.maxDelta_=void 0!==t.maxDelta?t.maxDelta:1,n.duration_=void 0!==t.duration?t.duration:250,n.timeout_=void 0!==t.timeout?t.timeout:80,n.useAnchor_=void 0===t.useAnchor||t.useAnchor,n.constrainResolution_=void 0!==t.constrainResolution&&t.constrainResolution;var r=t.condition?t.condition:Kh;return n.condition_=t.onFocusOnly?Wh(Yh,r):r,n.lastAnchor_=null,n.startTime_=void 0,n.timeoutId_,n.mode_=void 0,n.trackpadEventGap_=400,n.trackpadTimeoutId_,n.deltaPerZoom_=300,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&vp(t,e)}(e,t),n=e,(r=[{key:"endInteraction_",value:function(){this.trackpadTimeoutId_=void 0;var t=this.getMap();t&&t.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_)}},{key:"handleEvent",value:function(t){if(!this.condition_(t))return!0;if(t.type!==W)return!0;var e,n=t.map,r=t.originalEvent;if(r.preventDefault(),this.useAnchor_&&(this.lastAnchor_=t.coordinate),t.type==W&&(e=r.deltaY,Uo&&r.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(e/=Ho),r.deltaMode===WheelEvent.DOM_DELTA_LINE&&(e*=40)),0===e)return!1;this.lastDelta_=e;var i=Date.now();void 0===this.startTime_&&(this.startTime_=i),(!this.mode_||i-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(e)<4?"trackpad":"wheel");var o=n.getView();if("trackpad"===this.mode_&&!o.getConstrainResolution()&&!this.constrainResolution_)return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(o.getAnimating()&&o.cancelAnimations(),o.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),o.adjustZoom(-e/this.deltaPerZoom_,this.lastAnchor_),this.startTime_=i,!1;this.totalDelta_+=e;var a=Math.max(this.timeout_-(i-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,n),a),!1}},{key:"handleWheelZoom_",value:function(t){var e=t.getView();e.getAnimating()&&e.cancelAnimations();var n=-De(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(e.getConstrainResolution()||this.constrainResolution_)&&(n=n?n>0?1:-1:0),kh(e,n,this.lastAnchor_,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}},{key:"setMouseAnchor",value:function(t){this.useAnchor_=t,t||(this.lastAnchor_=null)}}])&&hp(n.prototype,r),i&&hp(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(Ph);function mp(t){return(mp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function bp(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_p(r.key),r)}}function _p(t){var e=function(t,e){if("object"!=mp(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=mp(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==mp(e)?e:e+""}function wp(t,e,n){return e=Sp(e),function(t,e){if(e&&("object"==mp(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],Sp(t).constructor):e.apply(t,n))}function Sp(t){return(Sp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function xp(t,e){return(xp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Op=function(t){function e(t){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=t=t||{};return r.stopDown||(r.stopDown=_),(n=wp(this,e,[r])).anchor_=null,n.lastAngle_=void 0,n.rotating_=!1,n.rotationDelta_=0,n.threshold_=void 0!==t.threshold?t.threshold:.3,n.duration_=void 0!==t.duration?t.duration:250,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&xp(t,e)}(e,t),n=e,(r=[{key:"handleDragEvent",value:function(t){var e=0,n=this.targetPointers[0],r=this.targetPointers[1],i=Math.atan2(r.clientY-n.clientY,r.clientX-n.clientX);if(void 0!==this.lastAngle_){var o=i-this.lastAngle_;this.rotationDelta_+=o,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=o}this.lastAngle_=i;var a=t.map,u=a.getView();u.getConstraints().rotation!==Mn&&(this.anchor_=a.getCoordinateFromPixelInternal(a.getEventPixel(Bh(this.targetPointers))),this.rotating_&&(a.render(),u.adjustRotationInternal(e,this.anchor_)))}},{key:"handleUpEvent",value:function(t){return!(this.targetPointers.length<2&&(t.map.getView().endInteraction(this.duration_),1))}},{key:"handleDownEvent",value:function(t){if(this.targetPointers.length>=2){var e=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}}])&&bp(n.prototype,r),i&&bp(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(Gh);function kp(t){return(kp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Pp(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ep(r.key),r)}}function Ep(t){var e=function(t,e){if("object"!=kp(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=kp(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==kp(e)?e:e+""}function jp(t,e,n){return e=Cp(e),function(t,e){if(e&&("object"==kp(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],Cp(t).constructor):e.apply(t,n))}function Cp(t){return(Cp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Tp(t,e){return(Tp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Rp=function(t){function e(t){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=t=t||{};return r.stopDown||(r.stopDown=_),(n=jp(this,e,[r])).anchor_=null,n.duration_=void 0!==t.duration?t.duration:400,n.lastDistance_=void 0,n.lastScaleDelta_=1,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Tp(t,e)}(e,t),n=e,(r=[{key:"handleDragEvent",value:function(t){var e=1,n=this.targetPointers[0],r=this.targetPointers[1],i=n.clientX-r.clientX,o=n.clientY-r.clientY,a=Math.sqrt(i*i+o*o);void 0!==this.lastDistance_&&(e=this.lastDistance_/a),this.lastDistance_=a;var u=t.map,s=u.getView();1!=e&&(this.lastScaleDelta_=e),this.anchor_=u.getCoordinateFromPixelInternal(u.getEventPixel(Bh(this.targetPointers))),u.render(),s.adjustResolutionInternal(e,this.anchor_)}},{key:"handleUpEvent",value:function(t){if(this.targetPointers.length<2){var e=t.map.getView(),n=this.lastScaleDelta_>1?1:-1;return e.endInteraction(this.duration_,n),!1}return!0}},{key:"handleDownEvent",value:function(t){if(this.targetPointers.length>=2){var e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}}])&&Pp(n.prototype,r),i&&Pp(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(Gh);function Ip(t){return(Ip="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Mp(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Lp(r.key),r)}}function Lp(t){var e=function(t,e){if("object"!=Ip(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Ip(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Ip(e)?e:e+""}function Ap(t,e,n){return e=Np(e),function(t,e){if(e&&("object"==Ip(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],Np(t).constructor):e.apply(t,n))}function Fp(){return(Fp="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=Dp(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}}).apply(null,arguments)}function Dp(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=Np(t)););return t}function Np(t){return(Np=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function zp(t,e){return(zp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Bp(t){t instanceof co?t.setMapInternal(null):t instanceof Dc&&t.getLayers().forEach(Bp)}var Gp=function(t){function e(t){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t=t||{},(n=Ap(this,e)).on,n.once,n.un;var r=function(t){var e=null;void 0!==t.keyboardEventTarget&&(e="string"==typeof t.keyboardEventTarget?document.getElementById(t.keyboardEventTarget):t.keyboardEventTarget);var n,r,i,o={},a=t.layers&&"function"==typeof t.layers.getLayers?t.layers:new Dc({layers:t.layers});o[bf]=a,o[wf]=t.target,o[Sf]=t.view instanceof vi?t.view:new vi,void 0!==t.controls&&(Array.isArray(t.controls)?n=new Ti(t.controls.slice()):(En("function"==typeof t.controls.getArray,"Expected `controls` to be an array or an `ol/Collection.js`"),n=t.controls));void 0!==t.interactions&&(Array.isArray(t.interactions)?r=new Ti(t.interactions.slice()):(En("function"==typeof t.interactions.getArray,"Expected `interactions` to be an array or an `ol/Collection.js`"),r=t.interactions));void 0!==t.overlays?Array.isArray(t.overlays)?i=new Ti(t.overlays.slice()):(En("function"==typeof t.overlays.getArray,"Expected `overlays` to be an array or an `ol/Collection.js`"),i=t.overlays):i=new Ti;return{controls:n,interactions:r,keyboardEventTarget:e,overlays:i,values:o}}(t);n.renderComplete_=!1,n.loaded_=!0,n.boundHandleBrowserEvent_=n.handleBrowserEvent.bind(n),n.maxTilesLoading_=void 0!==t.maxTilesLoading?t.maxTilesLoading:16,n.pixelRatio_=void 0!==t.pixelRatio?t.pixelRatio:Ho,n.postRenderTimeoutHandle_,n.animationDelayKey_,n.animationDelay_=n.animationDelay_.bind(n),n.coordinateToPixelTransform_=[1,0,0,1,0,0],n.pixelToCoordinateTransform_=[1,0,0,1,0,0],n.frameIndex_=0,n.frameState_=null,n.previousExtent_=null,n.viewPropertyListenerKey_=null,n.viewChangeListenerKey_=null,n.layerGroupPropertyListenerKeys_=null,n.viewport_=document.createElement("div"),n.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),n.viewport_.style.position="relative",n.viewport_.style.overflow="hidden",n.viewport_.style.width="100%",n.viewport_.style.height="100%",n.overlayContainer_=document.createElement("div"),n.overlayContainer_.style.position="absolute",n.overlayContainer_.style.zIndex="0",n.overlayContainer_.style.width="100%",n.overlayContainer_.style.height="100%",n.overlayContainer_.style.pointerEvents="none",n.overlayContainer_.className="ol-overlaycontainer",n.viewport_.appendChild(n.overlayContainer_),n.overlayContainerStopEvent_=document.createElement("div"),n.overlayContainerStopEvent_.style.position="absolute",n.overlayContainerStopEvent_.style.zIndex="0",n.overlayContainerStopEvent_.style.width="100%",n.overlayContainerStopEvent_.style.height="100%",n.overlayContainerStopEvent_.style.pointerEvents="none",n.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",n.viewport_.appendChild(n.overlayContainerStopEvent_),n.mapBrowserEventHandler_=null,n.moveTolerance_=t.moveTolerance,n.keyboardEventTarget_=r.keyboardEventTarget,n.targetChangeHandlerKeys_=null,n.targetElement_=null,n.resizeObserver_=new ResizeObserver((function(){return n.updateSize()})),n.controls=r.controls||function(t){t=t||{};var e=new Ti;return(void 0===t.zoom||t.zoom)&&e.push(new gh(t.zoomOptions)),(void 0===t.rotate||t.rotate)&&e.push(new ch(t.rotateOptions)),(void 0===t.attribution||t.attribution)&&e.push(new rh(t.attributionOptions)),e}(),n.interactions=r.interactions||function(t){t=t||{};var e=new Ti,n=new cp(-.005,.05,100);return(void 0===t.altShiftDragRotate||t.altShiftDragRotate)&&e.push(new fy),(void 0===t.doubleClickZoom||t.doubleClickZoom)&&e.push(new Mh({delta:t.zoomDelta,duration:t.zoomDuration})),(void 0===t.dragPan||t.dragPan)&&e.push(new iy({onFocusOnly:t.onFocusOnly,kinetic:n})),(void 0===t.pinchRotate||t.pinchRotate)&&e.push(new Op),(void 0===t.pinchZoom||t.pinchZoom)&&e.push(new Rp({duration:t.zoomDuration})),(void 0===t.keyboard||t.keyboard)&&(e.push(new Qy),e.push(new ap({delta:t.zoomDelta,duration:t.zoomDuration}))),(void 0===t.mouseWheelZoom||t.mouseWheelZoom)&&e.push(new gp({onFocusOnly:t.onFocusOnly,duration:t.zoomDuration})),(void 0===t.shiftDragZoom||t.shiftDragZoom)&&e.push(new Wy({duration:t.zoomDuration})),e}({onFocusOnly:!0}),n.overlays_=r.overlays,n.overlayIdIndex_={},n.renderer_=null,n.postRenderFunctions_=[],n.tileQueue_=new zf(n.getTilePriority.bind(n),n.handleTileChange_.bind(n)),n.addChangeListener(bf,n.handleLayerGroupChanged_),n.addChangeListener(Sf,n.handleViewChanged_),n.addChangeListener(_f,n.handleSizeChanged_),n.addChangeListener(wf,n.handleTargetChanged_),n.setProperties(r.values);var i=n;return!t.view||t.view instanceof vi||t.view.then((function(t){i.setView(new vi(t))})),n.controls.addEventListener(gi,(function(t){t.element.setMap(n)})),n.controls.addEventListener(mi,(function(t){t.element.setMap(null)})),n.interactions.addEventListener(gi,(function(t){t.element.setMap(n)})),n.interactions.addEventListener(mi,(function(t){t.element.setMap(null)})),n.overlays_.addEventListener(gi,(function(t){n.addOverlayInternal_(t.element)})),n.overlays_.addEventListener(mi,(function(t){var e=t.element.getId();void 0!==e&&delete n.overlayIdIndex_[e.toString()],t.element.setMap(null)})),n.controls.forEach((function(t){t.setMap(n)})),n.interactions.forEach((function(t){t.setMap(n)})),n.overlays_.forEach(n.addOverlayInternal_.bind(n)),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&zp(t,e)}(e,t),function(t,e,n){return e&&Mp(t.prototype,e),n&&Mp(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(e,[{key:"addControl",value:function(t){this.getControls().push(t)}},{key:"addInteraction",value:function(t){this.getInteractions().push(t)}},{key:"addLayer",value:function(t){this.getLayerGroup().getLayers().push(t)}},{key:"handleLayerAdd_",value:function(t){!function t(e,n){if(e instanceof co)e.setMapInternal(n);else if(e instanceof Dc)for(var r=e.getLayers().getArray(),i=0,o=r.length;i<o;++i)t(r[i],n)}(t.layer,this)}},{key:"addOverlay",value:function(t){this.getOverlays().push(t)}},{key:"addOverlayInternal_",value:function(t){var e=t.getId();void 0!==e&&(this.overlayIdIndex_[e.toString()]=t),t.setMap(this)}},{key:"disposeInternal",value:function(){var t,n,r,i,o;this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_.disconnect(),this.setTarget(null),(t=e,n="disposeInternal",r=this,o=Fp(Np(1&(i=3)?t.prototype:t),n,r),2&i&&"function"==typeof o?function(t){return o.apply(r,t)}:o)([])}},{key:"forEachFeatureAtPixel",value:function(t,e,n){if(this.frameState_&&this.renderer_){var r=this.getCoordinateFromPixelInternal(t),i=void 0!==(n=void 0!==n?n:{}).hitTolerance?n.hitTolerance:0,o=void 0!==n.layerFilter?n.layerFilter:b,a=!1!==n.checkWrapped;return this.renderer_.forEachFeatureAtCoordinate(r,this.frameState_,i,a,e,null,o,null)}}},{key:"getFeaturesAtPixel",value:function(t,e){var n=[];return this.forEachFeatureAtPixel(t,(function(t){n.push(t)}),e),n}},{key:"getAllLayers",value:function(){var t=[];return function e(n){n.forEach((function(n){n instanceof Dc?e(n.getLayers()):t.push(n)}))}(this.getLayers()),t}},{key:"hasFeatureAtPixel",value:function(t,e){if(!this.frameState_||!this.renderer_)return!1;var n=this.getCoordinateFromPixelInternal(t),r=void 0!==(e=void 0!==e?e:{}).layerFilter?e.layerFilter:b,i=void 0!==e.hitTolerance?e.hitTolerance:0,o=!1!==e.checkWrapped;return this.renderer_.hasFeatureAtCoordinate(n,this.frameState_,i,o,r,null)}},{key:"getEventCoordinate",value:function(t){return this.getCoordinateFromPixel(this.getEventPixel(t))}},{key:"getEventCoordinateInternal",value:function(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))}},{key:"getEventPixel",value:function(t){var e=this.viewport_.getBoundingClientRect(),n=this.getSize(),r=e.width/n[0],i=e.height/n[1],o="changedTouches"in t?t.changedTouches[0]:t;return[(o.clientX-e.left)/r,(o.clientY-e.top)/i]}},{key:"getTarget",value:function(){return this.get(wf)}},{key:"getTargetElement",value:function(){return this.targetElement_}},{key:"getCoordinateFromPixel",value:function(t){return Sn(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())}},{key:"getCoordinateFromPixelInternal",value:function(t){var e=this.frameState_;return e?zn(e.pixelToCoordinateTransform,t.slice()):null}},{key:"getControls",value:function(){return this.controls}},{key:"getOverlays",value:function(){return this.overlays_}},{key:"getOverlayById",value:function(t){var e=this.overlayIdIndex_[t.toString()];return void 0!==e?e:null}},{key:"getInteractions",value:function(){return this.interactions}},{key:"getLayerGroup",value:function(){return this.get(bf)}},{key:"setLayers",value:function(t){var e=this.getLayerGroup();if(t instanceof Ti)e.setLayers(t);else{var n=e.getLayers();n.clear(),n.extend(t)}}},{key:"getLayers",value:function(){return this.getLayerGroup().getLayers()}},{key:"getLoadingOrNotReady",value:function(){for(var t=this.getLayerGroup().getLayerStatesArray(),e=0,n=t.length;e<n;++e){var r=t[e];if(r.visible){var i=r.layer.getRenderer();if(i&&!i.ready)return!0;var o=r.layer.getSource();if(o&&o.loading)return!0}}return!1}},{key:"getPixelFromCoordinate",value:function(t){var e=xn(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(e)}},{key:"getPixelFromCoordinateInternal",value:function(t){var e=this.frameState_;return e?zn(e.coordinateToPixelTransform,t.slice(0,2)):null}},{key:"getRenderer",value:function(){return this.renderer_}},{key:"getSize",value:function(){return this.get(_f)}},{key:"getView",value:function(){return this.get(Sf)}},{key:"getViewport",value:function(){return this.viewport_}},{key:"getOverlayContainer",value:function(){return this.overlayContainer_}},{key:"getOverlayContainerStopEvent",value:function(){return this.overlayContainerStopEvent_}},{key:"getOwnerDocument",value:function(){var t=this.getTargetElement();return t?t.ownerDocument:document}},{key:"getTilePriority",value:function(t,e,n,r){return function(t,e,n,r,i){if(!t||!(n in t.wantedTiles))return 1/0;if(!t.wantedTiles[n][e.getKey()])return 1/0;var o=t.viewState.center,a=r[0]-o[0],u=r[1]-o[1];return 65536*Math.log(i)+Math.sqrt(a*a+u*u)/i}(this.frameState_,t,e,n,r)}},{key:"handleBrowserEvent",value:function(t,e){e=e||t.type;var n=new tf(e,this,t);this.handleMapBrowserEvent(n)}},{key:"handleMapBrowserEvent",value:function(t){if(this.frameState_){var e=t.originalEvent,n=e.type;if(n===rf||n===W||n===N){var r=this.getOwnerDocument(),i=this.viewport_.getRootNode?this.viewport_.getRootNode():r,o=e.target,a=i instanceof ShadowRoot?i.host===o?i.host.ownerDocument:i:i===r?r.documentElement:i;if(this.overlayContainerStopEvent_.contains(o)||!a.contains(o))return}if(t.frameState=this.frameState_,!1!==this.dispatchEvent(t))for(var u=this.getInteractions().getArray().slice(),s=u.length-1;s>=0;s--){var l=u[s];if(l.getMap()===this&&l.getActive()&&this.getTargetElement())if(!l.handleEvent(t)||t.propagationStopped)break}}}},{key:"handlePostRender",value:function(){var t=this.frameState_,e=this.tileQueue_;if(!e.isEmpty()){var n=this.maxTilesLoading_,r=n;if(t){var i=t.viewHints;if(i[pt]||i[dt]){var o=Date.now()-t.time>8;n=o?0:8,r=o?0:2}}e.getTilesLoading()<n&&(e.reprioritize(),e.loadMoreTiles(n,r))}t&&this.renderer_&&!t.animate&&(this.renderComplete_?(this.hasListener(to)&&this.renderer_.dispatchRenderEvent(to,t),!1===this.loaded_&&(this.loaded_=!0,this.dispatchEvent(new Yc(mf,this,t)))):!0===this.loaded_&&(this.loaded_=!1,this.dispatchEvent(new Yc(gf,this,t))));for(var a=this.postRenderFunctions_,u=0,s=a.length;u<s;++u)a[u](this,t);a.length=0}},{key:"handleSizeChanged_",value:function(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}},{key:"handleTargetChanged_",value:function(){if(this.mapBrowserEventHandler_){for(var t=0,e=this.targetChangeHandlerKeys_.length;t<e;++t)K(this.targetChangeHandlerKeys_[t]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(A,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(W,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_){this.resizeObserver_.unobserve(this.targetElement_);var n=this.targetElement_.getRootNode();n instanceof ShadowRoot&&this.resizeObserver_.unobserve(n.host),this.setSize(void 0)}var r=this.getTarget(),i="string"==typeof r?document.getElementById(r):r;if(this.targetElement_=i,i){for(var o in i.appendChild(this.viewport_),this.renderer_||(this.renderer_=new kc(this)),this.mapBrowserEventHandler_=new yf(this,this.moveTolerance_),ef)this.mapBrowserEventHandler_.addEventListener(ef[o],this.handleMapBrowserEvent.bind(this));var a;if(this.viewport_.addEventListener(A,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(W,this.boundHandleBrowserEvent_,!!Qo&&{passive:!1}),this.keyboardEventTarget_)a=this.keyboardEventTarget_;else{var u=i.getRootNode();a=u instanceof ShadowRoot?u.host:i}this.targetChangeHandlerKeys_=[X(a,N,this.handleBrowserEvent,this),X(a,z,this.handleBrowserEvent,this)];var s=i.getRootNode();s instanceof ShadowRoot&&this.resizeObserver_.observe(s.host),this.resizeObserver_.observe(i)}else this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);this.updateSize()}},{key:"handleTileChange_",value:function(){this.render()}},{key:"handleViewPropertyChanged_",value:function(){this.render()}},{key:"handleViewChanged_",value:function(){this.viewPropertyListenerKey_&&(K(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(K(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);var t=this.getView();t&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=X(t,l,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=X(t,M,this.handleViewPropertyChanged_,this),t.resolveConstraints(0)),this.render()}},{key:"handleLayerGroupChanged_",value:function(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(K),this.layerGroupPropertyListenerKeys_=null);var t=this.getLayerGroup();t&&(this.handleLayerAdd_(new Ac("addlayer",t)),this.layerGroupPropertyListenerKeys_=[X(t,l,this.render,this),X(t,M,this.render,this),X(t,"addlayer",this.handleLayerAdd_,this),X(t,"removelayer",this.handleLayerRemove_,this)]),this.render()}},{key:"isRendered",value:function(){return!!this.frameState_}},{key:"animationDelay_",value:function(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}},{key:"renderSync",value:function(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}},{key:"redrawText",value:function(){for(var t=this.getLayerGroup().getLayerStatesArray(),e=0,n=t.length;e<n;++e){var r=t[e].layer;r.hasRenderer()&&r.getRenderer().handleFontsChanged()}}},{key:"render",value:function(){this.renderer_&&void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}},{key:"removeControl",value:function(t){return this.getControls().remove(t)}},{key:"removeInteraction",value:function(t){return this.getInteractions().remove(t)}},{key:"removeLayer",value:function(t){return this.getLayerGroup().getLayers().remove(t)}},{key:"handleLayerRemove_",value:function(t){Bp(t.layer)}},{key:"removeOverlay",value:function(t){return this.getOverlays().remove(t)}},{key:"renderFrame_",value:function(t){var e=this,n=this.getSize(),r=this.getView(),i=this.frameState_,o=null;if(void 0!==n&&mo(n)&&r&&r.isDef()){var a=r.getHints(this.frameState_?this.frameState_.viewHints:void 0),u=r.getState();if(o={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:Pe(u.center,u.resolution,u.rotation,n),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:n,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:u,viewHints:a,wantedTiles:{},mapId:nt(this),renderTargets:{}},u.nextCenter&&u.nextResolution){var s=isNaN(u.nextRotation)?u.rotation:u.nextRotation;o.nextExtent=Pe(u.nextCenter,u.nextResolution,s,n)}}if(this.frameState_=o,this.renderer_.renderFrame(o),o){if(o.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,o.postRenderFunctions),i)(!this.previousExtent_||!Me(this.previousExtent_)&&!ve(o.extent,this.previousExtent_))&&(this.dispatchEvent(new Yc(df,this,i)),this.previousExtent_=ye(this.previousExtent_));this.previousExtent_&&!o.viewHints[pt]&&!o.viewHints[dt]&&!ve(o.extent,this.previousExtent_)&&(this.dispatchEvent(new Yc(vf,this,o)),oe(o.extent,this.previousExtent_))}this.dispatchEvent(new Yc(pf,this,o)),this.renderComplete_=(this.hasListener(gf)||this.hasListener(mf)||this.hasListener(to))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout((function(){e.postRenderTimeoutHandle_=void 0,e.handlePostRender()}),0))}},{key:"setLayerGroup",value:function(t){var e=this.getLayerGroup();e&&this.handleLayerRemove_(new Ac("removelayer",e)),this.set(bf,t)}},{key:"setSize",value:function(t){this.set(_f,t)}},{key:"setTarget",value:function(t){this.set(wf,t)}},{key:"setView",value:function(t){if(!t||t instanceof vi)this.set(Sf,t);else{this.set(Sf,new vi);var e=this;t.then((function(t){e.setView(new vi(t))}))}}},{key:"updateSize",value:function(){var t=this.getTargetElement(),e=void 0;if(t){var n=getComputedStyle(t),r=t.offsetWidth-parseFloat(n.borderLeftWidth)-parseFloat(n.paddingLeft)-parseFloat(n.paddingRight)-parseFloat(n.borderRightWidth),i=t.offsetHeight-parseFloat(n.borderTopWidth)-parseFloat(n.paddingTop)-parseFloat(n.paddingBottom)-parseFloat(n.borderBottomWidth);isNaN(r)||isNaN(i)||!mo(e=[Math.max(0,r),Math.max(0,i)])&&(t.offsetWidth||t.offsetHeight||t.getClientRects().length)&&Qe("No map visible because the map container's width or height are 0.")}var o=this.getSize();!e||o&&m(e,o)||(this.setSize(e),this.updateViewportSize_(e))}},{key:"updateViewportSize_",value:function(t){var e=this.getView();e&&e.setViewportSize(t)}}])}(yt),Wp="preload",Xp="useInterimTilesOnError";function Yp(t){return(Yp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Kp(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Zp(r.key),r)}}function Zp(t){var e=function(t,e){if("object"!=Yp(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Yp(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Yp(e)?e:e+""}function Up(t,e,n){return e=Hp(e),function(t,e){if(e&&("object"==Yp(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],Hp(t).constructor):e.apply(t,n))}function Vp(){return(Vp="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=qp(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}}).apply(null,arguments)}function qp(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=Hp(t)););return t}function Hp(t){return(Hp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Jp(t,e){return(Jp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var $p=function(t){function e(t){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t=t||{};var r=Object.assign({},t),i=t.cacheSize;return delete t.cacheSize,delete r.preload,delete r.useInterimTilesOnError,(n=Up(this,e,[r])).on,n.once,n.un,n.cacheSize_=i,n.setPreload(void 0!==t.preload?t.preload:0),n.setUseInterimTilesOnError(void 0===t.useInterimTilesOnError||t.useInterimTilesOnError),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Jp(t,e)}(e,t),function(t,e,n){return e&&Kp(t.prototype,e),n&&Kp(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(e,[{key:"getCacheSize",value:function(){return this.cacheSize_}},{key:"getPreload",value:function(){return this.get(Wp)}},{key:"setPreload",value:function(t){this.set(Wp,t)}},{key:"getUseInterimTilesOnError",value:function(){return this.get(Xp)}},{key:"setUseInterimTilesOnError",value:function(t){this.set(Xp,t)}},{key:"getData",value:function(t){return(n=e,r="getData",i=this,a=Vp(Hp(1&(o=3)?n.prototype:n),r,i),2&o&&"function"==typeof a?function(t){return a.apply(i,t)}:a)([t]);var n,r,i,o,a}}])}(co);function Qp(t){return(Qp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function td(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ed(r.key),r)}}function ed(t){var e=function(t,e){if("object"!=Qp(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Qp(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Qp(e)?e:e+""}function nd(t,e,n){return e=od(e),function(t,e){if(e&&("object"==Qp(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],od(t).constructor):e.apply(t,n))}function rd(){return(rd="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=id(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}}).apply(null,arguments)}function id(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=od(t)););return t}function od(t){return(od=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ad(t,e){return(ad=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var ud=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=nd(this,e)).ready=!0,n.boundHandleImageChange_=n.handleImageChange_.bind(n),n.layer_=t,n.staleKeys_=new Array,n.maxStaleKeys=5,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ad(t,e)}(e,t),function(t,e,n){return e&&td(t.prototype,e),n&&td(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(e,[{key:"getStaleKeys",value:function(){return this.staleKeys_}},{key:"prependStaleKey",value:function(t){this.staleKeys_.unshift(t),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}},{key:"getFeatures",value:function(t){return tt()}},{key:"getData",value:function(t){return null}},{key:"prepareFrame",value:function(t){return tt()}},{key:"renderFrame",value:function(t,e){return tt()}},{key:"forEachFeatureAtCoordinate",value:function(t,e,n,r,i){}},{key:"getLayer",value:function(){return this.layer_}},{key:"handleFontsChanged",value:function(){}},{key:"handleImageChange_",value:function(t){var e=t.target;e.getState()!==vo&&e.getState()!==go||this.renderIfReadyAndVisible()}},{key:"loadImage",value:function(t){var e=t.getState();return e!=vo&&e!=go&&t.addEventListener(M,this.boundHandleImageChange_),e==yo&&(t.load(),e=t.getState()),e==vo}},{key:"renderIfReadyAndVisible",value:function(){var t=this.getLayer();t&&t.getVisible()&&"ready"===t.getSourceState()&&t.changed()}},{key:"renderDeferred",value:function(t){}},{key:"disposeInternal",value:function(){var t,n,r,i,o;delete this.layer_,(t=e,n="disposeInternal",r=this,o=rd(od(1&(i=3)?t.prototype:t),n,r),2&i&&"function"==typeof o?function(t){return o.apply(r,t)}:o)([])}}])}(Q);function sd(t){return(sd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ld(t){return function(t){if(Array.isArray(t))return cd(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return cd(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?cd(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function cd(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function fd(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,hd(r.key),r)}}function hd(t){var e=function(t,e){if("object"!=sd(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=sd(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==sd(e)?e:e+""}var yd=function(){return function(t,e,n){return e&&fd(t.prototype,e),n&&fd(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}((function t(){var e,n,r,i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=this,r=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return i.instructions_[i.zIndex+i.offset_].push(e),i},(n=hd(n="pushMethodArgs_"))in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(ea(),{get:function(t,e){if("function"==typeof ea()[e])return i.instructions_[i.zIndex+i.offset_]||(i.instructions_[i.zIndex+i.offset_]=[]),i.instructions_[i.zIndex+i.offset_].push(e),i.pushMethodArgs_},set:function(t,e,n){return i.instructions_[i.zIndex+i.offset_]||(i.instructions_[i.zIndex+i.offset_]=[]),i.instructions_[i.zIndex+i.offset_].push(e,n),!0}})}),[{key:"pushFunction",value:function(t){this.instructions_[this.zIndex+this.offset_].push(t)}},{key:"getContext",value:function(){return this.context_}},{key:"draw",value:function(t){this.instructions_.forEach((function(e){for(var n=0,r=e.length;n<r;++n){var i=e[n];if("function"!=typeof i){var o=e[++n];if("function"==typeof t[i])t[i].apply(t,ld(o));else{if("function"==typeof o){t[i]=o(t);continue}t[i]=o}}else i(t)}}))}},{key:"clear",value:function(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}},{key:"offset",value:function(){this.offset_=this.instructions_.length,this.zIndex=0}}])}();function pd(t){return(pd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function dd(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,vd(r.key),r)}}function vd(t){var e=function(t,e){if("object"!=pd(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=pd(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==pd(e)?e:e+""}function gd(t,e,n){return e=_d(e),function(t,e){if(e&&("object"==pd(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],_d(t).constructor):e.apply(t,n))}function md(){return(md="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=bd(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}}).apply(null,arguments)}function bd(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=_d(t)););return t}function _d(t){return(_d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function wd(t,e){return(wd=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Sd=[],xd=null;var Od=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=gd(this,e,[t])).container=null,n.renderedResolution,n.tempTransform=[1,0,0,1,0,0],n.pixelTransform=[1,0,0,1,0,0],n.inversePixelTransform=[1,0,0,1,0,0],n.context=null,n.deferredContext_=null,n.containerReused=!1,n.frameState=null,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&wd(t,e)}(e,t),function(t,e,n){return e&&dd(t.prototype,e),n&&dd(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(e,[{key:"getImageData",value:function(t,e,n){var r;xd||(xd=ta(1,1,void 0,{willReadFrequently:!0})),xd.clearRect(0,0,1,1);try{xd.drawImage(t,e,n,1,1,0,0,1,1),r=xd.getImageData(0,0,1,1).data}catch(t){return xd=null,null}return r}},{key:"getBackground",value:function(t){var e=this.getLayer().getBackground();return"function"==typeof e&&(e=e(t.viewState.resolution)),e||void 0}},{key:"useContainer",value:function(t,e,n){var r,i,o=this.getLayer().getClassName();if(t&&t.className===o&&(!n||t&&t.style.backgroundColor&&m(Wo(t.style.backgroundColor),Wo(n)))){var a=t.firstElementChild;a instanceof HTMLCanvasElement&&(i=a.getContext("2d"))}if(i&&i.canvas.style.transform===e?(this.container=t,this.context=i,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){(r=document.createElement("div")).className=o;var u=r.style;u.position="absolute",u.width="100%",u.height="100%";var s=(i=ta()).canvas;r.appendChild(s),(u=s.style).position="absolute",u.left="0",u.transformOrigin="top left",this.container=r,this.context=i}this.containerReused||!n||this.container.style.backgroundColor||(this.container.style.backgroundColor=n)}},{key:"clipUnrotated",value:function(t,e,n){var r=Ce(n),i=Te(n),o=xe(n),a=Se(n);zn(e.coordinateToPixelTransform,r),zn(e.coordinateToPixelTransform,i),zn(e.coordinateToPixelTransform,o),zn(e.coordinateToPixelTransform,a);var u=this.inversePixelTransform;zn(u,r),zn(u,i),zn(u,o),zn(u,a),t.save(),t.beginPath(),t.moveTo(Math.round(r[0]),Math.round(r[1])),t.lineTo(Math.round(i[0]),Math.round(i[1])),t.lineTo(Math.round(o[0]),Math.round(o[1])),t.lineTo(Math.round(a[0]),Math.round(a[1])),t.clip()}},{key:"prepareContainer",value:function(t,e){var n=t.extent,r=t.viewState.resolution,i=t.viewState.rotation,o=t.pixelRatio,a=Math.round(Re(n)/r*o),u=Math.round(Ee(n)/r*o);Bn(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/o,1/o,i,-a/2,-u/2),Gn(this.inversePixelTransform,this.pixelTransform);var s=Xn(this.pixelTransform);if(this.useContainer(e,s,this.getBackground(t)),!this.containerReused){var l=this.context.canvas;l.width!=a||l.height!=u?(l.width=a,l.height=u):this.context.clearRect(0,0,a,u),s!==l.style.transform&&(l.style.transform=s)}}},{key:"dispatchRenderEvent_",value:function(t,e,n){var r=this.getLayer();if(r.hasListener(t)){var i=new vc(t,this.inversePixelTransform,n,e);r.dispatchEvent(i)}}},{key:"preRender",value:function(t,e){this.frameState=e,e.declutter||this.dispatchRenderEvent_(Hi,t,e)}},{key:"postRender",value:function(t,e){e.declutter||this.dispatchRenderEvent_(Ji,t,e)}},{key:"renderDeferredInternal",value:function(t){}},{key:"getRenderContext",value:function(t){return t.declutter&&!this.deferredContext_&&(this.deferredContext_=new yd),t.declutter?this.deferredContext_.getContext():this.context}},{key:"renderDeferred",value:function(t){t.declutter&&(this.dispatchRenderEvent_(Hi,this.context,t),t.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(t),this.dispatchRenderEvent_(Ji,this.context,t))}},{key:"getRenderTransform",value:function(t,e,n,r,i,o,a){var u=i/2,s=o/2,l=r/e,c=-l,f=-t[0]+a,h=-t[1];return Bn(this.tempTransform,u,s,l,c,-n,f,h)}},{key:"disposeInternal",value:function(){var t,n,r,i,o;delete this.frameState,(t=e,n="disposeInternal",r=this,o=md(_d(1&(i=3)?t.prototype:t),n,r),2&i&&"function"==typeof o?function(t){return o.apply(r,t)}:o)([])}}])}(ud);function kd(t){return(kd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Pd(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ed(r.key),r)}}function Ed(t){var e=function(t,e){if("object"!=kd(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=kd(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==kd(e)?e:e+""}function jd(t,e,n){return e=Cd(e),function(t,e){if(e&&("object"==kd(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],Cd(t).constructor):e.apply(t,n))}function Cd(t){return(Cd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Td(t,e){return(Td=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Rd=function(t){function e(t,n,r){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=r||{},(i=jd(this,e)).tileCoord=t,i.state=n,i.key="",i.transition_=void 0===r.transition?250:r.transition,i.transitionStarts_={},i.interpolate=!!r.interpolate,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Td(t,e)}(e,t),n=e,(r=[{key:"changed",value:function(){this.dispatchEvent(M)}},{key:"release",value:function(){this.state===Cf&&this.setState(Tf)}},{key:"getKey",value:function(){return this.key+"/"+this.tileCoord}},{key:"getTileCoord",value:function(){return this.tileCoord}},{key:"getState",value:function(){return this.state}},{key:"setState",value:function(t){if(this.state!==Cf&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()}},{key:"load",value:function(){tt()}},{key:"getAlpha",value:function(t,e){if(!this.transition_)return 1;var n=this.transitionStarts_[t];if(n){if(-1===n)return 1}else n=e,this.transitionStarts_[t]=n;var r=e-n+1e3/60;return r>=this.transition_?1:An(r/this.transition_)}},{key:"inTransition",value:function(t){return!!this.transition_&&-1!==this.transitionStarts_[t]}},{key:"endTransition",value:function(t){this.transition_&&(this.transitionStarts_[t]=-1)}}])&&Pd(n.prototype,r),i&&Pd(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(I);function Id(t){return(Id="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Md(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ld(r.key),r)}}function Ld(t){var e=function(t,e){if("object"!=Id(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Id(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Id(e)?e:e+""}function Ad(t,e,n){return e=Nd(e),function(t,e){if(e&&("object"==Id(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],Nd(t).constructor):e.apply(t,n))}function Fd(){return(Fd="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=Dd(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}}).apply(null,arguments)}function Dd(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=Nd(t)););return t}function Nd(t){return(Nd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function zd(t,e){return(zd=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Bd(t){return t instanceof Image||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageBitmap?t:null}var Gd=new Error("disposed"),Wd=null;var Xd=[256,256],Yd=function(t){function e(t){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=Pf;return(n=Ad(this,e,[t.tileCoord,r,{transition:t.transition,interpolate:t.interpolate}])).loader_=t.loader,n.data_=null,n.error_=null,n.size_=t.size||null,n.controller_=t.controller||null,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&zd(t,e)}(e,t),function(t,e,n){return e&&Md(t.prototype,e),n&&Md(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(e,[{key:"getSize",value:function(){if(this.size_)return this.size_;var t=Bd(this.data_);return t?[t.width,t.height]:Xd}},{key:"getData",value:function(){return this.data_}},{key:"getError",value:function(){return this.error_}},{key:"load",value:function(){if(this.state===Pf||this.state===Cf){this.state=Ef,this.changed();var t=this;this.loader_().then((function(e){t.data_=e,t.state=jf,t.changed()})).catch((function(e){t.error_=e,t.state=Cf,t.changed()}))}}},{key:"disposeInternal",value:function(){var t,n,r,i,o;this.controller_&&(this.controller_.abort(Gd),this.controller_=null),(t=e,n="disposeInternal",r=this,o=Fd(Nd(1&(i=3)?t.prototype:t),n,r),2&i&&"function"==typeof o?function(t){return o.apply(r,t)}:o)([])}}])}(Rd);function Kd(t){return(Kd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zd(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ud(r.key),r)}}function Ud(t){var e=function(t,e){if("object"!=Kd(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Kd(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Kd(e)?e:e+""}function Vd(t,e,n){return e=qd(e),function(t,e){if(e&&("object"==Kd(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],qd(t).constructor):e.apply(t,n))}function qd(t){return(qd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Hd(t,e){return(Hd=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Jd=function(t){function e(t,n,r,i,o,a){var u;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(u=Vd(this,e,[t,n,a])).crossOrigin_=i,u.src_=r,u.key=r,u.image_=new Image,null!==i&&(u.image_.crossOrigin=i),u.unlisten_=null,u.tileLoadFunction_=o,u}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Hd(t,e)}(e,t),n=e,(r=[{key:"getImage",value:function(){return this.image_}},{key:"setImage",value:function(t){this.image_=t,this.state=jf,this.unlistenImage_(),this.changed()}},{key:"handleImageError_",value:function(){var t;this.state=Cf,this.unlistenImage_(),this.image_=((t=ta(1,1)).fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas),this.changed()}},{key:"handleImageLoad_",value:function(){var t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=jf:this.state=Tf,this.unlistenImage_(),this.changed()}},{key:"load",value:function(){var t,e,n,r,i,o,a,u;this.state==Cf&&(this.state=Pf,this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==Pf&&(this.state=Ef,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=(t=this.image_,e=this.handleImageLoad_.bind(this),n=this.handleImageError_.bind(this),i=!0,o=!1,a=!1,u=[Y(r=t,B,(function(){a=!0,o||e()}))],r.src&&$o?(o=!0,r.decode().then((function(){i&&e()})).catch((function(t){i&&(a?e():n())}))):u.push(Y(r,L,n)),function(){i=!1,u.forEach(K)}))}},{key:"unlistenImage_",value:function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}}])&&Zd(n.prototype,r),i&&Zd(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(Rd);function $d(t){return($d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Qd(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,tv(r.key),r)}}function tv(t){var e=function(t,e){if("object"!=$d(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=$d(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==$d(e)?e:e+""}var ev=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.highWaterMark=void 0!==e?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null},(e=[{key:"canExpireCache",value:function(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}},{key:"expireCache",value:function(t){for(;this.canExpireCache();)this.pop()}},{key:"clear",value:function(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}},{key:"containsKey",value:function(t){return this.entries_.hasOwnProperty(t)}},{key:"forEach",value:function(t){for(var e=this.oldest_;e;)t(e.value_,e.key_,this),e=e.newer}},{key:"get",value:function(t,e){var n=this.entries_[t];return En(void 0!==n,"Tried to get a value for a key that does not exist in the cache"),n===this.newest_||(n===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(n.newer.older=n.older,n.older.newer=n.newer),n.newer=null,n.older=this.newest_,this.newest_.newer=n,this.newest_=n),n.value_}},{key:"remove",value:function(t){var e=this.entries_[t];return En(void 0!==e,"Tried to get a value for a key that does not exist in the cache"),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_}},{key:"getCount",value:function(){return this.count_}},{key:"getKeys",value:function(){var t,e=new Array(this.count_),n=0;for(t=this.newest_;t;t=t.older)e[n++]=t.key_;return e}},{key:"getValues",value:function(){var t,e=new Array(this.count_),n=0;for(t=this.newest_;t;t=t.older)e[n++]=t.value_;return e}},{key:"peekLast",value:function(){return this.oldest_.value_}},{key:"peekLastKey",value:function(){return this.oldest_.key_}},{key:"peekFirstKey",value:function(){return this.newest_.key_}},{key:"peek",value:function(t){var e;return null===(e=this.entries_[t])||void 0===e?void 0:e.value_}},{key:"pop",value:function(){var t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_}},{key:"replace",value:function(t,e){this.get(t),this.entries_[t].value_=e}},{key:"set",value:function(t,e){En(!(t in this.entries_),"Tried to set a value for a key that is used already");var n={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=n:this.oldest_=n,this.newest_=n,this.entries_[t]=n,++this.count_}},{key:"setSize",value:function(t){this.highWaterMark=t}}])&&Qd(t.prototype,e),n&&Qd(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}();function nv(t){return(nv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function rv(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,iv(r.key),r)}}function iv(t){var e=function(t,e){if("object"!=nv(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=nv(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==nv(e)?e:e+""}var ov,av=function(){return t=function t(e,n,r,i,o,a){var u=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sourceProj_=e,this.targetProj_=n;var s={},l=pn(this.targetProj_,this.sourceProj_);this.transformInv_=function(t){var e=t[0]+"/"+t[1];return s[e]||(s[e]=l(t)),s[e]},this.maxSourceExtent_=i,this.errorThresholdSquared_=o*o,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!i&&!!this.sourceProj_.getExtent()&&Re(i)>=Re(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?Re(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?Re(this.targetProj_.getExtent()):null;var c=Ce(r),f=Te(r),h=xe(r),y=Se(r),p=this.transformInv_(c),d=this.transformInv_(f),v=this.transformInv_(h),g=this.transformInv_(y),m=10+(a?Math.max(0,Math.ceil(Math.log2(we(r)/(a*a*256*256)))):0);if(this.addQuad_(c,f,h,y,p,d,v,g,m),this.wrapsXInSource_){var b=1/0;this.triangles_.forEach((function(t,e,n){b=Math.min(b,t.source[0][0],t.source[1][0],t.source[2][0])})),this.triangles_.forEach((function(t){if(Math.max(t.source[0][0],t.source[1][0],t.source[2][0])-b>u.sourceWorldWidth_/2){var e=[[t.source[0][0],t.source[0][1]],[t.source[1][0],t.source[1][1]],[t.source[2][0],t.source[2][1]]];e[0][0]-b>u.sourceWorldWidth_/2&&(e[0][0]-=u.sourceWorldWidth_),e[1][0]-b>u.sourceWorldWidth_/2&&(e[1][0]-=u.sourceWorldWidth_),e[2][0]-b>u.sourceWorldWidth_/2&&(e[2][0]-=u.sourceWorldWidth_);var n=Math.min(e[0][0],e[1][0],e[2][0]);Math.max(e[0][0],e[1][0],e[2][0])-n<u.sourceWorldWidth_/2&&(t.source=e)}}))}s={}},(e=[{key:"addTriangle_",value:function(t,e,n,r,i,o){this.triangles_.push({source:[r,i,o],target:[t,e,n]})}},{key:"addQuad_",value:function(t,e,n,r,i,o,a,u,s){var l=re([i,o,a,u]),c=this.sourceWorldWidth_?Re(l)/this.sourceWorldWidth_:null,f=this.sourceWorldWidth_,h=this.sourceProj_.canWrapX()&&c>.5&&c<1,y=!1;if(s>0&&(this.targetProj_.isGlobal()&&this.targetWorldWidth_&&(y=Re(re([t,e,n,r]))/this.targetWorldWidth_>.25||y),!h&&this.sourceProj_.isGlobal()&&c&&(y=c>.25||y)),!(!y&&this.maxSourceExtent_&&isFinite(l[0])&&isFinite(l[1])&&isFinite(l[2])&&isFinite(l[3]))||Ie(l,this.maxSourceExtent_)){var p=0;if(!(y||isFinite(i[0])&&isFinite(i[1])&&isFinite(o[0])&&isFinite(o[1])&&isFinite(a[0])&&isFinite(a[1])&&isFinite(u[0])&&isFinite(u[1])))if(s>0)y=!0;else if(1!=(p=(isFinite(i[0])&&isFinite(i[1])?0:8)+(isFinite(o[0])&&isFinite(o[1])?0:4)+(isFinite(a[0])&&isFinite(a[1])?0:2)+(isFinite(u[0])&&isFinite(u[1])?0:1))&&2!=p&&4!=p&&8!=p)return;if(s>0){if(!y){var d,v=[(t[0]+n[0])/2,(t[1]+n[1])/2],g=this.transformInv_(v);d=h?(Ge(i[0],f)+Ge(a[0],f))/2-Ge(g[0],f):(i[0]+a[0])/2-g[0];var m=(i[1]+a[1])/2-g[1];y=d*d+m*m>this.errorThresholdSquared_}if(y){if(Math.abs(t[0]-n[0])<=Math.abs(t[1]-n[1])){var b=[(e[0]+n[0])/2,(e[1]+n[1])/2],_=this.transformInv_(b),w=[(r[0]+t[0])/2,(r[1]+t[1])/2],S=this.transformInv_(w);this.addQuad_(t,e,b,w,i,o,_,S,s-1),this.addQuad_(w,b,n,r,S,_,a,u,s-1)}else{var x=[(t[0]+e[0])/2,(t[1]+e[1])/2],O=this.transformInv_(x),k=[(n[0]+r[0])/2,(n[1]+r[1])/2],P=this.transformInv_(k);this.addQuad_(t,x,k,r,i,O,P,u,s-1),this.addQuad_(x,e,n,k,O,o,a,P,s-1)}return}}if(h){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}0==(11&p)&&this.addTriangle_(t,n,r,i,a,u),0==(14&p)&&this.addTriangle_(t,n,e,i,a,o),p&&(0==(13&p)&&this.addTriangle_(e,r,t,o,u,i),0==(7&p)&&this.addTriangle_(e,r,n,o,u,a))}}},{key:"calculateSourceExtent",value:function(){var t=[1/0,1/0,-1/0,-1/0];return this.triangles_.forEach((function(e,n,r){var i=e.source;ge(t,i[0]),ge(t,i[1]),ge(t,i[2])})),t}},{key:"getTriangles",value:function(){return this.triangles_}}])&&rv(t.prototype,e),n&&rv(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}(),uv=[];function sv(t,e,n,r,i){t.beginPath(),t.moveTo(0,0),t.lineTo(e,n),t.lineTo(r,i),t.closePath(),t.save(),t.clip(),t.fillRect(0,0,Math.max(e,r)+1,Math.max(n,i)),t.restore()}function lv(t,e){return Math.abs(t[4*e]-210)>2||Math.abs(t[4*e+3]-191.25)>2}function cv(t,e,n,r){var i=dn(n,e,t),o=un(e,r,n),a=e.getMetersPerUnit();void 0!==a&&(o*=a);var u=t.getMetersPerUnit();void 0!==u&&(o/=u);var s=t.getExtent();if(!s||ue(s,i)){var l=un(t,o,i)/o;isFinite(l)&&l>0&&(o/=l)}return o}function fv(t,e,n,r){var i=Oe(n),o=cv(t,e,i,r);return(!isFinite(o)||o<=0)&&_e(n,(function(n){return o=cv(t,e,n,r),isFinite(o)&&o>0})),o}function hv(t,e,n,r,i,o,a,u,s,l,c,f,h,y){var p=ta(Math.round(n*t),Math.round(n*e),uv);if(f||(p.imageSmoothingEnabled=!1),0===s.length)return p.canvas;function d(t){return Math.round(t*n)/n}p.scale(n,n),p.globalCompositeOperation="lighter";var v,g=[1/0,1/0,-1/0,-1/0];s.forEach((function(t,e,n){var r,i;r=g,(i=t.extent)[0]<r[0]&&(r[0]=i[0]),i[2]>r[2]&&(r[2]=i[2]),i[1]<r[1]&&(r[1]=i[1]),i[3]>r[3]&&(r[3]=i[3])}));var m=n/r,b=(f?1:1+Math.pow(2,-24))/m;if(!h||1!==s.length||0!==l){if(v=ta(Math.round(Re(g)*m),Math.round(Ee(g)*m),uv),f||(v.imageSmoothingEnabled=!1),i&&y){var _=(i[0]-g[0])*m,w=-(i[3]-g[3])*m,S=Re(i)*m,x=Ee(i)*m;v.rect(_,w,S,x),v.clip()}s.forEach((function(t,e,n){if(t.image.width>0&&t.image.height>0){if(t.clipExtent){v.save();var r=(t.clipExtent[0]-g[0])*m,i=-(t.clipExtent[3]-g[3])*m,o=Re(t.clipExtent)*m,a=Ee(t.clipExtent)*m;v.rect(f?r:Math.round(r),f?i:Math.round(i),f?o:Math.round(r+o)-Math.round(r),f?a:Math.round(i+a)-Math.round(i)),v.clip()}var u=(t.extent[0]-g[0])*m,s=-(t.extent[3]-g[3])*m,c=Re(t.extent)*m,h=Ee(t.extent)*m;v.drawImage(t.image,l,l,t.image.width-2*l,t.image.height-2*l,f?u:Math.round(u),f?s:Math.round(s),f?c:Math.round(u+c)-Math.round(u),f?h:Math.round(s+h)-Math.round(s)),t.clipExtent&&v.restore()}}))}var O=Ce(a);return u.getTriangles().forEach((function(t,e,n){var r=t.source,i=t.target,a=r[0][0],u=r[0][1],l=r[1][0],c=r[1][1],h=r[2][0],y=r[2][1],m=d((i[0][0]-O[0])/o),_=d(-(i[0][1]-O[1])/o),w=d((i[1][0]-O[0])/o),S=d(-(i[1][1]-O[1])/o),x=d((i[2][0]-O[0])/o),k=d(-(i[2][1]-O[1])/o),P=a,E=u;a=0,u=0;var j=function(t){for(var e=t.length,n=0;n<e;n++){for(var r=n,i=Math.abs(t[n][n]),o=n+1;o<e;o++){var a=Math.abs(t[o][n]);a>i&&(i=a,r=o)}if(0===i)return null;var u=t[r];t[r]=t[n],t[n]=u;for(var s=n+1;s<e;s++)for(var l=-t[s][n]/t[n][n],c=n;c<e+1;c++)n==c?t[s][c]=0:t[s][c]+=l*t[n][c]}for(var f=new Array(e),h=e-1;h>=0;h--){f[h]=t[h][e]/t[h][h];for(var y=h-1;y>=0;y--)t[y][e]-=t[y][h]*f[h]}return f}([[l-=P,c-=E,0,0,w-m],[h-=P,y-=E,0,0,x-m],[0,0,l,c,S-_],[0,0,h,y,k-_]]);if(j){if(p.save(),p.beginPath(),function(){if(void 0===ov){var t=ta(6,6,uv);t.globalCompositeOperation="lighter",t.fillStyle="rgba(210, 0, 0, 0.75)",sv(t,4,5,4,0),sv(t,4,5,0,5);var e=t.getImageData(0,0,3,3).data;ov=lv(e,0)||lv(e,4)||lv(e,8),na(t),uv.push(t.canvas)}return ov}()||!f){p.moveTo(w,S);for(var C=m-w,T=_-S,R=0;R<4;R++)p.lineTo(w+d((R+1)*C/4),S+d(R*T/3)),3!=R&&p.lineTo(w+d((R+1)*C/4),S+d((R+1)*T/3));p.lineTo(x,k)}else p.moveTo(w,S),p.lineTo(m,_),p.lineTo(x,k);var I;if(p.clip(),p.transform(j[0],j[2],j[1],j[3],m,_),p.translate(g[0]-P,g[3]-E),v)I=v.canvas,p.scale(b,-b);else{var M=s[0],L=M.extent;I=M.image,p.scale(Re(L)/I.width,-Ee(L)/I.height)}p.drawImage(I,0,0),p.restore()}})),v&&(na(v),uv.push(v.canvas)),c&&(p.save(),p.globalCompositeOperation="source-over",p.strokeStyle="black",p.lineWidth=1,u.getTriangles().forEach((function(t,e,n){var r=t.target,i=(r[0][0]-O[0])/o,a=-(r[0][1]-O[1])/o,u=(r[1][0]-O[0])/o,s=-(r[1][1]-O[1])/o,l=(r[2][0]-O[0])/o,c=-(r[2][1]-O[1])/o;p.beginPath(),p.moveTo(u,s),p.lineTo(i,a),p.lineTo(l,c),p.closePath(),p.stroke()})),p.restore()),p.canvas}function yv(t){return(yv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pv(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,dv(r.key),r)}}function dv(t){var e=function(t,e){if("object"!=yv(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=yv(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==yv(e)?e:e+""}function vv(t,e,n){return e=mv(e),gv(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],mv(t).constructor):e.apply(t,n))}function gv(t,e){if(e&&("object"==yv(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function mv(t){return(mv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function bv(t,e){return(bv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var _v=function(t){function e(t){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=vv(this,e,[{tileCoord:t.tileCoord,loader:function(){return Promise.resolve(new Uint8ClampedArray(4))},interpolate:t.interpolate,transition:t.transition}])).pixelRatio_=t.pixelRatio,n.gutter_=t.gutter,n.reprojData_=null,n.reprojError_=null,n.reprojSize_=void 0,n.sourceTileGrid_=t.sourceTileGrid,n.targetTileGrid_=t.targetTileGrid,n.wrappedTileCoord_=t.wrappedTileCoord||t.tileCoord,n.sourceTiles_=[],n.sourcesListenerKeys_=null,n.sourceZ_=0;var r=t.sourceProj,i=r.getExtent(),o=t.sourceTileGrid.getExtent();n.clipExtent_=r.canWrapX()?o?je(i,o):i:o;var a=n.targetTileGrid_.getTileCoordExtent(n.wrappedTileCoord_),u=n.targetTileGrid_.getExtent(),s=n.sourceTileGrid_.getExtent(),l=u?je(a,u):a;if(0===we(l))return n.state=Tf,gv(n);i&&(s=s?je(s,i):i);var c=n.targetTileGrid_.getResolution(n.wrappedTileCoord_[0]),f=t.targetProj,h=fv(r,f,l,c);if(!isFinite(h)||h<=0)return n.state=Tf,gv(n);var y=void 0!==t.errorThreshold?t.errorThreshold:.5;if(n.triangulation_=new av(r,f,l,s,h*y,c),0===n.triangulation_.getTriangles().length)return n.state=Tf,gv(n);n.sourceZ_=n.sourceTileGrid_.getZForResolution(h);var p=n.triangulation_.calculateSourceExtent();if(s&&(r.canWrapX()?(p[1]=De(p[1],s[1],s[3]),p[3]=De(p[3],s[1],s[3])):p=je(p,s)),we(p)){var d=0,v=0;r.canWrapX()&&(d=Re(i),v=Math.floor((p[0]-i[0])/d)),Fe(p.slice(),r,!0).forEach((function(e){for(var r=n.sourceTileGrid_.getTileRangeForExtentAndZ(e,n.sourceZ_),i=t.getTileFunction,o=r.minX;o<=r.maxX;o++)for(var a=r.minY;a<=r.maxY;a++){var u=i(n.sourceZ_,o,a,n.pixelRatio_);if(u){var s=v*d;n.sourceTiles_.push({tile:u,offset:s})}}++v})),0===n.sourceTiles_.length&&(n.state=Tf)}else n.state=Tf;return n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&bv(t,e)}(e,t),n=e,(r=[{key:"getSize",value:function(){return this.reprojSize_}},{key:"getData",value:function(){return this.reprojData_}},{key:"getError",value:function(){return this.reprojError_}},{key:"reproject_",value:function(){var t=this,e=[],n=!1;if(this.sourceTiles_.forEach((function(r){var i,o=r.tile;if(o&&o.getState()===jf){var a,u=o.getSize(),s=t.gutter_,l=function(t){return t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Float32Array||t instanceof DataView?t:null}(o.getData());l?a=l:(n=!0,a=function(t){Wd||(Wd=ta(t.width,t.height,void 0,{willReadFrequently:!0}));var e=Wd.canvas,n=t.width;e.width!==n&&(e.width=n);var r=t.height;return e.height!==r&&(e.height=r),Wd.clearRect(0,0,n,r),Wd.drawImage(t,0,0),Wd.getImageData(0,0,n,r).data}(Bd(o.getData())));var c=[u[0]+2*s,u[1]+2*s],f=a instanceof Float32Array,h=c[0]*c[1],y=f?Float32Array:Uint8ClampedArray,p=new y(a.buffer),d=y.BYTES_PER_ELEMENT,v=d*p.length/h,g=p.byteLength/c[1],m=Math.floor(g/d/c[0]),b=h*m,_=p;if(p.length!==b){_=new y(b);for(var w=0,S=0,x=c[0]*m,O=0;O<c[1];++O){for(var k=0;k<x;++k)_[w++]=p[S+k];S+=g/d}}var P=t.sourceTileGrid_.getTileCoordExtent(o.tileCoord);P[0]+=r.offset,P[2]+=r.offset;var E=null===(i=t.clipExtent_)||void 0===i?void 0:i.slice();E&&(E[0]+=r.offset,E[2]+=r.offset),e.push({extent:P,clipExtent:E,data:new Uint8ClampedArray(_.buffer),dataType:y,bytesPerPixel:v,pixelSize:c})}})),this.sourceTiles_.length=0,0===e.length)return this.state=Cf,void this.changed();for(var r,i,o=this.wrappedTileCoord_[0],a=this.targetTileGrid_.getTileSize(o),u="number"==typeof a?a:a[0],s="number"==typeof a?a:a[1],l=this.targetTileGrid_.getResolution(o),c=this.sourceTileGrid_.getResolution(this.sourceZ_),f=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_),h=e[0].bytesPerPixel,y=Math.ceil(h/3)-1;y>=0;--y){for(var p=[],d=0,v=e.length;d<v;++d){for(var g=e[d],m=g.data,b=g.pixelSize,_=b[0],w=b[1],S=ta(_,w,uv),x=S.createImageData(_,w),O=x.data,k=3*y,P=0,E=O.length;P<E;P+=4)O[P]=m[k],O[P+1]=m[k+1],O[P+2]=m[k+2],O[P+3]=255,k+=h;S.putImageData(x,0,0),p.push({extent:g.extent,clipExtent:g.clipExtent,image:S.canvas})}for(var j=hv(u,s,this.pixelRatio_,c,this.sourceTileGrid_.getExtent(),l,f,this.triangulation_,p,this.gutter_,!1,!1,!1),C=0,T=p.length;C<T;++C){var R=p[C].image.getContext("2d");na(R),uv.push(R.canvas)}var I=j.getContext("2d"),M=I.getImageData(0,0,j.width,j.height);na(I),uv.push(j),r||(i=new Uint8ClampedArray(h*M.width*M.height),r=new e[0].dataType(i.buffer));for(var L=M.data,A=3*y,F=0,D=L.length;F<D;F+=4)255===L[F+3]?(i[A]=L[F],i[A+1]=L[F+1],i[A+2]=L[F+2]):(i[A]=0,i[A+1]=0,i[A+2]=0),A+=h}if(n){var N=ta(u,s),z=new ImageData(r,u);N.putImageData(z,0,0),this.reprojData_=N.canvas}else this.reprojData_=r;this.reprojSize_=[Math.round(u*this.pixelRatio_),Math.round(s*this.pixelRatio_)],this.state=jf,this.changed()}},{key:"load",value:function(){var t=this;if(this.state===Pf||this.state===Cf){this.state=Ef,this.changed();var e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach((function(n){var r=n.tile,i=r.getState();if(i===Pf||i===Ef){e++;var o=X(r,M,(function(){var n=r.getState();n!=jf&&n!=Cf&&n!=Tf||(K(o),0==--e&&(t.unlistenSources_(),t.reproject_()))}));t.sourcesListenerKeys_.push(o)}})),0===e?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach((function(t){var e=t.tile;e.getState()==Pf&&e.load()}))}}},{key:"unlistenSources_",value:function(){this.sourcesListenerKeys_.forEach(K),this.sourcesListenerKeys_=null}}])&&pv(n.prototype,r),i&&pv(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(Yd);function wv(t){return(wv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Sv(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,xv(r.key),r)}}function xv(t){var e=function(t,e){if("object"!=wv(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=wv(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==wv(e)?e:e+""}function Ov(t,e,n){return e=jv(e),kv(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],jv(t).constructor):e.apply(t,n))}function kv(t,e){if(e&&("object"==wv(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Pv(){return(Pv="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=Ev(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}}).apply(null,arguments)}function Ev(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=jv(t)););return t}function jv(t){return(jv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Cv(t,e){return(Cv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Tv=function(t){function e(t,n,r,i,o,a,u,s,l,c,f,h){var y;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(y=Ov(this,e,[o,Pf,h])).renderEdges_=void 0!==f&&f,y.pixelRatio_=u,y.gutter_=s,y.canvas_=null,y.sourceTileGrid_=n,y.targetTileGrid_=i,y.wrappedTileCoord_=a||o,y.sourceTiles_=[],y.sourcesListenerKeys_=null,y.sourceZ_=0,y.clipExtent_=t.canWrapX()?t.getExtent():void 0;var p=i.getTileCoordExtent(y.wrappedTileCoord_),d=y.targetTileGrid_.getExtent(),v=y.sourceTileGrid_.getExtent(),g=d?je(p,d):p;if(0===we(g))return y.state=Tf,kv(y);var m=t.getExtent();m&&(v=v?je(v,m):m);var b=i.getResolution(y.wrappedTileCoord_[0]),_=fv(t,r,g,b);if(!isFinite(_)||_<=0)return y.state=Tf,kv(y);var w=void 0!==c?c:.5;if(y.triangulation_=new av(t,r,g,v,_*w,b),0===y.triangulation_.getTriangles().length)return y.state=Tf,kv(y);y.sourceZ_=n.getZForResolution(_);var S=y.triangulation_.calculateSourceExtent();if(v&&(t.canWrapX()?(S[1]=De(S[1],v[1],v[3]),S[3]=De(S[3],v[1],v[3])):S=je(S,v)),we(S)){var x=0,O=0;t.canWrapX()&&(x=Re(m),O=Math.floor((S[0]-m[0])/x)),Fe(S.slice(),t,!0).forEach((function(t){for(var e=n.getTileRangeForExtentAndZ(t,y.sourceZ_),r=e.minX;r<=e.maxX;r++)for(var i=e.minY;i<=e.maxY;i++){var o=l(y.sourceZ_,r,i,u);if(o){var a=O*x;y.sourceTiles_.push({tile:o,offset:a})}}++O})),0===y.sourceTiles_.length&&(y.state=Tf)}else y.state=Tf;return y}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Cv(t,e)}(e,t),function(t,e,n){return e&&Sv(t.prototype,e),n&&Sv(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(e,[{key:"getImage",value:function(){return this.canvas_}},{key:"reproject_",value:function(){var t=this,e=[];if(this.sourceTiles_.forEach((function(n){var r=n.tile;if(r&&r.getState()==jf){var i,o=t.sourceTileGrid_.getTileCoordExtent(r.tileCoord);o[0]+=n.offset,o[2]+=n.offset;var a=null===(i=t.clipExtent_)||void 0===i?void 0:i.slice();a&&(a[0]+=n.offset,a[2]+=n.offset),e.push({extent:o,clipExtent:a,image:r.getImage()})}})),this.sourceTiles_.length=0,0===e.length)this.state=Cf;else{var n=this.wrappedTileCoord_[0],r=this.targetTileGrid_.getTileSize(n),i="number"==typeof r?r:r[0],o="number"==typeof r?r:r[1],a=this.targetTileGrid_.getResolution(n),u=this.sourceTileGrid_.getResolution(this.sourceZ_),s=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=hv(i,o,this.pixelRatio_,u,this.sourceTileGrid_.getExtent(),a,s,this.triangulation_,e,this.gutter_,this.renderEdges_,this.interpolate),this.state=jf}this.changed()}},{key:"load",value:function(){var t=this;if(this.state==Pf){this.state=Ef,this.changed();var e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach((function(n){var r=n.tile,i=r.getState();if(i==Pf||i==Ef){e++;var o=X(r,M,(function(n){var i=r.getState();i!=jf&&i!=Cf&&i!=Tf||(K(o),0===--e&&(t.unlistenSources_(),t.reproject_()))}));t.sourcesListenerKeys_.push(o)}})),0===e?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach((function(t,e,n){var r=t.tile;r.getState()==Pf&&r.load()}))}}},{key:"unlistenSources_",value:function(){this.sourcesListenerKeys_.forEach(K),this.sourcesListenerKeys_=null}},{key:"release",value:function(){var t,n,r,i,o;this.canvas_&&(na(this.canvas_.getContext("2d")),uv.push(this.canvas_),this.canvas_=null),(t=e,n="release",r=this,o=Pv(jv(1&(i=3)?t.prototype:t),n,r),2&i&&"function"==typeof o?function(t){return o.apply(r,t)}:o)([])}}])}(Rd);function Rv(t){return(Rv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Iv(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Mv(r.key),r)}}function Mv(t){var e=function(t,e){if("object"!=Rv(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Rv(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Rv(e)?e:e+""}var Lv=function(){return t=function t(e,n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.minX=e,this.maxX=n,this.minY=r,this.maxY=i},(e=[{key:"contains",value:function(t){return this.containsXY(t[1],t[2])}},{key:"containsTileRange",value:function(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY}},{key:"containsXY",value:function(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY}},{key:"equals",value:function(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY}},{key:"extend",value:function(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)}},{key:"getHeight",value:function(){return this.maxY-this.minY+1}},{key:"getSize",value:function(){return[this.getWidth(),this.getHeight()]}},{key:"getWidth",value:function(){return this.maxX-this.minX+1}},{key:"intersects",value:function(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY}}])&&Iv(t.prototype,e),n&&Iv(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}();function Av(t,e,n,r,i){return void 0!==i?(i.minX=t,i.maxX=e,i.minY=n,i.maxY=r,i):new Lv(t,e,n,r)}var Fv=Lv;function Dv(t,e,n,r){return void 0!==r?(r[0]=t,r[1]=e,r[2]=n,r):[t,e,n]}function Nv(t,e,n){return t+"/"+e+"/"+n}function zv(t){return Nv(t[0],t[1],t[2])}function Bv(t,e,n){return(e<<t)+n}function Gv(t){return(Gv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Wv(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Xv(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Xv(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}function Xv(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Yv(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Kv(r.key),r)}}function Kv(t){var e=function(t,e){if("object"!=Gv(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Gv(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Gv(e)?e:e+""}function Zv(t,e,n){return e=Uv(e),function(t,e){if(e&&("object"==Gv(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],Uv(t).constructor):e.apply(t,n))}function Uv(t){return(Uv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Vv(t,e){return(Vv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function qv(t,e,n,r){return"".concat(t,",").concat(Nv(e,n,r))}function Hv(t,e,n){if(!(n in t))return t[n]=new Set([e]),!0;var r=t[n],i=r.has(e);return i||r.add(e),!i}function Jv(t,e,n){var r=t[n];return!!r&&r.delete(e)}function $v(t,e){var n=t.layerStatesArray[t.layerIndex];n.extent&&(e=je(e,kn(n.extent,t.viewState.projection)));var r=n.layer.getRenderSource();if(!r.getWrapX()){var i=r.getTileGridForProjection(t.viewState.projection).getExtent();i&&(e=je(e,i))}return e}var Qv=function(t){function e(t,n){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=n||{},(r=Zv(this,e,[t])).extentChanged=!0,r.renderComplete=!1,r.renderedExtent_=null,r.renderedPixelRatio,r.renderedProjection=null,r.renderedRevision,r.renderedTiles=[],r.renderedSourceKey_,r.renderedSourceRevision_,r.tempExtent=[1/0,1/0,-1/0,-1/0],r.tempTileRange_=new Fv(0,0,0,0),r.tempTileCoord_=Dv(0,0,0);var i=void 0!==n.cacheSize?n.cacheSize:512;return r.tileCache_=new ev(i),r.maxStaleKeys=.5*i,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Vv(t,e)}(e,t),n=e,(r=[{key:"getTileCache",value:function(){return this.tileCache_}},{key:"getOrCreateTile",value:function(t,e,n,r){var i,o=this.tileCache_,a=this.getLayer().getSource(),u=qv(a.getKey(),t,e,n);if(o.containsKey(u))i=o.get(u);else{if(!(i=a.getTile(t,e,n,r.pixelRatio,r.viewState.projection)))return null;o.set(u,i)}return i}},{key:"getTile",value:function(t,e,n,r){var i=this.getOrCreateTile(t,e,n,r);return i||null}},{key:"getData",value:function(t){var e=this.frameState;if(!e)return null;var n=this.getLayer(),r=zn(e.pixelToCoordinateTransform,t.slice()),i=n.getExtent();if(i&&!ue(i,r))return null;for(var o=e.viewState,a=n.getRenderSource(),u=a.getTileGridForProjection(o.projection),s=a.getTilePixelRatio(e.pixelRatio),l=u.getZForResolution(o.resolution);l>=u.getMinZoom();--l){var c=u.getTileCoordForCoordAndZ(r,l),f=this.getTile(l,c[1],c[2],e);if(f&&f.getState()===jf){var h=u.getOrigin(l),y=bo(u.getTileSize(l)),p=u.getResolution(l),d=void 0;if(f instanceof Jd)d=f.getImage();else{if(!(f instanceof Yd))continue;if(!(d=Bd(f.getData())))continue}var v=Math.floor(s*((r[0]-h[0])/p-c[1]*y[0])),g=Math.floor(s*((h[1]-r[1])/p-c[2]*y[1])),m=Math.round(s*a.getGutterForProjection(o.projection));return this.getImageData(d,v+m,g+m)}}return null}},{key:"prepareFrame",value:function(t){var e=this.getLayer().getSource();if(!e)return!1;var n=e.getRevision();return this.renderedRevision_?this.renderedRevision_!==n&&(this.renderedRevision_=n,this.renderedSourceKey_===e.getKey()&&this.tileCache_.clear()):this.renderedRevision_=n,!0}},{key:"enqueueTiles",value:function(t,e,n,r,i){var o=t.viewState,a=this.getLayer(),u=a.getRenderSource(),s=u.getTileGridForProjection(o.projection),l=nt(u);l in t.wantedTiles||(t.wantedTiles[l]={});for(var c=t.wantedTiles[l],f=a.getMapInternal(),h=Math.max(n-i,s.getMinZoom(),s.getZForResolution(Math.min(a.getMaxResolution(),f?f.getView().getResolutionForZoom(Math.max(a.getMinZoom(),0)):s.getResolution(0)),u.zDirection)),y=n;y>=h;--y)for(var p=s.getTileRangeForExtentAndZ(e,y,this.tempTileRange_),d=s.getResolution(y),v=p.minX;v<=p.maxX;++v)for(var g=p.minY;g<=p.maxY;++g){var m=this.getTile(y,v,g,t);if(m&&Hv(r,m,y)){var b=m.getKey();if(c[b]=!0,m.getState()===Pf&&!t.tileQueue.isKeyQueued(b)){var _=Dv(y,v,g,this.tempTileCoord_);t.tileQueue.enqueue([m,l,s.getTileCoordCenter(_),d])}}}}},{key:"findStaleTile_",value:function(t,e){for(var n=this.tileCache_,r=t[0],i=t[1],o=t[2],a=this.getStaleKeys(),u=0;u<a.length;++u){var s=qv(a[u],r,i,o);if(n.containsKey(s)){var l=n.get(s);if(l.getState()===jf)return l.endTransition(nt(this)),Hv(e,l,r),!0}}return!1}},{key:"findAltTiles_",value:function(t,e,n,r){var i=t.getTileRangeForTileCoordAndZ(e,n,this.tempTileRange_);if(!i)return!1;for(var o=!0,a=this.tileCache_,u=this.getLayer().getRenderSource().getKey(),s=i.minX;s<=i.maxX;++s)for(var l=i.minY;l<=i.maxY;++l){var c=qv(u,n,s,l),f=!1;if(a.containsKey(c)){var h=a.get(c);h.getState()===jf&&(Hv(r,h,n),f=!0)}f||(o=!1)}return o}},{key:"renderFrame",value:function(t,e){var n=this;this.renderComplete=!0;var r=t.layerStatesArray[t.layerIndex],i=t.viewState,o=i.projection,a=i.resolution,u=i.center,s=t.pixelRatio,l=this.getLayer(),c=l.getSource(),f=c.getRevision(),h=c.getTileGridForProjection(o),y=h.getZForResolution(a,c.zDirection),d=h.getResolution(y),v=c.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==v&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=v):this.renderedSourceKey_=v;var g=t.extent,m=c.getTilePixelRatio(s);this.prepareContainer(t,e);var b=this.context.canvas.width,_=this.context.canvas.height,w=r.extent&&kn(r.extent,o);w&&(g=je(g,kn(r.extent,o)));var S=d*b/2/m,x=d*_/2/m,O=[u[0]-S,u[1]-x,u[0]+S,u[1]+x],k={};this.renderedTiles.length=0;var P=l.getPreload();if(t.nextExtent){var E=h.getZForResolution(i.nextResolution,c.zDirection),j=$v(t,t.nextExtent);this.enqueueTiles(t,j,E,k,P)}var C=$v(t,g);if(this.enqueueTiles(t,C,y,k,0),P>0&&setTimeout((function(){n.enqueueTiles(t,C,y-1,k,P-1)}),0),!(y in k))return this.container;var T,R=nt(this),I=t.time,M=Wv(k[y]);try{for(M.s();!(T=M.n()).done;){var L=T.value,A=L.getState();if(!(L instanceof Tv||L instanceof _v)||A!==Tf){var F=L.tileCoord;if(A===jf&&1===L.getAlpha(R,I)){L.endTransition(R);continue}if(this.renderComplete=!1,this.findStaleTile_(F,k))Jv(k,L,y),t.animate=!0;else if(!this.findAltTiles_(h,F,y+1,k))for(var D=h.getMinZoom(),N=y-1;N>=D&&!this.findAltTiles_(h,F,N,k);--N);}}}catch(t){M.e(t)}finally{M.f()}var z=d/a*s/m,B=this.getRenderContext(t);Bn(this.tempTransform,b/2,_/2,z,z,0,-b/2,-_/2),r.extent&&this.clipUnrotated(B,t,w),c.getInterpolate()||(B.imageSmoothingEnabled=!1),this.preRender(B,t);var G,W=Object.keys(k).map(Number);W.sort(p);for(var X=[],Y=[],K=W.length-1;K>=0;--K){var Z,U=W[K],V=c.getTilePixelSize(U,s,o),q=h.getResolution(U)/d,H=V[0]*q*z,J=V[1]*q*z,$=h.getTileCoordForCoordAndZ(Ce(O),U),Q=h.getTileCoordExtent($),tt=zn(this.tempTransform,[m*(Q[0]-O[0])/d,m*(O[3]-Q[3])/d]),et=m*c.getGutterForProjection(o),rt=Wv(k[U]);try{for(rt.s();!(Z=rt.n()).done;){var it=Z.value;if(it.getState()===jf){var ot=it.tileCoord,at=$[1]-ot[1],ut=Math.round(tt[0]-(at-1)*H),st=$[2]-ot[2],lt=Math.round(tt[1]-(st-1)*J),ct=Math.round(tt[0]-at*H),ft=Math.round(tt[1]-st*J),ht=ut-ct,yt=lt-ft,pt=1===W.length,dt=!1;G=[ct,ft,ct+ht,ft,ct+ht,ft+yt,ct,ft+yt];for(var vt=0,gt=X.length;vt<gt;++vt)if(!pt&&U<Y[vt]){var mt=X[vt];Ie([ct,ft,ct+ht,ft+yt],[mt[0],mt[3],mt[4],mt[7]])&&(dt||(B.save(),dt=!0),B.beginPath(),B.moveTo(G[0],G[1]),B.lineTo(G[2],G[3]),B.lineTo(G[4],G[5]),B.lineTo(G[6],G[7]),B.moveTo(mt[6],mt[7]),B.lineTo(mt[4],mt[5]),B.lineTo(mt[2],mt[3]),B.lineTo(mt[0],mt[1]),B.clip())}X.push(G),Y.push(U),this.drawTile(it,t,ct,ft,ht,yt,et,pt),dt&&B.restore(),this.renderedTiles.unshift(it),this.updateUsedTiles(t.usedTiles,c,it)}}}catch(t){rt.e(t)}finally{rt.f()}}return this.renderedRevision=f,this.renderedResolution=d,this.extentChanged=!this.renderedExtent_||!ve(this.renderedExtent_,O),this.renderedExtent_=O,this.renderedPixelRatio=s,this.renderedProjection=o,this.postRender(this.context,t),r.extent&&B.restore(),B.imageSmoothingEnabled=!0,t.postRenderFunctions.push((function(t,e){var r=nt(c),i=e.wantedTiles[r],o=i?Object.keys(i).length:0;n.updateCacheSize(o),n.tileCache_.expireCache()})),this.container}},{key:"updateCacheSize",value:function(t){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,2*t)}},{key:"drawTile",value:function(t,e,n,r,i,o,a,u){var s;if(t instanceof Yd){if(!(s=Bd(t.getData())))throw new Error("Rendering array data is not yet supported")}else s=this.getTileImage(t);if(s){var l=this.getRenderContext(e),c=nt(this),f=e.layerStatesArray[e.layerIndex],h=f.opacity*(u?t.getAlpha(c,e.time):1),y=h!==l.globalAlpha;y&&(l.save(),l.globalAlpha=h),l.drawImage(s,a,a,s.width-2*a,s.height-2*a,n,r,i,o),y&&l.restore(),h!==f.opacity?e.animate=!0:u&&t.endTransition(c)}}},{key:"getImage",value:function(){var t=this.context;return t?t.canvas:null}},{key:"getTileImage",value:function(t){return t.getImage()}},{key:"updateUsedTiles",value:function(t,e,n){var r=nt(e);r in t||(t[r]={}),t[r][n.getKey()]=!0}}])&&Yv(n.prototype,r),i&&Yv(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(Od);function tg(t){return(tg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function eg(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ng(r.key),r)}}function ng(t){var e=function(t,e){if("object"!=tg(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=tg(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==tg(e)?e:e+""}function rg(t,e,n){return e=ig(e),function(t,e){if(e&&("object"==tg(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],ig(t).constructor):e.apply(t,n))}function ig(t){return(ig=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function og(t,e){return(og=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var ag=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),rg(this,e,[t])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&og(t,e)}(e,t),n=e,(r=[{key:"createRenderer",value:function(){return new Qv(this,{cacheSize:this.getCacheSize()})}}])&&eg(n.prototype,r),i&&eg(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}($p);function ug(t){return(ug="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function sg(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function lg(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,cg(r.key),r)}}function cg(t){var e=function(t,e){if("object"!=ug(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=ug(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ug(e)?e:e+""}function fg(t,e,n){return e=pg(e),function(t,e){if(e&&("object"==ug(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],pg(t).constructor):e.apply(t,n))}function hg(){return(hg="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=yg(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}}).apply(null,arguments)}function yg(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=pg(t)););return t}function pg(t){return(pg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function dg(t,e){return(dg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var vg=function(t){function e(){return sg(this,e),fg(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&dg(t,e)}(e,t),function(t,e,n){return e&&lg(t.prototype,e),n&&lg(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(e,[{key:"clear",value:function(){for(;this.getCount()>0;)this.pop().release();var t,n,r,i,o;(t=e,n="clear",r=this,o=hg(pg(1&(i=3)?t.prototype:t),n,r),2&i&&"function"==typeof o?function(t){return o.apply(r,t)}:o)([])}},{key:"expireCache",value:function(t){for(;this.canExpireCache();){if(this.peekLast().getKey()in t)break;this.pop().release()}}},{key:"pruneExceptNewestZ",value:function(){var t=this;if(0!==this.getCount()){var e=function(t){return t.split("/").map(Number)}(this.peekFirstKey())[0];this.forEach((function(n){n.tileCoord[0]!==e&&(t.remove(zv(n.tileCoord)),n.release())}))}}}])}(ev),gg="tileloadstart",mg="tileloadend",bg="tileloaderror";function _g(t){return(_g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function wg(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Sg(r.key),r)}}function Sg(t){var e=function(t,e){if("object"!=_g(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=_g(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==_g(e)?e:e+""}function xg(t,e,n){return e=Og(e),function(t,e){if(e&&("object"==_g(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],Og(t).constructor):e.apply(t,n))}function Og(t){return(Og=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function kg(t,e){return(kg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Pg(t){return t?"function"==typeof t?t:(Array.isArray(t)||(t=[t]),function(e){return t}):null}var Eg=function(t){function e(t){var n,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=xg(this,e)).projection=an(t.projection),r.attributions_=Pg(t.attributions),r.attributionsCollapsible_=null===(n=t.attributionsCollapsible)||void 0===n||n,r.loading=!1,r.state_=void 0!==t.state?t.state:"ready",r.wrapX_=void 0!==t.wrapX&&t.wrapX,r.interpolate_=!!t.interpolate,r.viewResolver=null,r.viewRejector=null;var i=r;return r.viewPromise_=new Promise((function(t,e){i.viewResolver=t,i.viewRejector=e})),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&kg(t,e)}(e,t),n=e,(r=[{key:"getAttributions",value:function(){return this.attributions_}},{key:"getAttributionsCollapsible",value:function(){return this.attributionsCollapsible_}},{key:"getProjection",value:function(){return this.projection}},{key:"getResolutions",value:function(t){return null}},{key:"getView",value:function(){return this.viewPromise_}},{key:"getState",value:function(){return this.state_}},{key:"getWrapX",value:function(){return this.wrapX_}},{key:"getInterpolate",value:function(){return this.interpolate_}},{key:"refresh",value:function(){this.changed()}},{key:"setAttributions",value:function(t){this.attributions_=Pg(t),this.changed()}},{key:"setState",value:function(t){this.state_=t,this.changed()}}])&&wg(n.prototype,r),i&&wg(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(yt);function jg(t){return(jg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Cg(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Tg(r.key),r)}}function Tg(t){var e=function(t,e){if("object"!=jg(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=jg(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==jg(e)?e:e+""}var Rg=[0,0,0],Ig=function(){return t=function t(e){var n,r,i,o,a=this;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.minZoom=void 0!==e.minZoom?e.minZoom:0,this.resolutions_=e.resolutions,En((n=this.resolutions_,r=!0,i=function(t,e){return e-t}||p,n.every((function(t,e){if(0===e)return!0;var o=i(n[e-1],t);return!(o>0||r&&0===o)}))),"`resolutions` must be sorted in descending order"),!e.origins)for(var u=0,s=this.resolutions_.length-1;u<s;++u)if(o){if(this.resolutions_[u]/this.resolutions_[u+1]!==o){o=void 0;break}}else o=this.resolutions_[u]/this.resolutions_[u+1];this.zoomFactor_=o,this.maxZoom=this.resolutions_.length-1,this.origin_=void 0!==e.origin?e.origin:null,this.origins_=null,void 0!==e.origins&&(this.origins_=e.origins,En(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));var l=e.extent;void 0===l||this.origin_||this.origins_||(this.origin_=Ce(l)),En(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,void 0!==e.tileSizes&&(this.tileSizes_=e.tileSizes,En(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=void 0!==e.tileSize?e.tileSize:this.tileSizes_?null:256,En(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=void 0!==l?l:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],void 0!==e.sizes?this.fullTileRanges_=e.sizes.map((function(t,e){var n=new Fv(Math.min(0,t[0]),Math.max(t[0]-1,-1),Math.min(0,t[1]),Math.max(t[1]-1,-1));if(l){var r=a.getTileRangeForExtentAndZ(l,e);n.minX=Math.max(r.minX,n.minX),n.maxX=Math.min(r.maxX,n.maxX),n.minY=Math.max(r.minY,n.minY),n.maxY=Math.min(r.maxY,n.maxY)}return n})):l&&this.calculateTileRanges_(l)},(e=[{key:"forEachTileCoord",value:function(t,e,n){for(var r=this.getTileRangeForExtentAndZ(t,e),i=r.minX,o=r.maxX;i<=o;++i)for(var a=r.minY,u=r.maxY;a<=u;++a)n([e,i,a])}},{key:"forEachTileCoordParentTileRange",value:function(t,e,n,r){var i,o,a=null,u=t[0]-1;for(2===this.zoomFactor_?(i=t[1],o=t[2]):a=this.getTileCoordExtent(t,r);u>=this.minZoom;){if(e(u,void 0!==i&&void 0!==o?Av(i=Math.floor(i/2),i,o=Math.floor(o/2),o,n):this.getTileRangeForExtentAndZ(a,u,n)))return!0;--u}return!1}},{key:"getExtent",value:function(){return this.extent_}},{key:"getMaxZoom",value:function(){return this.maxZoom}},{key:"getMinZoom",value:function(){return this.minZoom}},{key:"getOrigin",value:function(t){return this.origin_?this.origin_:this.origins_[t]}},{key:"getResolution",value:function(t){return this.resolutions_[t]}},{key:"getResolutions",value:function(){return this.resolutions_}},{key:"getTileCoordChildTileRange",value:function(t,e,n){if(t[0]<this.maxZoom){if(2===this.zoomFactor_){var r=2*t[1],i=2*t[2];return Av(r,r+1,i,i+1,e)}var o=this.getTileCoordExtent(t,n||this.tmpExtent_);return this.getTileRangeForExtentAndZ(o,t[0]+1,e)}return null}},{key:"getTileRangeForTileCoordAndZ",value:function(t,e,n){if(e>this.maxZoom||e<this.minZoom)return null;var r=t[0],i=t[1],o=t[2];if(e===r)return Av(i,o,i,o,n);if(this.zoomFactor_){var a=Math.pow(this.zoomFactor_,e-r),u=Math.floor(i*a),s=Math.floor(o*a);return e<r?Av(u,u,s,s,n):Av(u,Math.floor(a*(i+1))-1,s,Math.floor(a*(o+1))-1,n)}var l=this.getTileCoordExtent(t,this.tmpExtent_);return this.getTileRangeForExtentAndZ(l,e,n)}},{key:"getTileRangeForExtentAndZ",value:function(t,e,n){this.getTileCoordForXYAndZ_(t[0],t[3],e,!1,Rg);var r=Rg[1],i=Rg[2];return this.getTileCoordForXYAndZ_(t[2],t[1],e,!0,Rg),Av(r,Rg[1],i,Rg[2],n)}},{key:"getTileCoordCenter",value:function(t){var e=this.getOrigin(t[0]),n=this.getResolution(t[0]),r=bo(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*r[0]*n,e[1]-(t[2]+.5)*r[1]*n]}},{key:"getTileCoordExtent",value:function(t,e){var n=this.getOrigin(t[0]),r=this.getResolution(t[0]),i=bo(this.getTileSize(t[0]),this.tmpSize_),o=n[0]+t[1]*i[0]*r,a=n[1]-(t[2]+1)*i[1]*r;return he(o,a,o+i[0]*r,a+i[1]*r,e)}},{key:"getTileCoordForCoordAndResolution",value:function(t,e,n){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,n)}},{key:"getTileCoordForXYAndResolution_",value:function(t,e,n,r,i){var o=this.getZForResolution(n),a=n/this.getResolution(o),u=this.getOrigin(o),s=bo(this.getTileSize(o),this.tmpSize_),l=a*(t-u[0])/n/s[0],c=a*(u[1]-e)/n/s[1];return r?(l=Ke(l,5)-1,c=Ke(c,5)-1):(l=Ye(l,5),c=Ye(c,5)),Dv(o,l,c,i)}},{key:"getTileCoordForXYAndZ_",value:function(t,e,n,r,i){var o=this.getOrigin(n),a=this.getResolution(n),u=bo(this.getTileSize(n),this.tmpSize_),s=(t-o[0])/a/u[0],l=(o[1]-e)/a/u[1];return r?(s=Ke(s,5)-1,l=Ke(l,5)-1):(s=Ye(s,5),l=Ye(l,5)),Dv(n,s,l,i)}},{key:"getTileCoordForCoordAndZ",value:function(t,e,n){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,n)}},{key:"getTileCoordResolution",value:function(t){return this.resolutions_[t[0]]}},{key:"getTileSize",value:function(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]}},{key:"getFullTileRange",value:function(t){return this.fullTileRanges_?this.fullTileRanges_[t]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,t):null}},{key:"getZForResolution",value:function(t,e){return De(d(this.resolutions_,t,e||0),this.minZoom,this.maxZoom)}},{key:"tileCoordIntersectsViewport",value:function(t,e){return Kr(e,0,e.length,2,this.getTileCoordExtent(t))}},{key:"calculateTileRanges_",value:function(t){for(var e=this.resolutions_.length,n=new Array(e),r=this.minZoom;r<e;++r)n[r]=this.getTileRangeForExtentAndZ(t,r);this.fullTileRanges_=n}}])&&Cg(t.prototype,e),n&&Cg(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}();function Mg(t){var e=t.getDefaultTileGrid();return e||(e=function(t,e,n,r){return function(t,e,n,r){r=void 0!==r?r:"top-left";var i=Lg(t,e,n);return new Ig({extent:t,origin:ke(t,r),resolutions:i,tileSize:n})}(Ag(t),e,n,r)}(t),t.setDefaultTileGrid(e)),e}function Lg(t,e,n,r){e=void 0!==e?e:42,n=bo(void 0!==n?n:256);var i=Ee(t),o=Re(t);r=r>0?r:Math.max(o/n[0],i/n[1]);for(var a=e+1,u=new Array(a),s=0;s<a;++s)u[s]=r/Math.pow(2,s);return u}function Ag(t){var e=(t=an(t)).getExtent();if(!e){var n=180*gt.degrees/t.getMetersPerUnit();e=he(-n,-n,n,n)}return e}function Fg(t){return(Fg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Dg(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ng(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Bg(r.key),r)}}function zg(t,e,n){return e&&Ng(t.prototype,e),n&&Ng(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Bg(t){var e=function(t,e){if("object"!=Fg(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Fg(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Fg(e)?e:e+""}function Gg(t,e,n){return e=Yg(e),function(t,e){if(e&&("object"==Fg(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],Yg(t).constructor):e.apply(t,n))}function Wg(){return(Wg="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=Xg(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}}).apply(null,arguments)}function Xg(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=Yg(t)););return t}function Yg(t){return(Yg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Kg(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Zg(t,e)}function Zg(t,e){return(Zg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Ug=function(t){function e(t){var n;Dg(this,e),(n=Gg(this,e,[{attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,projection:t.projection,state:t.state,wrapX:t.wrapX,interpolate:t.interpolate}])).on,n.once,n.un,n.tilePixelRatio_=void 0!==t.tilePixelRatio?t.tilePixelRatio:1,n.tileGrid=void 0!==t.tileGrid?t.tileGrid:null;return n.tileGrid&&bo(n.tileGrid.getTileSize(n.tileGrid.getMinZoom()),[256,256]),n.tileCache=new vg(t.cacheSize||0),n.tmpSize=[0,0],n.key_=t.key||"",n.tileOptions={transition:t.transition,interpolate:t.interpolate},n.zDirection=t.zDirection?t.zDirection:0,n}return Kg(e,t),zg(e,[{key:"canExpireCache",value:function(){return this.tileCache.canExpireCache()}},{key:"expireCache",value:function(t,e){var n=this.getTileCacheForProjection(t);n&&n.expireCache(e)}},{key:"getGutterForProjection",value:function(t){return 0}},{key:"getKey",value:function(){return this.key_}},{key:"setKey",value:function(t){this.key_!==t&&(this.key_=t,this.changed())}},{key:"getResolutions",value:function(t){var e=t?this.getTileGridForProjection(t):this.tileGrid;return e?e.getResolutions():null}},{key:"getTile",value:function(t,e,n,r,i){return tt()}},{key:"getTileGrid",value:function(){return this.tileGrid}},{key:"getTileGridForProjection",value:function(t){return this.tileGrid?this.tileGrid:Mg(t)}},{key:"getTileCacheForProjection",value:function(t){var e=this.getProjection();return En(null===e||hn(e,t),"A VectorTile source can only be rendered if it has a projection compatible with the view projection."),this.tileCache}},{key:"getTilePixelRatio",value:function(t){return this.tilePixelRatio_}},{key:"getTilePixelSize",value:function(t,e,n){var r,i,o,a=this.getTileGridForProjection(n),u=this.getTilePixelRatio(e),s=bo(a.getTileSize(t),this.tmpSize);return 1==u?s:(r=s,i=u,void 0===(o=this.tmpSize)&&(o=[0,0]),o[0]=r[0]*i+.5|0,o[1]=r[1]*i+.5|0,o)}},{key:"getTileCoordForTileUrlFunction",value:function(t,e){e=void 0!==e?e:this.getProjection();var n=this.getTileGridForProjection(e);return this.getWrapX()&&e.isGlobal()&&(t=function(t,e,n){var r=e[0],i=t.getTileCoordCenter(e),o=Ag(n);if(!ue(o,i)){var a=Re(o),u=Math.ceil((o[0]-i[0])/a);return i[0]+=a*u,t.getTileCoordForCoordAndZ(i,r)}return e}(n,t,e)),function(t,e){var n=t[0],r=t[1],i=t[2];if(e.getMinZoom()>n||n>e.getMaxZoom())return!1;var o=e.getFullTileRange(n);return!o||o.containsXY(r,i)}(t,n)?t:null}},{key:"clear",value:function(){this.tileCache.clear()}},{key:"refresh",value:function(){var t,n,r,i,o;this.clear(),(t=e,n="refresh",r=this,o=Wg(Yg(1&(i=3)?t.prototype:t),n,r),2&i&&"function"==typeof o?function(t){return o.apply(r,t)}:o)([])}},{key:"useTile",value:function(t,e,n,r){}}])}(Eg),Vg=function(t){function e(t,n){var r;return Dg(this,e),(r=Gg(this,e,[t])).tile=n,r}return Kg(e,t),zg(e)}(s);var qg=/\{z\}/g,Hg=/\{x\}/g,Jg=/\{y\}/g,$g=/\{-y\}/g;function Qg(t,e){return function(n,r,i){if(n){var o,a=n[0];if(e){var u=e.getFullTileRange(a);u&&(o=u.getHeight()-1)}return function(t,e,n,r,i){return t.replace(qg,e.toString()).replace(Hg,n.toString()).replace(Jg,r.toString()).replace($g,(function(){if(void 0===i)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(i-r).toString()}))}(t,a,n[1],n[2],o)}}}function tm(t,e){for(var n=t.length,r=new Array(n),i=0;i<n;++i)r[i]=Qg(t[i],e);return function(t){if(1===t.length)return t[0];return function(e,n,r){if(e){var i=Ge(function(t){return Bv(t[0],t[1],t[2])}(e),t.length);return t[i](e,n,r)}}}(r)}function em(t){return(em="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function nm(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,rm(r.key),r)}}function rm(t){var e=function(t,e){if("object"!=em(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=em(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==em(e)?e:e+""}function im(t,e,n){return e=om(e),function(t,e){if(e&&("object"==em(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],om(t).constructor):e.apply(t,n))}function om(t){return(om=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function am(t,e){return(am=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function um(t){return(um="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function sm(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,lm(r.key),r)}}function lm(t){var e=function(t,e){if("object"!=um(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=um(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==um(e)?e:e+""}function cm(t,e,n){return e=pm(e),function(t,e){if(e&&("object"==um(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],pm(t).constructor):e.apply(t,n))}function fm(t,e,n,r){var i=hm(pm(1&r?t.prototype:t),e,n);return 2&r&&"function"==typeof i?function(t){return i.apply(n,t)}:i}function hm(){return(hm="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=ym(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}}).apply(null,arguments)}function ym(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=pm(t)););return t}function pm(t){return(pm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function dm(t,e){return(dm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function vm(t,e){t.getImage().src=e}function gm(t){return(gm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function mm(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,bm(r.key),r)}}function bm(t){var e=function(t,e){if("object"!=gm(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=gm(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==gm(e)?e:e+""}function _m(t,e,n){return e=wm(e),function(t,e){if(e&&("object"==gm(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],wm(t).constructor):e.apply(t,n))}function wm(t){return(wm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Sm(t,e){return(Sm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function xm(t){return(xm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Om(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,km(r.key),r)}}function km(t){var e=function(t,e){if("object"!=xm(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=xm(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==xm(e)?e:e+""}function Pm(t,e,n){return e=Em(e),function(t,e){if(e&&("object"==xm(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],Em(t).constructor):e.apply(t,n))}function Em(t){return(Em=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function jm(t,e){return(jm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Cm=function(t){function e(t){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=void 0!==(t=t||{}).attributions?t.attributions:['&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.'];var r=void 0!==t.crossOrigin?t.crossOrigin:"anonymous",i=void 0!==t.url?t.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";return Pm(this,e,[{attributions:n,attributionsCollapsible:!1,cacheSize:t.cacheSize,crossOrigin:r,interpolate:t.interpolate,maxZoom:void 0!==t.maxZoom?t.maxZoom:19,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileLoadFunction:t.tileLoadFunction,transition:t.transition,url:i,wrapX:t.wrapX,zDirection:t.zDirection}])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&jm(t,e)}(e,t),n=e,r&&Om(n.prototype,r),i&&Om(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(function(t){function e(t){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=void 0!==(t=t||{}).projection?t.projection:"EPSG:3857",i=void 0!==t.tileGrid?t.tileGrid:function(t){var e=t||{},n=e.extent||an("EPSG:3857").getExtent(),r={extent:n,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:Lg(n,e.maxZoom,e.tileSize,e.maxResolution)};return new Ig(r)}({extent:Ag(r),maxResolution:t.maxResolution,maxZoom:t.maxZoom,minZoom:t.minZoom,tileSize:t.tileSize});return(n=_m(this,e,[{attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,projection:r,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileGrid:i,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}])).gutter_=void 0!==t.gutter?t.gutter:0,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Sm(t,e)}(e,t),n=e,(r=[{key:"getGutter",value:function(){return this.gutter_}}])&&mm(n.prototype,r),i&&mm(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=cm(this,e,[{attributions:t.attributions,cacheSize:t.cacheSize,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:vm,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX,transition:t.transition,interpolate:void 0===t.interpolate||t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}])).crossOrigin=void 0!==t.crossOrigin?t.crossOrigin:null,n.tileClass=void 0!==t.tileClass?t.tileClass:Jd,n.tileCacheForProjection={},n.tileGridForProjection={},n.reprojectionErrorThreshold_=t.reprojectionErrorThreshold,n.renderReprojectionEdges_=!1,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&dm(t,e)}(e,t),n=e,(r=[{key:"canExpireCache",value:function(){if(this.tileCache.canExpireCache())return!0;for(var t in this.tileCacheForProjection)if(this.tileCacheForProjection[t].canExpireCache())return!0;return!1}},{key:"expireCache",value:function(t,e){var n=this.getTileCacheForProjection(t);for(var r in this.tileCache.expireCache(this.tileCache==n?e:{}),this.tileCacheForProjection){var i=this.tileCacheForProjection[r];i.expireCache(i==n?e:{})}}},{key:"getGutterForProjection",value:function(t){return this.getProjection()&&t&&!hn(this.getProjection(),t)?0:this.getGutter()}},{key:"getGutter",value:function(){return 0}},{key:"getKey",value:function(){var t=fm(e,"getKey",this,3)([]);return this.getInterpolate()||(t+=":disable-interpolation"),t}},{key:"getTileGridForProjection",value:function(t){var e=this.getProjection();if(this.tileGrid&&(!e||hn(e,t)))return this.tileGrid;var n=nt(t);return n in this.tileGridForProjection||(this.tileGridForProjection[n]=Mg(t)),this.tileGridForProjection[n]}},{key:"getTileCacheForProjection",value:function(t){var e=this.getProjection();if(!e||hn(e,t))return this.tileCache;var n=nt(t);return n in this.tileCacheForProjection||(this.tileCacheForProjection[n]=new vg(this.tileCache.highWaterMark)),this.tileCacheForProjection[n]}},{key:"createTile_",value:function(t,e,n,r,i,o){var a=[t,e,n],u=this.getTileCoordForTileUrlFunction(a,i),s=u?this.tileUrlFunction(u,r,i):void 0,l=new this.tileClass(a,void 0!==s?Pf:Tf,void 0!==s?s:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return l.key=o,l.addEventListener(M,this.handleTileChange.bind(this)),l}},{key:"getTile",value:function(t,e,n,r,i){var o=this,a=this.getProjection();if(!a||!i||hn(a,i))return this.getTileInternal(t,e,n,r,a||i);var u,s=this.getTileCacheForProjection(i),l=[t,e,n],c=zv(l);s.containsKey(c)&&(u=s.get(c));var f=this.getKey();if(u&&u.key==f)return u;var h=this.getTileGridForProjection(a),y=this.getTileGridForProjection(i),p=this.getTileCoordForTileUrlFunction(l,i),d=new Tv(a,h,i,y,l,p,this.getTilePixelRatio(r),this.getGutter(),(function(t,e,n,r){return o.getTileInternal(t,e,n,r,a)}),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return d.key=f,u?s.replace(c,d):s.set(c,d),d}},{key:"getTileInternal",value:function(t,e,n,r,i){var o=Nv(t,e,n),a=this.getKey();if(!this.tileCache.containsKey(o)){var u=this.createTile_(t,e,n,r,i,a);return this.tileCache.set(o,u),u}var s=this.tileCache.get(o);return s.key!=a&&(s=this.createTile_(t,e,n,r,i,a),this.tileCache.replace(o,s)),s}},{key:"setRenderReprojectionEdges",value:function(t){if(this.renderReprojectionEdges_!=t){for(var e in this.renderReprojectionEdges_=t,this.tileCacheForProjection)this.tileCacheForProjection[e].clear();this.changed()}}},{key:"setTileGridForProjection",value:function(t,e){var n=an(t);if(n){var r=nt(n);r in this.tileGridForProjection||(this.tileGridForProjection[r]=e)}}},{key:"clear",value:function(){for(var t in fm(e,"clear",this,3)([]),this.tileCacheForProjection)this.tileCacheForProjection[t].clear()}}])&&sm(n.prototype,r),i&&sm(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=im(this,e,[{attributions:t.attributions,cacheSize:t.cacheSize,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}])).generateTileUrlFunction_=n.tileUrlFunction===e.prototype.tileUrlFunction,n.tileLoadFunction=t.tileLoadFunction,t.tileUrlFunction&&(n.tileUrlFunction=t.tileUrlFunction),n.urls=null,t.urls?n.setUrls(t.urls):t.url&&n.setUrl(t.url),n.tileLoadingKeys_={},n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&am(t,e)}(e,t),n=e,(r=[{key:"getTileLoadFunction",value:function(){return this.tileLoadFunction}},{key:"getTileUrlFunction",value:function(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}},{key:"getUrls",value:function(){return this.urls}},{key:"handleTileChange",value:function(t){var e,n=t.target,r=nt(n),i=n.getState();i==Ef?(this.tileLoadingKeys_[r]=!0,e=gg):r in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[r],e=i==Cf?bg:i==jf?mg:void 0),null!=e&&this.dispatchEvent(new Vg(e,n))}},{key:"setTileLoadFunction",value:function(t){this.tileCache.clear(),this.tileLoadFunction=t,this.changed()}},{key:"setTileUrlFunction",value:function(t,e){this.tileUrlFunction=t,this.tileCache.pruneExceptNewestZ(),void 0!==e?this.setKey(e):this.changed()}},{key:"setUrl",value:function(t){var e=function(t){var e=[],n=/\{([a-z])-([a-z])\}/.exec(t);if(n){var r,i=n[1].charCodeAt(0),o=n[2].charCodeAt(0);for(r=i;r<=o;++r)e.push(t.replace(n[0],String.fromCharCode(r)));return e}if(n=/\{(\d+)-(\d+)\}/.exec(t)){for(var a=parseInt(n[2],10),u=parseInt(n[1],10);u<=a;u++)e.push(t.replace(n[0],u.toString()));return e}return e.push(t),e}(t);this.urls=e,this.setUrls(e)}},{key:"setUrls",value:function(t){this.urls=t;var e=t.join("\n");this.generateTileUrlFunction_?this.setTileUrlFunction(tm(t,this.tileGrid),e):this.setKey(e)}},{key:"tileUrlFunction",value:function(t,e,n){}},{key:"useTile",value:function(t,e,n){var r=Nv(t,e,n);this.tileCache.containsKey(r)&&this.tileCache.get(r)}}])&&nm(n.prototype,r),i&&nm(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(Ug))));function Tm(t){return(Tm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Rm(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Im(r.key),r)}}function Im(t){var e=function(t,e){if("object"!=Tm(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Tm(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Tm(e)?e:e+""}function Mm(t,e,n){return e=Lm(e),function(t,e){if(e&&("object"==Tm(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],Lm(t).constructor):e.apply(t,n))}function Lm(t){return(Lm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Am(t,e){return(Am=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Fm=function(t){function e(t){var n;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Mm(this,e)).on,n.once,n.un,n.id_=void 0,n.geometryName_="geometry",n.style_=null,n.styleFunction_=void 0,n.geometryChangeKey_=null,n.addChangeListener(n.geometryName_,n.handleGeometryChanged_),t)if("function"==typeof t.getSimplifiedGeometry){var r=t;n.setGeometry(r)}else{var i=t;n.setProperties(i)}return n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Am(t,e)}(e,t),n=e,(r=[{key:"clone",value:function(){var t=new e(this.hasProperties()?this.getProperties():null);t.setGeometryName(this.getGeometryName());var n=this.getGeometry();n&&t.setGeometry(n.clone());var r=this.getStyle();return r&&t.setStyle(r),t}},{key:"getGeometry",value:function(){return this.get(this.geometryName_)}},{key:"getId",value:function(){return this.id_}},{key:"getGeometryName",value:function(){return this.geometryName_}},{key:"getStyle",value:function(){return this.style_}},{key:"getStyleFunction",value:function(){return this.styleFunction_}},{key:"handleGeometryChange_",value:function(){this.changed()}},{key:"handleGeometryChanged_",value:function(){this.geometryChangeKey_&&(K(this.geometryChangeKey_),this.geometryChangeKey_=null);var t=this.getGeometry();t&&(this.geometryChangeKey_=X(t,M,this.handleGeometryChange_,this)),this.changed()}},{key:"setGeometry",value:function(t){this.set(this.geometryName_,t)}},{key:"setStyle",value:function(t){var e,n;this.style_=t,this.styleFunction_=t?"function"==typeof(e=t)?e:(Array.isArray(e)?n=e:(En("function"==typeof e.getZIndex,"Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),n=[e]),function(){return n}):void 0,this.changed()}},{key:"setId",value:function(t){this.id_=t,this.changed()}},{key:"setGeometryName",value:function(t){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=t,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}])&&Rm(n.prototype,r),i&&Rm(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(yt),Dm={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},Nm=[Dm.FILL],zm=[Dm.STROKE],Bm=[Dm.BEGIN_PATH],Gm=[Dm.CLOSE_PATH],Wm=Dm;function Xm(t){return(Xm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ym(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Km(r.key),r)}}function Km(t){var e=function(t,e){if("object"!=Xm(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Xm(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Xm(e)?e:e+""}var Zm=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},(e=[{key:"drawCustom",value:function(t,e,n,r,i){}},{key:"drawGeometry",value:function(t){}},{key:"setStyle",value:function(t){}},{key:"drawCircle",value:function(t,e,n){}},{key:"drawFeature",value:function(t,e,n){}},{key:"drawGeometryCollection",value:function(t,e,n){}},{key:"drawLineString",value:function(t,e,n){}},{key:"drawMultiLineString",value:function(t,e,n){}},{key:"drawMultiPoint",value:function(t,e,n){}},{key:"drawMultiPolygon",value:function(t,e,n){}},{key:"drawPoint",value:function(t,e,n){}},{key:"drawPolygon",value:function(t,e,n){}},{key:"drawText",value:function(t,e,n){}},{key:"setFillStrokeStyle",value:function(t,e){}},{key:"setImageStyle",value:function(t,e){}},{key:"setTextStyle",value:function(t,e){}}])&&Ym(t.prototype,e),n&&Ym(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}();function Um(t){return(Um="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vm(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,qm(r.key),r)}}function qm(t){var e=function(t,e){if("object"!=Um(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Um(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Um(e)?e:e+""}function Hm(t,e,n){return e=Jm(e),function(t,e){if(e&&("object"==Um(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],Jm(t).constructor):e.apply(t,n))}function Jm(t){return(Jm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $m(t,e){return($m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Qm=function(t){function e(t,n,r,i){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=Hm(this,e)).tolerance=t,o.maxExtent=n,o.pixelRatio=i,o.maxLineWidth=0,o.resolution=r,o.beginGeometryInstruction1_=null,o.beginGeometryInstruction2_=null,o.bufferedMaxExtent_=null,o.instructions=[],o.coordinates=[],o.tmpCoordinate_=[],o.hitDetectionInstructions=[],o.state={},o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&$m(t,e)}(e,t),n=e,(r=[{key:"applyPixelRatio",value:function(t){var e=this.pixelRatio;return 1==e?t:t.map((function(t){return t*e}))}},{key:"appendFlatPointCoordinates",value:function(t,e){for(var n=this.getBufferedMaxExtent(),r=this.tmpCoordinate_,i=this.coordinates,o=i.length,a=0,u=t.length;a<u;a+=e)r[0]=t[a],r[1]=t[a+1],ue(n,r)&&(i[o++]=r[0],i[o++]=r[1]);return o}},{key:"appendFlatLineCoordinates",value:function(t,e,n,r,i,o){var a=this.coordinates,u=a.length,s=this.getBufferedMaxExtent();o&&(e+=r);var l,c,f,h=t[e],y=t[e+1],p=this.tmpCoordinate_,d=!0;for(l=e+r;l<n;l+=r)p[0]=t[l],p[1]=t[l+1],(f=ce(s,p))!==c?(d&&(a[u++]=h,a[u++]=y,d=!1),a[u++]=p[0],a[u++]=p[1]):f===Ht?(a[u++]=p[0],a[u++]=p[1],d=!1):d=!0,h=p[0],y=p[1],c=f;return(i&&d||l===e+r)&&(a[u++]=h,a[u++]=y),u}},{key:"drawCustomCoordinates_",value:function(t,e,n,r,i){for(var o=0,a=n.length;o<a;++o){var u=n[o],s=this.appendFlatLineCoordinates(t,e,u,r,!1,!1);i.push(s),e=u}return e}},{key:"drawCustom",value:function(t,e,n,r,i){this.beginGeometry(t,e,i);var o,a,u,s,l,c=t.getType(),f=t.getStride(),h=this.coordinates.length;switch(c){case"MultiPolygon":o=t.getOrientedFlatCoordinates(),s=[];var y=t.getEndss();l=0;for(var p=0,d=y.length;p<d;++p){var v=[];l=this.drawCustomCoordinates_(o,l,y[p],f,v),s.push(v)}this.instructions.push([Wm.CUSTOM,h,s,t,n,wr,i]),this.hitDetectionInstructions.push([Wm.CUSTOM,h,s,t,r||n,wr,i]);break;case"Polygon":case"MultiLineString":u=[],o="Polygon"==c?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),l=this.drawCustomCoordinates_(o,0,t.getEnds(),f,u),this.instructions.push([Wm.CUSTOM,h,u,t,n,_r,i]),this.hitDetectionInstructions.push([Wm.CUSTOM,h,u,t,r||n,_r,i]);break;case"LineString":case"Circle":o=t.getFlatCoordinates(),a=this.appendFlatLineCoordinates(o,0,o.length,f,!1,!1),this.instructions.push([Wm.CUSTOM,h,a,t,n,br,i]),this.hitDetectionInstructions.push([Wm.CUSTOM,h,a,t,r||n,br,i]);break;case"MultiPoint":o=t.getFlatCoordinates(),(a=this.appendFlatPointCoordinates(o,f))>h&&(this.instructions.push([Wm.CUSTOM,h,a,t,n,br,i]),this.hitDetectionInstructions.push([Wm.CUSTOM,h,a,t,r||n,br,i]));break;case"Point":o=t.getFlatCoordinates(),this.coordinates.push(o[0],o[1]),a=this.coordinates.length,this.instructions.push([Wm.CUSTOM,h,a,t,n,void 0,i]),this.hitDetectionInstructions.push([Wm.CUSTOM,h,a,t,r||n,void 0,i])}this.endGeometry(e)}},{key:"beginGeometry",value:function(t,e,n){this.beginGeometryInstruction1_=[Wm.BEGIN_GEOMETRY,e,0,t,n],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[Wm.BEGIN_GEOMETRY,e,0,t,n],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}},{key:"finish",value:function(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}},{key:"reverseHitDetectionInstructions",value:function(){var t,e=this.hitDetectionInstructions;e.reverse();var n,r,i=e.length,o=-1;for(t=0;t<i;++t)(r=(n=e[t])[0])==Wm.END_GEOMETRY?o=t:r==Wm.BEGIN_GEOMETRY&&(n[2]=t,v(this.hitDetectionInstructions,o,t),o=-1)}},{key:"setFillStrokeStyle",value:function(t,e){var n=this.state;if(t){var r=t.getColor();n.fillPatternScale=r&&"object"===Um(r)&&"src"in r?this.pixelRatio:1,n.fillStyle=Oa(r||"#000")}else n.fillStyle=void 0;if(e){var i=e.getColor();n.strokeStyle=Oa(i||"#000");var o=e.getLineCap();n.lineCap=void 0!==o?o:"round";var a=e.getLineDash();n.lineDash=a?a.slice():Ia;var u=e.getLineDashOffset();n.lineDashOffset=u||0;var s=e.getLineJoin();n.lineJoin=void 0!==s?s:"round";var l=e.getWidth();n.lineWidth=void 0!==l?l:1;var c=e.getMiterLimit();n.miterLimit=void 0!==c?c:10,n.lineWidth>this.maxLineWidth&&(this.maxLineWidth=n.lineWidth,this.bufferedMaxExtent_=null)}else n.strokeStyle=void 0,n.lineCap=void 0,n.lineDash=null,n.lineDashOffset=void 0,n.lineJoin=void 0,n.lineWidth=void 0,n.miterLimit=void 0}},{key:"createFill",value:function(t){var e=t.fillStyle,n=[Wm.SET_FILL_STYLE,e];return"string"!=typeof e&&n.push(t.fillPatternScale),n}},{key:"applyStroke",value:function(t){this.instructions.push(this.createStroke(t))}},{key:"createStroke",value:function(t){return[Wm.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]}},{key:"updateFillStyle",value:function(t,e){var n=t.fillStyle;"string"==typeof n&&t.currentFillStyle==n||(void 0!==n&&this.instructions.push(e.call(this,t)),t.currentFillStyle=n)}},{key:"updateStrokeStyle",value:function(t,e){var n=t.strokeStyle,r=t.lineCap,i=t.lineDash,o=t.lineDashOffset,a=t.lineJoin,u=t.lineWidth,s=t.miterLimit;(t.currentStrokeStyle!=n||t.currentLineCap!=r||i!=t.currentLineDash&&!m(t.currentLineDash,i)||t.currentLineDashOffset!=o||t.currentLineJoin!=a||t.currentLineWidth!=u||t.currentMiterLimit!=s)&&(void 0!==n&&e.call(this,t),t.currentStrokeStyle=n,t.currentLineCap=r,t.currentLineDash=i,t.currentLineDashOffset=o,t.currentLineJoin=a,t.currentLineWidth=u,t.currentMiterLimit=s)}},{key:"endGeometry",value:function(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;var e=[Wm.END_GEOMETRY,t];this.instructions.push(e),this.hitDetectionInstructions.push(e)}},{key:"getBufferedMaxExtent",value:function(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=oe(this.maxExtent),this.maxLineWidth>0)){var t=this.resolution*(this.maxLineWidth+1)/2;ie(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}])&&Vm(n.prototype,r),i&&Vm(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(Zm);function tb(t){return(tb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function eb(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,nb(r.key),r)}}function nb(t){var e=function(t,e){if("object"!=tb(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=tb(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==tb(e)?e:e+""}function rb(t,e,n){return e=ab(e),function(t,e){if(e&&("object"==tb(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],ab(t).constructor):e.apply(t,n))}function ib(){return(ib="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=ob(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}}).apply(null,arguments)}function ob(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=ab(t)););return t}function ab(t){return(ab=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ub(t,e){return(ub=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var sb=function(t){function e(t,n,r,i){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=rb(this,e,[t,n,r,i])).hitDetectionImage_=null,o.image_=null,o.imagePixelRatio_=void 0,o.anchorX_=void 0,o.anchorY_=void 0,o.height_=void 0,o.opacity_=void 0,o.originX_=void 0,o.originY_=void 0,o.rotateWithView_=void 0,o.rotation_=void 0,o.scale_=void 0,o.width_=void 0,o.declutterMode_=void 0,o.declutterImageWithText_=void 0,o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ub(t,e)}(e,t),function(t,e,n){return e&&eb(t.prototype,e),n&&eb(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(e,[{key:"drawPoint",value:function(t,e,n){if(this.image_&&(!this.maxExtent||ue(this.maxExtent,t.getFlatCoordinates()))){this.beginGeometry(t,e,n);var r=t.getFlatCoordinates(),i=t.getStride(),o=this.coordinates.length,a=this.appendFlatPointCoordinates(r,i);this.instructions.push([Wm.DRAW_IMAGE,o,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Wm.DRAW_IMAGE,o,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}}},{key:"drawMultiPoint",value:function(t,e,n){if(this.image_){this.beginGeometry(t,e,n);for(var r=t.getFlatCoordinates(),i=[],o=0,a=r.length;o<a;o+=t.getStride())this.maxExtent&&!ue(this.maxExtent,r.slice(o,o+2))||i.push(r[o],r[o+1]);var u=this.coordinates.length,s=this.appendFlatPointCoordinates(i,2);this.instructions.push([Wm.DRAW_IMAGE,u,s,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Wm.DRAW_IMAGE,u,s,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}}},{key:"finish",value:function(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,(t=e,n="finish",r=this,o=ib(ab(1&(i=3)?t.prototype:t),n,r),2&i&&"function"==typeof o?function(t){return o.apply(r,t)}:o)([]);var t,n,r,i,o}},{key:"setImageStyle",value:function(t,e){var n=t.getAnchor(),r=t.getSize(),i=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio),this.anchorX_=n[0],this.anchorY_=n[1],this.hitDetectionImage_=t.getHitDetectionImage(),this.image_=t.getImage(this.pixelRatio),this.height_=r[1],this.opacity_=t.getOpacity(),this.originX_=i[0],this.originY_=i[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScaleArray(),this.width_=r[0],this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}}])}(Qm);function lb(t){return(lb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function cb(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,fb(r.key),r)}}function fb(t){var e=function(t,e){if("object"!=lb(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=lb(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==lb(e)?e:e+""}function hb(t,e,n){return e=vb(e),function(t,e){if(e&&("object"==lb(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],vb(t).constructor):e.apply(t,n))}function yb(t,e,n,r){var i=pb(vb(1&r?t.prototype:t),e,n);return 2&r&&"function"==typeof i?function(t){return i.apply(n,t)}:i}function pb(){return(pb="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=db(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}}).apply(null,arguments)}function db(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=vb(t)););return t}function vb(t){return(vb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function gb(t,e){return(gb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var mb=function(t){function e(t,n,r,i){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),hb(this,e,[t,n,r,i])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&gb(t,e)}(e,t),n=e,(r=[{key:"drawFlatCoordinates_",value:function(t,e,n,r){var i=this.coordinates.length,o=this.appendFlatLineCoordinates(t,e,n,r,!1,!1),a=[Wm.MOVE_TO_LINE_TO,i,o];return this.instructions.push(a),this.hitDetectionInstructions.push(a),n}},{key:"drawLineString",value:function(t,e,n){var r=this.state,i=r.strokeStyle,o=r.lineWidth;if(void 0!==i&&void 0!==o){this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(t,e,n),this.hitDetectionInstructions.push([Wm.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Ia,0],Bm);var a=t.getFlatCoordinates(),u=t.getStride();this.drawFlatCoordinates_(a,0,a.length,u),this.hitDetectionInstructions.push(zm),this.endGeometry(e)}}},{key:"drawMultiLineString",value:function(t,e,n){var r=this.state,i=r.strokeStyle,o=r.lineWidth;if(void 0!==i&&void 0!==o){this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(t,e,n),this.hitDetectionInstructions.push([Wm.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Ia,0],Bm);for(var a=t.getEnds(),u=t.getFlatCoordinates(),s=t.getStride(),l=0,c=0,f=a.length;c<f;++c)l=this.drawFlatCoordinates_(u,l,a[c],s);this.hitDetectionInstructions.push(zm),this.endGeometry(e)}}},{key:"finish",value:function(){var t=this.state;return null!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&this.instructions.push(zm),this.reverseHitDetectionInstructions(),this.state=null,yb(e,"finish",this,3)([])}},{key:"applyStroke",value:function(t){null!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(zm),t.lastStroke=this.coordinates.length),t.lastStroke=0,yb(e,"applyStroke",this,3)([t]),this.instructions.push(Bm)}}])&&cb(n.prototype,r),i&&cb(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(Qm);function bb(t){return(bb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _b(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,wb(r.key),r)}}function wb(t){var e=function(t,e){if("object"!=bb(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=bb(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==bb(e)?e:e+""}function Sb(t,e,n){return e=kb(e),function(t,e){if(e&&("object"==bb(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],kb(t).constructor):e.apply(t,n))}function xb(){return(xb="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=Ob(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}}).apply(null,arguments)}function Ob(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=kb(t)););return t}function kb(t){return(kb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Pb(t,e){return(Pb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Eb=function(t){function e(t,n,r,i){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Sb(this,e,[t,n,r,i])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Pb(t,e)}(e,t),function(t,e,n){return e&&_b(t.prototype,e),n&&_b(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(e,[{key:"drawFlatCoordinatess_",value:function(t,e,n,r){var i=this.state,o=void 0!==i.fillStyle,a=void 0!==i.strokeStyle,u=n.length;this.instructions.push(Bm),this.hitDetectionInstructions.push(Bm);for(var s=0;s<u;++s){var l=n[s],c=this.coordinates.length,f=this.appendFlatLineCoordinates(t,e,l,r,!0,!a),h=[Wm.MOVE_TO_LINE_TO,c,f];this.instructions.push(h),this.hitDetectionInstructions.push(h),a&&(this.instructions.push(Gm),this.hitDetectionInstructions.push(Gm)),e=l}return o&&(this.instructions.push(Nm),this.hitDetectionInstructions.push(Nm)),a&&(this.instructions.push(zm),this.hitDetectionInstructions.push(zm)),e}},{key:"drawCircle",value:function(t,e,n){var r=this.state,i=r.fillStyle,o=r.strokeStyle;if(void 0!==i||void 0!==o){this.setFillStrokeStyles_(),this.beginGeometry(t,e,n),void 0!==r.fillStyle&&this.hitDetectionInstructions.push([Wm.SET_FILL_STYLE,"#000"]),void 0!==r.strokeStyle&&this.hitDetectionInstructions.push([Wm.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Ia,0]);var a=t.getFlatCoordinates(),u=t.getStride(),s=this.coordinates.length;this.appendFlatLineCoordinates(a,0,a.length,u,!1,!1);var l=[Wm.CIRCLE,s];this.instructions.push(Bm,l),this.hitDetectionInstructions.push(Bm,l),void 0!==r.fillStyle&&(this.instructions.push(Nm),this.hitDetectionInstructions.push(Nm)),void 0!==r.strokeStyle&&(this.instructions.push(zm),this.hitDetectionInstructions.push(zm)),this.endGeometry(e)}}},{key:"drawPolygon",value:function(t,e,n){var r=this.state,i=r.fillStyle,o=r.strokeStyle;if(void 0!==i||void 0!==o){this.setFillStrokeStyles_(),this.beginGeometry(t,e,n),void 0!==r.fillStyle&&this.hitDetectionInstructions.push([Wm.SET_FILL_STYLE,"#000"]),void 0!==r.strokeStyle&&this.hitDetectionInstructions.push([Wm.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Ia,0]);var a=t.getEnds(),u=t.getOrientedFlatCoordinates(),s=t.getStride();this.drawFlatCoordinatess_(u,0,a,s),this.endGeometry(e)}}},{key:"drawMultiPolygon",value:function(t,e,n){var r=this.state,i=r.fillStyle,o=r.strokeStyle;if(void 0!==i||void 0!==o){this.setFillStrokeStyles_(),this.beginGeometry(t,e,n),void 0!==r.fillStyle&&this.hitDetectionInstructions.push([Wm.SET_FILL_STYLE,"#000"]),void 0!==r.strokeStyle&&this.hitDetectionInstructions.push([Wm.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Ia,0]);for(var a=t.getEndss(),u=t.getOrientedFlatCoordinates(),s=t.getStride(),l=0,c=0,f=a.length;c<f;++c)l=this.drawFlatCoordinatess_(u,l,a[c],s);this.endGeometry(e)}}},{key:"finish",value:function(){this.reverseHitDetectionInstructions(),this.state=null;var t,n,r,i,o,a=this.tolerance;if(0!==a)for(var u=this.coordinates,s=0,l=u.length;s<l;++s)u[s]=vr(u[s],a);return(t=e,n="finish",r=this,o=xb(kb(1&(i=3)?t.prototype:t),n,r),2&i&&"function"==typeof o?function(t){return o.apply(r,t)}:o)([])}},{key:"setFillStrokeStyles_",value:function(){var t=this.state;void 0!==t.fillStyle&&this.updateFillStyle(t,this.createFill),void 0!==t.strokeStyle&&this.updateStrokeStyle(t,this.applyStroke)}}])}(Qm);function jb(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,u=[],s=!0,l=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=o.call(n)).done)&&(u.push(r.value),u.length!==e);s=!0);}catch(t){l=!0,i=t}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return u}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Cb(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Cb(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Cb(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Tb(t,e,n,r,i){for(var o=[],a=n,u=0,s=e.slice(n,2);u<t&&a+i<r;){var l=jb(s.slice(-2),2),c=l[0],f=l[1],h=e[a+i],y=e[a+i+1],p=Math.sqrt((h-c)*(h-c)+(y-f)*(y-f));if((u+=p)>=t){var d=(t-u+p)/p,v=We(c,h,d),g=We(f,y,d);s.push(v,g),o.push(s),s=[v,g],u==t&&(a+=i),u=0}else if(u<t)s.push(e[a+i],e[a+i+1]),a+=i;else{var m=p-u,b=We(c,h,m/p),_=We(f,y,m/p);s.push(b,_),o.push(s),s=[b,_],u=0,a+=i}}return u>0&&o.push(s),o}function Rb(t,e,n,r,i){var o,a,u,s,l,c,f,h,y,p=n,d=n,v=0,g=0,m=n;for(o=n;o<r;o+=i){var b=e[o],_=e[o+1];void 0!==s&&(h=b-s,y=_-l,u=Math.sqrt(h*h+y*y),void 0!==c&&(g+=a,Math.acos((c*h+f*y)/(a*u))>t&&(g>v&&(v=g,p=m,d=o),g=0,m=o-i)),a=u,c=h,f=y),s=b,l=_}return(g+=u)>v?[m,o]:[p,d]}function Ib(t){return(Ib="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Mb(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Lb(r.key),r)}}function Lb(t){var e=function(t,e){if("object"!=Ib(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Ib(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Ib(e)?e:e+""}function Ab(t,e,n){return e=Nb(e),function(t,e){if(e&&("object"==Ib(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],Nb(t).constructor):e.apply(t,n))}function Fb(){return(Fb="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=Db(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}}).apply(null,arguments)}function Db(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=Nb(t)););return t}function Nb(t){return(Nb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function zb(t,e){return(zb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Bb={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};function Gb(t){return(Gb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Wb(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Xb(r.key),r)}}function Xb(t){var e=function(t,e){if("object"!=Gb(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Gb(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Gb(e)?e:e+""}var Yb={Circle:Eb,Default:Qm,Image:sb,LineString:mb,Polygon:Eb,Text:function(t){function e(t,n,r,i){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=Ab(this,e,[t,n,r,i])).labels_=null,o.text_="",o.textOffsetX_=0,o.textOffsetY_=0,o.textRotateWithView_=void 0,o.textRotation_=0,o.textFillState_=null,o.fillStates={},o.fillStates["#000"]={fillStyle:"#000"},o.textStrokeState_=null,o.strokeStates={},o.textState_={},o.textStates={},o.textKey_="",o.fillKey_="",o.strokeKey_="",o.declutterMode_=void 0,o.declutterImageWithText_=void 0,o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&zb(t,e)}(e,t),function(t,e,n){return e&&Mb(t.prototype,e),n&&Mb(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(e,[{key:"finish",value:function(){var t,n,r,i,o,a=(t=e,n="finish",r=this,o=Fb(Nb(1&(i=3)?t.prototype:t),n,r),2&i&&"function"==typeof o?function(t){return o.apply(r,t)}:o)([]);return a.textStates=this.textStates,a.fillStates=this.fillStates,a.strokeStates=this.strokeStates,a}},{key:"drawText",value:function(t,e,n){var r=this.textFillState_,i=this.textStrokeState_,o=this.textState_;if(""!==this.text_&&o&&(r||i)){var a=this.coordinates,u=a.length,s=t.getType(),l=null,c=t.getStride();if("line"!==o.placement||"LineString"!=s&&"MultiLineString"!=s&&"Polygon"!=s&&"MultiPolygon"!=s){var f=o.overflow?null:[];switch(s){case"Point":case"MultiPoint":l=t.getFlatCoordinates();break;case"LineString":l=t.getFlatMidpoint();break;case"Circle":l=t.getCenter();break;case"MultiLineString":l=t.getFlatMidpoints(),c=2;break;case"Polygon":l=t.getFlatInteriorPoint(),o.overflow||f.push(l[2]/this.resolution),c=3;break;case"MultiPolygon":var h=t.getFlatInteriorPoints();l=[];for(var y=0,p=h.length;y<p;y+=3)o.overflow||f.push(h[y+2]/this.resolution),l.push(h[y],h[y+1]);if(0===l.length)return;c=2}var d=this.appendFlatPointCoordinates(l,c);if(d===u)return;if(f&&(d-u)/2!=l.length/c){var v=u/2;f=f.filter((function(t,e){var n=a[2*(v+e)]===l[e*c]&&a[2*(v+e)+1]===l[e*c+1];return n||--v,n}))}this.saveTextStates_(),(o.backgroundFill||o.backgroundStroke)&&(this.setFillStrokeStyle(o.backgroundFill,o.backgroundStroke),o.backgroundFill&&this.updateFillStyle(this.state,this.createFill),o.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,e,n);var g=o.padding;if(g!=Ma&&(o.scale[0]<0||o.scale[1]<0)){var m=o.padding[0],b=o.padding[1],_=o.padding[2],w=o.padding[3];o.scale[0]<0&&(b=-b,w=-w),o.scale[1]<0&&(m=-m,_=-_),g=[m,b,_,w]}var S=this.pixelRatio;this.instructions.push([Wm.DRAW_IMAGE,u,d,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,g==Ma?Ma:g.map((function(t){return t*S})),!!o.backgroundFill,!!o.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,f]);var x=1/S,O=this.state.fillStyle;o.backgroundFill&&(this.state.fillStyle="#000",this.hitDetectionInstructions.push(this.createFill(this.state))),this.hitDetectionInstructions.push([Wm.DRAW_IMAGE,u,d,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[x,x],NaN,this.declutterMode_,this.declutterImageWithText_,g,!!o.backgroundFill,!!o.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?"#000":this.fillKey_,this.textOffsetX_,this.textOffsetY_,f]),o.backgroundFill&&(this.state.fillStyle=O,this.hitDetectionInstructions.push(this.createFill(this.state))),this.endGeometry(e)}else{if(!Ie(this.maxExtent,t.getExtent()))return;var k;if(l=t.getFlatCoordinates(),"LineString"==s)k=[l.length];else if("MultiLineString"==s)k=t.getEnds();else if("Polygon"==s)k=t.getEnds().slice(0,1);else if("MultiPolygon"==s){var P=t.getEndss();k=[];for(var E=0,j=P.length;E<j;++E)k.push(P[E][0])}this.beginGeometry(t,e,n);for(var C=o.repeat,T=C?void 0:o.textAlign,R=0,I=0,M=k.length;I<M;++I)for(var L=void 0,A=0,F=(L=C?Tb(C*this.resolution,l,R,k[I],c):[l.slice(R,k[I])]).length;A<F;++A){var D=L[A],N=0,z=D.length;if(null==T){var B=Rb(o.maxAngle,D,0,D.length,2);N=B[0],z=B[1]}for(var G=N;G<z;G+=c)a.push(D[G],D[G+1]);var W=a.length;R=k[I],this.drawChars_(u,W),u=W}this.endGeometry(e)}}}},{key:"saveTextStates_",value:function(){var t=this.textStrokeState_,e=this.textState_,n=this.textFillState_,r=this.strokeKey_;t&&(r in this.strokeStates||(this.strokeStates[r]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));var i=this.textKey_;i in this.textStates||(this.textStates[i]={font:e.font,textAlign:e.textAlign||"center",justify:e.justify,textBaseline:e.textBaseline||"middle",scale:e.scale});var o=this.fillKey_;n&&(o in this.fillStates||(this.fillStates[o]={fillStyle:n.fillStyle}))}},{key:"drawChars_",value:function(t,e){var n=this.textStrokeState_,r=this.textState_,i=this.strokeKey_,o=this.textKey_,a=this.fillKey_;this.saveTextStates_();var u=this.pixelRatio,s=Bb[r.textBaseline],l=this.textOffsetY_*u,c=this.text_,f=n?n.lineWidth*Math.abs(r.scale[0])/2:0;this.instructions.push([Wm.DRAW_CHARS,t,e,s,r.overflow,a,r.maxAngle,u,l,i,f*u,c,o,1,this.declutterMode_]),this.hitDetectionInstructions.push([Wm.DRAW_CHARS,t,e,s,r.overflow,a?"#000":a,r.maxAngle,u,l,i,f*u,c,o,1/u,this.declutterMode_])}},{key:"setTextStyle",value:function(t,e){var n,r,i;if(t){var o=t.getFill();o?((r=this.textFillState_)||(r={},this.textFillState_=r),r.fillStyle=Oa(o.getColor()||"#000")):(r=null,this.textFillState_=r);var a=t.getStroke();if(a){(i=this.textStrokeState_)||(i={},this.textStrokeState_=i);var u=a.getLineDash(),s=a.getLineDashOffset(),l=a.getWidth(),c=a.getMiterLimit();i.lineCap=a.getLineCap()||"round",i.lineDash=u?u.slice():Ia,i.lineDashOffset=void 0===s?0:s,i.lineJoin=a.getLineJoin()||"round",i.lineWidth=void 0===l?1:l,i.miterLimit=void 0===c?10:c,i.strokeStyle=Oa(a.getColor()||"#000")}else i=null,this.textStrokeState_=i;n=this.textState_;var f=t.getFont()||"10px sans-serif";Da(f);var h=t.getScaleArray();n.overflow=t.getOverflow(),n.font=f,n.maxAngle=t.getMaxAngle(),n.placement=t.getPlacement(),n.textAlign=t.getTextAlign(),n.repeat=t.getRepeat(),n.justify=t.getJustify(),n.textBaseline=t.getTextBaseline()||"middle",n.backgroundFill=t.getBackgroundFill(),n.backgroundStroke=t.getBackgroundStroke(),n.padding=t.getPadding()||Ma,n.scale=void 0===h?[1,1]:h;var y=t.getOffsetX(),p=t.getOffsetY(),d=t.getRotateWithView(),v=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=void 0===y?0:y,this.textOffsetY_=void 0===p?0:p,this.textRotateWithView_=void 0!==d&&d,this.textRotation_=void 0===v?0:v,this.strokeKey_=i?("string"==typeof i.strokeStyle?i.strokeStyle:nt(i.strokeStyle))+i.lineCap+i.lineDashOffset+"|"+i.lineWidth+i.lineJoin+i.miterLimit+"["+i.lineDash.join()+"]":"",this.textKey_=n.font+n.scale+(n.textAlign||"?")+(n.repeat||"?")+(n.justify||"?")+(n.textBaseline||"?"),this.fillKey_=r&&r.fillStyle?"string"==typeof r.fillStyle?r.fillStyle:"|"+nt(r.fillStyle):""}else this.text_="";this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}}])}(Qm)},Kb=function(){return t=function t(e,n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.tolerance_=e,this.maxExtent_=n,this.pixelRatio_=i,this.resolution_=r,this.buildersByZIndex_={}},(e=[{key:"finish",value:function(){var t={};for(var e in this.buildersByZIndex_){t[e]=t[e]||{};var n=this.buildersByZIndex_[e];for(var r in n){var i=n[r].finish();t[e][r]=i}}return t}},{key:"getBuilder",value:function(t,e){var n=void 0!==t?t.toString():"0",r=this.buildersByZIndex_[n];void 0===r&&(r={},this.buildersByZIndex_[n]=r);var i=r[e];return void 0===i&&(i=new(0,Yb[e])(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),r[e]=i),i}}])&&Wb(t.prototype,e),n&&Wb(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}();function Zb(t,e,n,r,i,o,a,u,s,l,c,f){var h=t[e],y=t[e+1],p=0,d=0,v=0,g=0;function m(){p=h,d=y,h=t[e+=r],y=t[e+1],g+=v,v=Math.sqrt((h-p)*(h-p)+(y-d)*(y-d))}do{m()}while(e<n-r&&g+v<o);for(var b=0===v?0:(o-g)/v,_=We(p,h,b),w=We(d,y,b),S=e-r,x=g,O=o+u*s(l,i,c);e<n-r&&g+v<O;)m();var k,P=We(p,h,b=0===v?0:(O-g)/v),E=We(d,y,b);if(f){var j=[_,w,P,E];Kn(j,0,4,2,f,j,j),k=j[0]>j[2]}else k=_>P;var C,T=Math.PI,R=[],I=S+r===e;if(v=0,g=x,h=t[e=S],y=t[e+1],I){m(),C=Math.atan2(y-d,h-p),k&&(C+=C>0?-T:T);var M=(P+_)/2,L=(E+w)/2;return R[0]=[M,L,(O-o)/2,C,i],R}for(var A=0,F=(i=i.replace(/\n/g," ")).length;A<F;){m();var D=Math.atan2(y-d,h-p);if(k&&(D+=D>0?-T:T),void 0!==C){var N=D-C;if(N+=N>T?-2*T:N<-T?2*T:0,Math.abs(N)>a)return null}C=D;for(var z=A,B=0;A<F;++A){var G=u*s(l,i[k?F-A-1:A],c);if(e+r<n&&g+v<o+B+G/2)break;B+=G}if(A!==z){var W=k?i.substring(F-z,F-A):i.substring(z,A),X=We(p,h,b=0===v?0:(o+B/2-g)/v),Y=We(d,y,b);R.push([X,Y,B/2,D,W]),o+=B}}return R}function Ub(t,e,n,r){for(var i=t[e],o=t[e+1],a=0,u=e+r;u<n;u+=r){var s=t[u],l=t[u+1];a+=Math.sqrt((s-i)*(s-i)+(l-o)*(l-o)),i=s,o=l}return a}function Vb(t){return(Vb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qb(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Hb(r.key),r)}}function Hb(t){var e=function(t,e){if("object"!=Vb(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Vb(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Vb(e)?e:e+""}var Jb=[1/0,1/0,-1/0,-1/0],$b=[],Qb=[],t_=[],e_=[];function n_(t){return t[3].declutterBox}var r_=new RegExp("["+String.fromCharCode(1425)+"-"+String.fromCharCode(2303)+String.fromCharCode(64285)+"-"+String.fromCharCode(65023)+String.fromCharCode(65136)+"-"+String.fromCharCode(65276)+String.fromCharCode(67584)+"-"+String.fromCharCode(69631)+String.fromCharCode(124928)+"-"+String.fromCharCode(126975)+"]");function i_(t,e){return"start"===e?e=r_.test(t)?"right":"left":"end"===e&&(e=r_.test(t)?"left":"right"),Bb[e]}function o_(t,e,n){return n>0&&t.push("\n",""),t.push(e,""),t}var a_=function(){return function(t,e,n){return e&&qb(t.prototype,e),n&&qb(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}((function t(e,n,r,i,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.overlaps=r,this.pixelRatio=n,this.resolution=e,this.alignAndScaleFill_,this.instructions=i.instructions,this.coordinates=i.coordinates,this.coordinateCache_={},this.renderedTransform_=[1,0,0,1,0,0],this.hitDetectionInstructions=i.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=i.fillStates||{},this.strokeStates=i.strokeStates||{},this.textStates=i.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=o?new yd:null}),[{key:"getZIndexContext",value:function(){return this.zIndexContext_}},{key:"createLabel",value:function(t,e,n,r){var i=t+e+n+r;if(this.labels_[i])return this.labels_[i];var o=r?this.strokeStates[r]:null,a=n?this.fillStates[n]:null,u=this.textStates[e],s=this.pixelRatio,l=[u.scale[0]*s,u.scale[1]*s],c=u.justify?Bb[u.justify]:i_(Array.isArray(t)?t[0]:t,u.textAlign||"center"),f=r&&o.lineWidth?o.lineWidth:0,h=Array.isArray(t)?t:String(t).split("\n").reduce(o_,[]),y=function(t,e){for(var n=[],r=[],i=[],o=0,a=0,u=0,s=0,l=0,c=e.length;l<=c;l+=2){var f=e[l];if("\n"!==f&&l!==c){var h=e[l+1]||t.font,y=Ba(h,f);n.push(y),a+=y;var p=Na(h);r.push(p),s=Math.max(s,p)}else o=Math.max(o,a),i.push(a),a=0,u+=s,s=0}return{width:o,height:u,widths:n,heights:r,lineWidths:i}}(u,h),p=y.width,d=y.height,v=y.widths,g=y.heights,m=y.lineWidths,b=p+f,_=[],w=(b+2)*l[0],S=(d+f)*l[1],x={width:w<0?Math.floor(w):Math.ceil(w),height:S<0?Math.floor(S):Math.ceil(S),contextInstructions:_};1==l[0]&&1==l[1]||_.push("scale",l),r&&(_.push("strokeStyle",o.strokeStyle),_.push("lineWidth",f),_.push("lineCap",o.lineCap),_.push("lineJoin",o.lineJoin),_.push("miterLimit",o.miterLimit),_.push("setLineDash",[o.lineDash]),_.push("lineDashOffset",o.lineDashOffset)),n&&_.push("fillStyle",a.fillStyle),_.push("textBaseline","middle"),_.push("textAlign","center");for(var O,k=.5-c,P=c*b+k*f,E=[],j=[],C=0,T=0,R=0,I=0,M=0,L=h.length;M<L;M+=2){var A=h[M];if("\n"!==A){var F=h[M+1]||u.font;F!==O&&(r&&E.push("font",F),n&&j.push("font",F),O=F),C=Math.max(C,g[R]);var D=[A,P+k*v[R]+c*(v[R]-m[I]),.5*(f+C)+T];P+=v[R],r&&E.push("strokeText",D),n&&j.push("fillText",D),++R}else T+=C,C=0,P=c*b+k*f,++I}return Array.prototype.push.apply(_,E),Array.prototype.push.apply(_,j),this.labels_[i]=x,x}},{key:"replayTextBackground_",value:function(t,e,n,r,i,o,a){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,n),t.lineTo.apply(t,r),t.lineTo.apply(t,i),t.lineTo.apply(t,e),o&&(this.alignAndScaleFill_=o[2],this.fill_(t)),a&&(this.setStrokeStyle_(t,a),t.stroke())}},{key:"calculateImageOrLabelDimensions_",value:function(t,e,n,r,i,o,a,u,s,l,c,f,h,y,p,d){var v,g=n-(a*=f[0]),m=r-(u*=f[1]),b=i+s>t?t-s:i,_=o+l>e?e-l:o,w=y[3]+b*f[0]+y[1],S=y[0]+_*f[1]+y[2],x=g-y[3],O=m-y[0];return(p||0!==c)&&($b[0]=x,e_[0]=x,$b[1]=O,Qb[1]=O,Qb[0]=x+w,t_[0]=Qb[0],t_[1]=O+S,e_[1]=t_[1]),0!==c?(zn(v=Bn([1,0,0,1,0,0],n,r,1,1,c,-n,-r),$b),zn(v,Qb),zn(v,t_),zn(v,e_),he(Math.min($b[0],Qb[0],t_[0],e_[0]),Math.min($b[1],Qb[1],t_[1],e_[1]),Math.max($b[0],Qb[0],t_[0],e_[0]),Math.max($b[1],Qb[1],t_[1],e_[1]),Jb)):he(Math.min(x,x+w),Math.min(O,O+S),Math.max(x,x+w),Math.max(O,O+S),Jb),h&&(g=Math.round(g),m=Math.round(m)),{drawImageX:g,drawImageY:m,drawImageW:b,drawImageH:_,originX:s,originY:l,declutterBox:{minX:Jb[0],minY:Jb[1],maxX:Jb[2],maxY:Jb[3],value:d},canvasTransform:v,scale:f}}},{key:"replayImageOrLabel_",value:function(t,e,n,r,i,o,a){var u=!(!o&&!a),s=r.declutterBox,l=a?a[2]*r.scale[0]/2:0;return s.minX-l<=e[0]&&s.maxX+l>=0&&s.minY-l<=e[1]&&s.maxY+l>=0&&(u&&this.replayTextBackground_(t,$b,Qb,t_,e_,o,a),Wa(t,r.canvasTransform,i,n,r.originX,r.originY,r.drawImageW,r.drawImageH,r.drawImageX,r.drawImageY,r.scale)),!0}},{key:"fill_",value:function(t){var e=this.alignAndScaleFill_;if(e){var n=zn(this.renderedTransform_,[0,0]),r=512*this.pixelRatio;t.save(),t.translate(n[0]%r,n[1]%r),1!==e&&t.scale(e,e),t.rotate(this.viewRotation_)}t.fill(),e&&t.restore()}},{key:"setStrokeStyle_",value:function(t,e){t.strokeStyle=e[1],t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],t.lineDashOffset=e[7],t.setLineDash(e[6])}},{key:"drawLabelWithPointPlacement_",value:function(t,e,n,r){var i=this.textStates[e],o=this.createLabel(t,e,r,n),a=this.strokeStates[n],u=this.pixelRatio,s=i_(Array.isArray(t)?t[0]:t,i.textAlign||"center"),l=Bb[i.textBaseline||"middle"],c=a&&a.lineWidth?a.lineWidth:0;return{label:o,anchorX:s*(o.width/u-2*i.scale[0])+2*(.5-s)*c,anchorY:l*o.height/u+2*(.5-l)*c}}},{key:"execute_",value:function(t,e,n,r,i,o,a,u){var s,l,c,f=this.zIndexContext_;this.pixelCoordinates_&&m(n,this.renderedTransform_)?s=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),s=Yn(this.coordinates,0,this.coordinates.length,2,n,this.pixelCoordinates_),l=this.renderedTransform_,c=n,l[0]=c[0],l[1]=c[1],l[2]=c[2],l[3]=c[3],l[4]=c[4],l[5]=c[5]);for(var h,y,p,d,v,g,b,_,w,S,x,O,k,P,E,j,C,T=0,R=r.length,I=0,M=0,L=0,A=null,F=null,D=this.coordinateCache_,N=this.viewRotation_,z=Math.round(1e12*Math.atan2(-n[1],n[0]))/1e12,B={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:N},G=this.instructions!=r||this.overlaps?0:200;T<R;){var W=r[T];switch(W[0]){case Wm.BEGIN_GEOMETRY:P=W[1],C=W[3],P.getGeometry()?void 0===a||Ie(a,C.getExtent())?++T:T=W[2]+1:T=W[2],f&&(f.zIndex=W[4]);break;case Wm.BEGIN_PATH:M>G&&(this.fill_(t),M=0),L>G&&(t.stroke(),L=0),M||L||(t.beginPath(),v=NaN,g=NaN),++T;break;case Wm.CIRCLE:var X=s[I=W[1]],Y=s[I+1],K=s[I+2]-X,Z=s[I+3]-Y,U=Math.sqrt(K*K+Z*Z);t.moveTo(X+U,Y),t.arc(X,Y,U,0,2*Math.PI,!0),++T;break;case Wm.CLOSE_PATH:t.closePath(),++T;break;case Wm.CUSTOM:I=W[1],h=W[2];var V=W[3],q=W[4],H=W[5];B.geometry=V,B.feature=P,T in D||(D[T]=[]);var J=D[T];H?H(s,I,h,2,J):(J[0]=s[I],J[1]=s[I+1],J.length=2),f&&(f.zIndex=W[6]),q(J,B),++T;break;case Wm.DRAW_IMAGE:I=W[1],h=W[2],w=W[3],y=W[4],p=W[5];var $=W[6],Q=W[7],tt=W[8],et=W[9],nt=W[10],rt=W[11],it=W[12],ot=W[13];d=W[14]||"declutter";var at=W[15];if(!w&&W.length>=20){S=W[19],x=W[20],O=W[21],k=W[22];var ut=this.drawLabelWithPointPlacement_(S,x,O,k);w=ut.label,W[3]=w;var st=W[23];y=(ut.anchorX-st)*this.pixelRatio,W[4]=y;var lt=W[24];p=(ut.anchorY-lt)*this.pixelRatio,W[5]=p,$=w.height,W[6]=$,ot=w.width,W[13]=ot}var ct=void 0;W.length>25&&(ct=W[25]);var ft=void 0,ht=void 0,yt=void 0;W.length>17?(ft=W[16],ht=W[17],yt=W[18]):(ft=Ma,ht=!1,yt=!1),nt&&z?rt+=N:nt||z||(rt-=N);for(var pt=0;I<h;I+=2)if(!(ct&&ct[pt++]<ot/this.pixelRatio)){var dt=this.calculateImageOrLabelDimensions_(w.width,w.height,s[I],s[I+1],ot,$,y,p,tt,et,rt,it,i,ft,ht||yt,P),vt=[t,e,w,dt,Q,ht?A:null,yt?F:null];if(u){var gt=void 0,mt=void 0,bt=void 0;if(at){var _t=h-I;if(!at[_t]){at[_t]={args:vt,declutterMode:d};continue}var wt=at[_t];gt=wt.args,mt=wt.declutterMode,delete at[_t],bt=n_(gt)}var St=void 0,xt=void 0;if(!gt||"declutter"===mt&&u.collides(bt)||(St=!0),"declutter"===d&&u.collides(dt.declutterBox)||(xt=!0),"declutter"===mt&&"declutter"===d){var Ot=St&&xt;St=Ot,xt=Ot}St&&("none"!==mt&&u.insert(bt),this.replayImageOrLabel_.apply(this,gt)),xt&&("none"!==d&&u.insert(dt.declutterBox),this.replayImageOrLabel_.apply(this,vt))}else this.replayImageOrLabel_.apply(this,vt)}++T;break;case Wm.DRAW_CHARS:var kt=W[1],Pt=W[2],Et=W[3],jt=W[4];k=W[5];var Ct=W[6],Tt=W[7],Rt=W[8];O=W[9];var It=W[10];S=W[11],x=W[12];var Mt=[W[13],W[13]];d=W[14]||"declutter";var Lt=this.textStates[x],At=Lt.font,Ft=[Lt.scale[0]*Tt,Lt.scale[1]*Tt],Dt=void 0;At in this.widths_?Dt=this.widths_[At]:(Dt={},this.widths_[At]=Dt);var Nt=Ub(s,kt,Pt,2),zt=Math.abs(Ft[0])*Ga(At,S,Dt);if(jt||zt<=Nt){var Bt=Zb(s,kt,Pt,2,S,(Nt-zt)*i_(S,this.textStates[x].textAlign),Ct,Math.abs(Ft[0]),Ga,At,Dt,z?0:this.viewRotation_);t:if(Bt){var Gt=[],Wt=void 0,Xt=void 0,Yt=void 0,Kt=void 0,Zt=void 0;if(O)for(Wt=0,Xt=Bt.length;Wt<Xt;++Wt){Yt=(Zt=Bt[Wt])[4],Kt=this.createLabel(Yt,x,"",O),y=Zt[2]+(Ft[0]<0?-It:It),p=Et*Kt.height+2*(.5-Et)*It*Ft[1]/Ft[0]-Rt;var Ut=this.calculateImageOrLabelDimensions_(Kt.width,Kt.height,Zt[0],Zt[1],Kt.width,Kt.height,y,p,0,0,Zt[3],Mt,!1,Ma,!1,P);if(u&&"declutter"===d&&u.collides(Ut.declutterBox))break t;Gt.push([t,e,Kt,Ut,1,null,null])}if(k)for(Wt=0,Xt=Bt.length;Wt<Xt;++Wt){Yt=(Zt=Bt[Wt])[4],Kt=this.createLabel(Yt,x,k,""),y=Zt[2],p=Et*Kt.height-Rt;var Vt=this.calculateImageOrLabelDimensions_(Kt.width,Kt.height,Zt[0],Zt[1],Kt.width,Kt.height,y,p,0,0,Zt[3],Mt,!1,Ma,!1,P);if(u&&"declutter"===d&&u.collides(Vt.declutterBox))break t;Gt.push([t,e,Kt,Vt,1,null,null])}u&&"none"!==d&&u.load(Gt.map(n_));for(var qt=0,Ht=Gt.length;qt<Ht;++qt)this.replayImageOrLabel_.apply(this,Gt[qt])}}++T;break;case Wm.END_GEOMETRY:if(void 0!==o){var Jt=o(P=W[1],C,d);if(Jt)return Jt}++T;break;case Wm.FILL:G?M++:this.fill_(t),++T;break;case Wm.MOVE_TO_LINE_TO:for(I=W[1],h=W[2],E=s[I],j=s[I+1],t.moveTo(E,j),v=E+.5|0,g=j+.5|0,I+=2;I<h;I+=2)b=(E=s[I])+.5|0,_=(j=s[I+1])+.5|0,I!=h-2&&b===v&&_===g||(t.lineTo(E,j),v=b,g=_);++T;break;case Wm.SET_FILL_STYLE:A=W,this.alignAndScaleFill_=W[2],M&&(this.fill_(t),M=0,L&&(t.stroke(),L=0)),t.fillStyle=W[1],++T;break;case Wm.SET_STROKE_STYLE:F=W,L&&(t.stroke(),L=0),this.setStrokeStyle_(t,W),++T;break;case Wm.STROKE:G?L++:t.stroke(),++T;break;default:++T}}M&&this.fill_(t),L&&t.stroke()}},{key:"execute",value:function(t,e,n,r,i,o){this.viewRotation_=r,this.execute_(t,e,n,this.instructions,i,void 0,void 0,o)}},{key:"executeHitDetection",value:function(t,e,n,r,i){return this.viewRotation_=n,this.execute_(t,[t.canvas.width,t.canvas.height],e,this.hitDetectionInstructions,!0,r,i)}}])}();function u_(t){return function(t){if(Array.isArray(t))return s_(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return s_(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s_(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s_(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function l_(t){return(l_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c_(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,f_(r.key),r)}}function f_(t){var e=function(t,e){if("object"!=l_(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=l_(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==l_(e)?e:e+""}var h_=["Polygon","Circle","LineString","Image","Text","Default"],y_=["Image","Text"],p_=h_.filter((function(t){return!y_.includes(t)})),d_=function(){return t=function t(e,n,r,i,o,a,u){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.maxExtent_=e,this.overlaps_=i,this.pixelRatio_=r,this.resolution_=n,this.renderBuffer_=a,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=[1,0,0,1,0,0],this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(o,u)},(e=[{key:"clip",value:function(t,e){var n=this.getClipCoords(e);t.beginPath(),t.moveTo(n[0],n[1]),t.lineTo(n[2],n[3]),t.lineTo(n[4],n[5]),t.lineTo(n[6],n[7]),t.clip()}},{key:"createExecutors_",value:function(t,e){for(var n in t){var r=this.executorsByZIndex_[n];void 0===r&&(r={},this.executorsByZIndex_[n]=r);var i=t[n];for(var o in i){var a=i[o];r[o]=new a_(this.resolution_,this.pixelRatio_,this.overlaps_,a,e)}}}},{key:"hasExecutors",value:function(t){for(var e in this.executorsByZIndex_)for(var n=this.executorsByZIndex_[e],r=0,i=t.length;r<i;++r)if(t[r]in n)return!0;return!1}},{key:"forEachFeatureAtCoordinate",value:function(t,e,n,r,i,o){var a=2*(r=Math.round(r))+1,u=Bn(this.hitDetectionTransform_,r+.5,r+.5,1/e,-1/e,-n,-t[0],-t[1]),s=!this.hitDetectionContext_;s&&(this.hitDetectionContext_=ta(a,a,void 0,{willReadFrequently:!0}));var l,c=this.hitDetectionContext_;c.canvas.width!==a||c.canvas.height!==a?(c.canvas.width=a,c.canvas.height=a):s||c.clearRect(0,0,a,a),void 0!==this.renderBuffer_&&(ge(l=[1/0,1/0,-1/0,-1/0],t),ie(l,e*(this.renderBuffer_+r),l));var f,h=function(t){if(void 0!==v_[t])return v_[t];for(var e=2*t+1,n=t*t,r=new Array(n+1),i=0;i<=t;++i)for(var o=0;o<=t;++o){var a=i*i+o*o;if(a>n)break;var u=r[a];u||(u=[],r[a]=u),u.push(4*((t+i)*e+(t+o))+3),i>0&&u.push(4*((t-i)*e+(t+o))+3),o>0&&(u.push(4*((t+i)*e+(t-o))+3),i>0&&u.push(4*((t-i)*e+(t-o))+3))}for(var s=[],l=0,c=r.length;l<c;++l)r[l]&&s.push.apply(s,u_(r[l]));return v_[t]=s,s}(r);function y(t,e,n){for(var u=c.getImageData(0,0,a,a).data,s=0,l=h.length;s<l;s++)if(u[h[s]]>0){if(!o||"none"===n||"Image"!==f&&"Text"!==f||o.includes(t)){var y=(h[s]-3)/4,p=r-y%a,d=r-(y/a|0),v=i(t,e,p*p+d*d);if(v)return v}c.clearRect(0,0,a,a);break}}var d,v,g,m,b,_=Object.keys(this.executorsByZIndex_).map(Number);for(_.sort(p),d=_.length-1;d>=0;--d){var w=_[d].toString();for(g=this.executorsByZIndex_[w],v=h_.length-1;v>=0;--v)if(void 0!==(m=g[f=h_[v]])&&(b=m.executeHitDetection(c,u,n,y,l)))return b}}},{key:"getClipCoords",value:function(t){var e=this.maxExtent_;if(!e)return null;var n=e[0],r=e[1],i=e[2],o=e[3],a=[n,r,n,o,i,o,i,r];return Yn(a,0,8,2,t,a),a}},{key:"isEmpty",value:function(){return k(this.executorsByZIndex_)}},{key:"execute",value:function(t,e,n,r,i,o,a){var u=this,s=Object.keys(this.executorsByZIndex_).map(Number);s.sort(p),o=o||h_;var l,c,f,h,y,d=h_.length;for(a&&s.reverse(),l=0,c=s.length;l<c;++l){var v=s[l].toString();y=this.executorsByZIndex_[v];var g=function(){var c=o[f],h=y[c];if(void 0!==h){var p=null===a?void 0:h.getZIndexContext(),v=p?p.getContext():t,g=u.maxExtent_&&"Image"!==c&&"Text"!==c;if(g&&(v.save(),u.clip(v,n)),p&&"Text"!==c&&"Image"!==c?p.pushFunction((function(t){return h.execute(t,e,n,r,i,a)})):h.execute(v,e,n,r,i,a),g&&v.restore(),p){p.offset();var m=s[l]*d+f;u.deferredZIndexContexts_[m]||(u.deferredZIndexContexts_[m]=[]),u.deferredZIndexContexts_[m].push(p)}}};for(f=0,h=o.length;f<h;++f)g()}this.renderedContext_=t}},{key:"getDeferredZIndexContexts",value:function(){return this.deferredZIndexContexts_}},{key:"getRenderedContext",value:function(){return this.renderedContext_}},{key:"renderDeferred",value:function(){for(var t=this,e=this.deferredZIndexContexts_,n=Object.keys(e).map(Number).sort(p),r=0,i=n.length;r<i;++r)e[n[r]].forEach((function(e){e.draw(t.renderedContext_),e.clear()})),e[n[r]].length=0}}])&&c_(t.prototype,e),n&&c_(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}(),v_={};var g_=d_;function m_(t){return(m_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function b_(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,__(r.key),r)}}function __(t){var e=function(t,e){if("object"!=m_(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=m_(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==m_(e)?e:e+""}function w_(t,e,n){return e=S_(e),function(t,e){if(e&&("object"==m_(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],S_(t).constructor):e.apply(t,n))}function S_(t){return(S_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function x_(t,e){return(x_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var O_=function(t){function e(t,n,r,i,o,a,u){var s;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(s=w_(this,e)).context_=t,s.pixelRatio_=n,s.extent_=r,s.transform_=i,s.transformRotation_=i?Xe(Math.atan2(i[1],i[0]),10):0,s.viewRotation_=o,s.squaredTolerance_=a,s.userTransform_=u,s.contextFillState_=null,s.contextStrokeState_=null,s.contextTextState_=null,s.fillState_=null,s.strokeState_=null,s.image_=null,s.imageAnchorX_=0,s.imageAnchorY_=0,s.imageHeight_=0,s.imageOpacity_=0,s.imageOriginX_=0,s.imageOriginY_=0,s.imageRotateWithView_=!1,s.imageRotation_=0,s.imageScale_=[0,0],s.imageWidth_=0,s.text_="",s.textOffsetX_=0,s.textOffsetY_=0,s.textRotateWithView_=!1,s.textRotation_=0,s.textScale_=[0,0],s.textFillState_=null,s.textStrokeState_=null,s.textState_=null,s.pixelCoordinates_=[],s.tmpLocalTransform_=[1,0,0,1,0,0],s}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&x_(t,e)}(e,t),n=e,(r=[{key:"drawImages_",value:function(t,e,n,r){if(this.image_){var i=Yn(t,e,n,r,this.transform_,this.pixelCoordinates_),o=this.context_,a=this.tmpLocalTransform_,u=o.globalAlpha;1!=this.imageOpacity_&&(o.globalAlpha=u*this.imageOpacity_);var s=this.imageRotation_;0===this.transformRotation_&&(s-=this.viewRotation_),this.imageRotateWithView_&&(s+=this.viewRotation_);for(var l=0,c=i.length;l<c;l+=2){var f=i[l]-this.imageAnchorX_,h=i[l+1]-this.imageAnchorY_;if(0!==s||1!=this.imageScale_[0]||1!=this.imageScale_[1]){var y=f+this.imageAnchorX_,p=h+this.imageAnchorY_;Bn(a,y,p,1,1,s,-y,-p),o.save(),o.transform.apply(o,a),o.translate(y,p),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.restore()}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,f,h,this.imageWidth_,this.imageHeight_)}1!=this.imageOpacity_&&(o.globalAlpha=u)}}},{key:"drawText_",value:function(t,e,n,r){if(this.textState_&&""!==this.text_){this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);var i=Yn(t,e,n,r,this.transform_,this.pixelCoordinates_),o=this.context_,a=this.textRotation_;for(0===this.transformRotation_&&(a-=this.viewRotation_),this.textRotateWithView_&&(a+=this.viewRotation_);e<n;e+=r){var u=i[e]+this.textOffsetX_,s=i[e+1]+this.textOffsetY_;0!==a||1!=this.textScale_[0]||1!=this.textScale_[1]?(o.save(),o.translate(u-this.textOffsetX_,s-this.textOffsetY_),o.rotate(a),o.translate(this.textOffsetX_,this.textOffsetY_),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.restore()):(this.textStrokeState_&&o.strokeText(this.text_,u,s),this.textFillState_&&o.fillText(this.text_,u,s))}}}},{key:"moveToLineTo_",value:function(t,e,n,r,i){var o=this.context_,a=Yn(t,e,n,r,this.transform_,this.pixelCoordinates_);o.moveTo(a[0],a[1]);var u=a.length;i&&(u-=2);for(var s=2;s<u;s+=2)o.lineTo(a[s],a[s+1]);return i&&o.closePath(),n}},{key:"drawRings_",value:function(t,e,n,r){for(var i=0,o=n.length;i<o;++i)e=this.moveToLineTo_(t,e,n[i],r,!0);return e}},{key:"drawCircle",value:function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),Ie(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=function(t,e,n){var r=t.getFlatCoordinates();if(!r)return null;var i=t.getStride();return Yn(r,0,r.length,i,e,n)}(t,this.transform_,this.pixelCoordinates_),n=e[2]-e[0],r=e[3]-e[1],i=Math.sqrt(n*n+r*r),o=this.context_;o.beginPath(),o.arc(e[0],e[1],i,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}""!==this.text_&&this.drawText_(t.getCenter(),0,2,2)}}},{key:"setStyle",value:function(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())}},{key:"setTransform",value:function(t){this.transform_=t}},{key:"drawGeometry",value:function(t){switch(t.getType()){case"Point":this.drawPoint(t);break;case"LineString":this.drawLineString(t);break;case"Polygon":this.drawPolygon(t);break;case"MultiPoint":this.drawMultiPoint(t);break;case"MultiLineString":this.drawMultiLineString(t);break;case"MultiPolygon":this.drawMultiPolygon(t);break;case"GeometryCollection":this.drawGeometryCollection(t);break;case"Circle":this.drawCircle(t)}}},{key:"drawFeature",value:function(t,e){var n=e.getGeometryFunction()(t);n&&(this.setStyle(e),this.drawGeometry(n))}},{key:"drawGeometryCollection",value:function(t){for(var e=t.getGeometriesArray(),n=0,r=e.length;n<r;++n)this.drawGeometry(e[n])}},{key:"drawPoint",value:function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var e=t.getFlatCoordinates(),n=t.getStride();this.image_&&this.drawImages_(e,0,e.length,n),""!==this.text_&&this.drawText_(e,0,e.length,n)}},{key:"drawMultiPoint",value:function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var e=t.getFlatCoordinates(),n=t.getStride();this.image_&&this.drawImages_(e,0,e.length,n),""!==this.text_&&this.drawText_(e,0,e.length,n)}},{key:"drawLineString",value:function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),Ie(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var e=this.context_,n=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(n,0,n.length,t.getStride(),!1),e.stroke()}if(""!==this.text_){var r=t.getFlatMidpoint();this.drawText_(r,0,2,2)}}}},{key:"drawMultiLineString",value:function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var e=t.getExtent();if(Ie(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var n=this.context_,r=t.getFlatCoordinates(),i=0,o=t.getEnds(),a=t.getStride();n.beginPath();for(var u=0,s=o.length;u<s;++u)i=this.moveToLineTo_(r,i,o[u],a,!1);n.stroke()}if(""!==this.text_){var l=t.getFlatMidpoints();this.drawText_(l,0,l.length,2)}}}},{key:"drawPolygon",value:function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),Ie(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){var n=t.getFlatInteriorPoint();this.drawText_(n,0,2,2)}}}},{key:"drawMultiPolygon",value:function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),Ie(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=this.context_,n=t.getOrientedFlatCoordinates(),r=0,i=t.getEndss(),o=t.getStride();e.beginPath();for(var a=0,u=i.length;a<u;++a){var s=i[a];r=this.drawRings_(n,r,s,o)}this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){var l=t.getFlatInteriorPoints();this.drawText_(l,0,l.length,2)}}}},{key:"setContextFillState_",value:function(t){var e=this.context_,n=this.contextFillState_;n?n.fillStyle!=t.fillStyle&&(n.fillStyle=t.fillStyle,e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})}},{key:"setContextStrokeState_",value:function(t){var e=this.context_,n=this.contextStrokeState_;n?(n.lineCap!=t.lineCap&&(n.lineCap=t.lineCap,e.lineCap=t.lineCap),m(n.lineDash,t.lineDash)||e.setLineDash(n.lineDash=t.lineDash),n.lineDashOffset!=t.lineDashOffset&&(n.lineDashOffset=t.lineDashOffset,e.lineDashOffset=t.lineDashOffset),n.lineJoin!=t.lineJoin&&(n.lineJoin=t.lineJoin,e.lineJoin=t.lineJoin),n.lineWidth!=t.lineWidth&&(n.lineWidth=t.lineWidth,e.lineWidth=t.lineWidth),n.miterLimit!=t.miterLimit&&(n.miterLimit=t.miterLimit,e.miterLimit=t.miterLimit),n.strokeStyle!=t.strokeStyle&&(n.strokeStyle=t.strokeStyle,e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset,e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})}},{key:"setContextTextState_",value:function(t){var e=this.context_,n=this.contextTextState_,r=t.textAlign?t.textAlign:"center";n?(n.font!=t.font&&(n.font=t.font,e.font=t.font),n.textAlign!=r&&(n.textAlign=r,e.textAlign=r),n.textBaseline!=t.textBaseline&&(n.textBaseline=t.textBaseline,e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=r,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:r,textBaseline:t.textBaseline})}},{key:"setFillStrokeStyle",value:function(t,e){var n=this;if(t){var r=t.getColor();this.fillState_={fillStyle:Oa(r||"#000")}}else this.fillState_=null;if(e){var i=e.getColor(),o=e.getLineCap(),a=e.getLineDash(),u=e.getLineDashOffset(),s=e.getLineJoin(),l=e.getWidth(),c=e.getMiterLimit(),f=a||Ia;this.strokeState_={lineCap:void 0!==o?o:"round",lineDash:1===this.pixelRatio_?f:f.map((function(t){return t*n.pixelRatio_})),lineDashOffset:(u||0)*this.pixelRatio_,lineJoin:void 0!==s?s:"round",lineWidth:(void 0!==l?l:1)*this.pixelRatio_,miterLimit:void 0!==c?c:10,strokeStyle:Oa(i||"#000")}}else this.strokeState_=null}},{key:"setImageStyle",value:function(t){var e;if(t&&(e=t.getSize())){var n=t.getPixelRatio(this.pixelRatio_),r=t.getAnchor(),i=t.getOrigin();this.image_=t.getImage(this.pixelRatio_),this.imageAnchorX_=r[0]*n,this.imageAnchorY_=r[1]*n,this.imageHeight_=e[1]*n,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=i[0],this.imageOriginY_=i[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation();var o=t.getScaleArray();this.imageScale_=[o[0]*this.pixelRatio_/n,o[1]*this.pixelRatio_/n],this.imageWidth_=e[0]*n}else this.image_=null}},{key:"setTextStyle",value:function(t){if(t){var e=t.getFill();if(e){var n=e.getColor();this.textFillState_={fillStyle:Oa(n||"#000")}}else this.textFillState_=null;var r=t.getStroke();if(r){var i=r.getColor(),o=r.getLineCap(),a=r.getLineDash(),u=r.getLineDashOffset(),s=r.getLineJoin(),l=r.getWidth(),c=r.getMiterLimit();this.textStrokeState_={lineCap:void 0!==o?o:"round",lineDash:a||Ia,lineDashOffset:u||0,lineJoin:void 0!==s?s:"round",lineWidth:void 0!==l?l:1,miterLimit:void 0!==c?c:10,strokeStyle:Oa(i||"#000")}}else this.textStrokeState_=null;var f=t.getFont(),h=t.getOffsetX(),y=t.getOffsetY(),p=t.getRotateWithView(),d=t.getRotation(),v=t.getScaleArray(),g=t.getText(),m=t.getTextAlign(),b=t.getTextBaseline();this.textState_={font:void 0!==f?f:"10px sans-serif",textAlign:void 0!==m?m:"center",textBaseline:void 0!==b?b:"middle"},this.text_=void 0!==g?Array.isArray(g)?g.reduce((function(t,e,n){return t+(n%2?" ":e)}),""):g:"",this.textOffsetX_=void 0!==h?this.pixelRatio_*h:0,this.textOffsetY_=void 0!==y?this.pixelRatio_*y:0,this.textRotateWithView_=void 0!==p&&p,this.textRotation_=void 0!==d?d:0,this.textScale_=[this.pixelRatio_*v[0],this.pixelRatio_*v[1]]}else this.text_=""}}])&&b_(n.prototype,r),i&&b_(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(Zm);var k_={Point:function(t,e,n,r,i,o){var a=n.getImage(),u=n.getText(),s=u&&u.getText(),l=o&&a&&s?{}:void 0;if(a){if(a.getImageState()!=vo)return;var c=t.getBuilder(n.getZIndex(),"Image");c.setImageStyle(a,l),c.drawPoint(e,r,i)}if(s){var f=t.getBuilder(n.getZIndex(),"Text");f.setTextStyle(u,l),f.drawText(e,r,i)}},LineString:function(t,e,n,r,i){var o=n.getStroke();if(o){var a=t.getBuilder(n.getZIndex(),"LineString");a.setFillStrokeStyle(null,o),a.drawLineString(e,r,i)}var u=n.getText();if(u&&u.getText()){var s=t.getBuilder(n.getZIndex(),"Text");s.setTextStyle(u),s.drawText(e,r,i)}},Polygon:function(t,e,n,r,i){var o=n.getFill(),a=n.getStroke();if(o||a){var u=t.getBuilder(n.getZIndex(),"Polygon");u.setFillStrokeStyle(o,a),u.drawPolygon(e,r,i)}var s=n.getText();if(s&&s.getText()){var l=t.getBuilder(n.getZIndex(),"Text");l.setTextStyle(s),l.drawText(e,r,i)}},MultiPoint:function(t,e,n,r,i,o){var a=n.getImage(),u=a&&0!==a.getOpacity(),s=n.getText(),l=s&&s.getText(),c=o&&u&&l?{}:void 0;if(u){if(a.getImageState()!=vo)return;var f=t.getBuilder(n.getZIndex(),"Image");f.setImageStyle(a,c),f.drawMultiPoint(e,r,i)}if(l){var h=t.getBuilder(n.getZIndex(),"Text");h.setTextStyle(s,c),h.drawText(e,r,i)}},MultiLineString:function(t,e,n,r,i){var o=n.getStroke();if(o){var a=t.getBuilder(n.getZIndex(),"LineString");a.setFillStrokeStyle(null,o),a.drawMultiLineString(e,r,i)}var u=n.getText();if(u&&u.getText()){var s=t.getBuilder(n.getZIndex(),"Text");s.setTextStyle(u),s.drawText(e,r,i)}},MultiPolygon:function(t,e,n,r,i){var o=n.getFill(),a=n.getStroke();if(a||o){var u=t.getBuilder(n.getZIndex(),"Polygon");u.setFillStrokeStyle(o,a),u.drawMultiPolygon(e,r,i)}var s=n.getText();if(s&&s.getText()){var l=t.getBuilder(n.getZIndex(),"Text");l.setTextStyle(s),l.drawText(e,r,i)}},GeometryCollection:function(t,e,n,r,i,o){var a,u,s=e.getGeometriesArray();for(a=0,u=s.length;a<u;++a){(0,k_[s[a].getType()])(t,s[a],n,r,i,o)}},Circle:function(t,e,n,r,i){var o=n.getFill(),a=n.getStroke();if(o||a){var u=t.getBuilder(n.getZIndex(),"Circle");u.setFillStrokeStyle(o,a),u.drawCircle(e,r,i)}var s=n.getText();if(s&&s.getText()){var l=t.getBuilder(n.getZIndex(),"Text");l.setTextStyle(s),l.drawText(e,r)}}};function P_(t,e){return parseInt(nt(t),10)-parseInt(nt(e),10)}function E_(t,e){var n=j_(t,e);return n*n}function j_(t,e){return.5*t/e}function C_(t,e,n,r,i,o,a,u){var s=[],l=n.getImage();if(l){var c=!0,f=l.getImageState();f==vo||f==go?c=!1:f==yo&&l.load(),c&&s.push(l.ready())}var h=n.getFill();h&&h.loading()&&s.push(h.ready());var y=s.length>0;return y&&Promise.all(s).then((function(){return i(null)})),function(t,e,n,r,i,o,a){var u=n.getGeometryFunction()(e);if(!u)return;var s=u.simplifyTransformed(r,i);if(n.getRenderer())!function t(e,n,r,i,o){if("GeometryCollection"==n.getType()){for(var a=n.getGeometries(),u=0,s=a.length;u<s;++u)t(e,a[u],r,i,o);return}e.getBuilder(r.getZIndex(),"Default").drawCustom(n,i,r.getRenderer(),r.getHitDetectionRenderer(),o)}(t,s,n,e,a);else{(0,k_[s.getType()])(t,s,n,e,a,o)}}(t,e,n,r,o,a,u),y}function T_(t){return(T_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function R_(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,I_(r.key),r)}}function I_(t){var e=function(t,e){if("object"!=T_(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=T_(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==T_(e)?e:e+""}function M_(t,e,n){return e=L_(e),function(t,e){if(e&&("object"==T_(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],L_(t).constructor):e.apply(t,n))}function L_(t){return(L_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function A_(t,e){return(A_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var F_=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=M_(this,e,[t])).boundHandleStyleImageChange_=n.handleStyleImageChange_.bind(n),n.animatingOrInteracting_,n.hitDetectionImageData_=null,n.clipped_=!1,n.renderedFeatures_=null,n.renderedRevision_=-1,n.renderedResolution_=NaN,n.renderedExtent_=[1/0,1/0,-1/0,-1/0],n.wrappedRenderedExtent_=[1/0,1/0,-1/0,-1/0],n.renderedRotation_,n.renderedCenter_=null,n.renderedProjection_=null,n.renderedPixelRatio_=1,n.renderedRenderOrder_=null,n.renderedFrameDeclutter_,n.replayGroup_=null,n.replayGroupChanged=!0,n.clipping=!0,n.targetContext_=null,n.opacity_=1,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&A_(t,e)}(e,t),n=e,(r=[{key:"renderWorlds",value:function(t,e,n){var r=e.extent,i=e.viewState,o=i.center,a=i.resolution,u=i.projection,s=i.rotation,l=u.getExtent(),c=this.getLayer().getSource(),f=this.getLayer().getDeclutter(),h=e.pixelRatio,y=e.viewHints,p=!(y[pt]||y[dt]),d=this.context,v=Math.round(Re(r)/a*h),g=Math.round(Ee(r)/a*h),m=c.getWrapX()&&u.canWrapX(),b=m?Re(l):null,_=m?Math.ceil((r[2]-l[2])/b)+1:1,w=m?Math.floor((r[0]-l[0])/b):0;do{var S=this.getRenderTransform(o,a,0,h,v,g,w*b);e.declutter&&(S=S.slice(0)),t.execute(d,[d.canvas.width,d.canvas.height],S,s,p,void 0===n?h_:n?y_:p_,n?f&&e.declutter[f]:void 0)}while(++w<_)}},{key:"setDrawContext_",value:function(){1!==this.opacity_&&(this.targetContext_=this.context,this.context=ta(this.context.canvas.width,this.context.canvas.height,Sd))}},{key:"resetDrawContext_",value:function(){if(1!==this.opacity_){var t=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=t,na(this.context),Sd.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}},{key:"renderDeclutter",value:function(t){this.replayGroup_&&this.getLayer().getDeclutter()&&this.renderWorlds(this.replayGroup_,t,!0)}},{key:"renderDeferredInternal",value:function(t){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}},{key:"renderFrame",value:function(t,e){var n=t.layerStatesArray[t.layerIndex];this.opacity_=n.opacity;var r=t.viewState;this.prepareContainer(t,e);var i=this.context,o=this.replayGroup_,a=o&&!o.isEmpty();if(!a&&!this.getLayer().hasListener(Hi)&&!this.getLayer().hasListener(Ji))return null;this.setDrawContext_(),this.preRender(i,t);var u=r.projection;if(this.clipped_=!1,a&&n.extent&&this.clipping){var s=kn(n.extent,u);a=Ie(s,t.extent),this.clipped_=a&&!se(s,t.extent),this.clipped_&&this.clipUnrotated(i,t,s)}return a&&this.renderWorlds(o,t,!this.getLayer().getDeclutter()&&void 0),!t.declutter&&this.clipped_&&i.restore(),this.postRender(i,t),this.renderedRotation_!==r.rotation&&(this.renderedRotation_=r.rotation,this.hitDetectionImageData_=null),t.declutter||this.resetDrawContext_(),this.container}},{key:"getFeatures",value:function(t){var e=this;return new Promise((function(n){if(e.frameState&&!e.hitDetectionImageData_&&!e.animatingOrInteracting_){var r=e.frameState.size.slice(),i=e.renderedCenter_,o=e.renderedResolution_,a=e.renderedRotation_,u=e.renderedProjection_,s=e.wrappedRenderedExtent_,l=e.getLayer(),c=[],f=.5*r[0],h=.5*r[1];c.push(e.getRenderTransform(i,o,a,.5,f,h,0).slice());var y=l.getSource(),d=u.getExtent();if(y.getWrapX()&&u.canWrapX()&&!se(d,s)){for(var v,g=s[0],m=Re(d),b=0;g<d[0];)v=m*--b,c.push(e.getRenderTransform(i,o,a,.5,f,h,v).slice()),g+=m;for(b=0,g=s[2];g>d[2];)v=m*++b,c.push(e.getRenderTransform(i,o,a,.5,f,h,v).slice()),g-=m}var _=wn();e.hitDetectionImageData_=function(t,e,n,r,i,o,a,u,s){var l=s?On(i,s):i,c=ta(.5*t[0],.5*t[1]);c.imageSmoothingEnabled=!1;for(var f=c.canvas,h=new O_(c,.5,i,null,a,u,s?yn(wn(),s):null),y=n.length,d=Math.floor(16777215/y),v={},g=1;g<=y;++g){var m=n[g-1],b=m.getStyleFunction()||r;if(b){var _=b(m,o);if(_){Array.isArray(_)||(_=[_]);for(var w=(g*d).toString(16).padStart(7,"#00000"),S=0,x=_.length;S<x;++S){var O=_[S],k=O.getGeometryFunction()(m);if(k&&Ie(l,k.getExtent())){var P=O.clone(),E=P.getFill();E&&E.setColor(w);var j=P.getStroke();j&&(j.setColor(w),j.setLineDash(null)),P.setText(void 0);var C=O.getImage();if(C){var T=C.getImageSize();if(!T)continue;var R=ta(T[0],T[1],void 0,{alpha:!1}),I=R.canvas;R.fillStyle=w,R.fillRect(0,0,I.width,I.height),P.setImage(new Ru({img:I,anchor:C.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:C.getOrigin(),opacity:1,size:C.getSize(),scale:C.getScale(),rotation:C.getRotation(),rotateWithView:C.getRotateWithView()}))}var M=P.getZIndex()||0,L=v[M];L||(L={},v[M]=L,L.Polygon=[],L.Circle=[],L.LineString=[],L.Point=[]);var A=k.getType();if("GeometryCollection"===A)for(var F=k.getGeometriesArrayRecursive(),D=0,N=F.length;D<N;++D){var z=F[D];L[z.getType().replace("Multi","")].push(z,P)}else L[A.replace("Multi","")].push(k,P)}}}}}for(var B=Object.keys(v).map(Number).sort(p),G=0,W=B.length;G<W;++G){var X=v[B[G]];for(var Y in X)for(var K=X[Y],Z=0,U=K.length;Z<U;Z+=2){h.setStyle(K[Z+1]);for(var V=0,q=e.length;V<q;++V)h.setTransform(e[V]),h.drawGeometry(K[Z])}}return c.getImageData(0,0,f.width,f.height)}(r,c,e.renderedFeatures_,l.getStyleFunction(),s,o,a,E_(o,e.renderedPixelRatio_),_?u:null)}n(function(t,e,n){var r=[];if(n){var i=Math.floor(.5*Math.round(t[0])),o=Math.floor(.5*Math.round(t[1])),a=4*(De(i,0,n.width-1)+De(o,0,n.height-1)*n.width),u=n.data[a],s=n.data[a+1],l=n.data[a+2]+256*(s+256*u),c=Math.floor(16777215/e.length);l&&l%c==0&&r.push(e[l/c-1])}return r}(t,e.renderedFeatures_,e.hitDetectionImageData_))}))}},{key:"forEachFeatureAtCoordinate",value:function(t,e,n,r,i){if(this.replayGroup_){var o,a=e.viewState.resolution,u=e.viewState.rotation,s=this.getLayer(),l={},c=function(t,e,n){var o=nt(t),a=l[o];if(a){if(!0!==a&&n<a.distanceSq){if(0===n)return l[o]=!0,i.splice(i.lastIndexOf(a),1),r(t,s,e);a.geometry=e,a.distanceSq=n}}else{if(0===n)return l[o]=!0,r(t,s,e);i.push(l[o]={feature:t,layer:s,geometry:e,distanceSq:n,callback:r})}},f=[this.replayGroup_],h=this.getLayer().getDeclutter();return f.some((function(r){return o=r.forEachFeatureAtCoordinate(t,a,u,n,c,h&&e.declutter[h]?e.declutter[h].all().map((function(t){return t.value})):null)})),o}}},{key:"handleFontsChanged",value:function(){var t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()}},{key:"handleStyleImageChange_",value:function(t){this.renderIfReadyAndVisible()}},{key:"prepareFrame",value:function(t){var e=this,n=this.getLayer(),r=n.getSource();if(!r)return!1;var i=t.viewHints[pt],o=t.viewHints[dt],a=n.getUpdateWhileAnimating(),u=n.getUpdateWhileInteracting();if(this.ready&&!a&&i||!u&&o)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;var s=t.extent,l=t.viewState,c=l.projection,f=l.resolution,h=t.pixelRatio,y=n.getRevision(),p=n.getRenderBuffer(),d=n.getRenderOrder();void 0===d&&(d=P_);var v=l.center.slice(),g=ie(s,p*f),b=g.slice(),_=[g.slice()],w=c.getExtent();if(r.getWrapX()&&c.canWrapX()&&!se(w,t.extent)){var S=Re(w),x=Math.max(Re(g)/2,S);g[0]=w[0]-x,g[2]=w[2]+x,Ve(v,c);var O=Ae(_[0],c);O[0]<w[0]&&O[2]<w[2]?_.push([O[0]+S,O[1],O[2]+S,O[3]]):O[0]>w[0]&&O[2]>w[2]&&_.push([O[0]-S,O[1],O[2]-S,O[3]])}if(this.ready&&this.renderedResolution_==f&&this.renderedRevision_==y&&this.renderedRenderOrder_==d&&this.renderedFrameDeclutter_===!!t.declutter&&se(this.wrappedRenderedExtent_,g))return m(this.renderedExtent_,b)||(this.hitDetectionImageData_=null,this.renderedExtent_=b),this.renderedCenter_=v,this.replayGroupChanged=!1,!0;this.replayGroup_=null;var k,P=new Kb(j_(f,h),g,f,h),E=wn();if(E){for(var j=0,C=_.length;j<C;++j){var T=On(_[j],c);r.loadFeatures(T,Pn(f,c),E)}k=yn(E,c)}else for(var R=0,I=_.length;R<I;++R)r.loadFeatures(_[R],f,c);var M=E_(f,h),L=!0,A=function(t,r){var i,o=t.getStyleFunction()||n.getStyleFunction();if(o&&(i=o(t,f)),i){var a=e.renderFeature(t,M,i,P,k,e.getLayer().getDeclutter(),r);L=L&&!a}},F=On(g,c),D=r.getFeaturesInExtent(F);d&&D.sort(d);for(var N=0,z=D.length;N<z;++N)A(D[N],N);this.renderedFeatures_=D,this.ready=L;var B=P.finish(),G=new g_(g,f,h,r.getOverlaps(),B,n.getRenderBuffer(),!!t.declutter);return this.renderedResolution_=f,this.renderedRevision_=y,this.renderedRenderOrder_=d,this.renderedFrameDeclutter_=!!t.declutter,this.renderedExtent_=b,this.wrappedRenderedExtent_=g,this.renderedCenter_=v,this.renderedProjection_=c,this.renderedPixelRatio_=h,this.replayGroup_=G,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}},{key:"renderFeature",value:function(t,e,n,r,i,o,a){if(!n)return!1;var u=!1;if(Array.isArray(n))for(var s=0,l=n.length;s<l;++s)u=C_(r,t,n[s],e,this.boundHandleStyleImageChange_,i,o,a)||u;else u=C_(r,t,n,e,this.boundHandleStyleImageChange_,i,o,a);return u}}])&&R_(n.prototype,r),i&&R_(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(Od);function D_(t){return(D_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function N_(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,z_(r.key),r)}}function z_(t){var e=function(t,e){if("object"!=D_(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=D_(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==D_(e)?e:e+""}function B_(t,e,n){return e=G_(e),function(t,e){if(e&&("object"==D_(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],G_(t).constructor):e.apply(t,n))}function G_(t){return(G_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function W_(t,e){return(W_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var X_=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),B_(this,e,[t])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&W_(t,e)}(e,t),n=e,(r=[{key:"createRenderer",value:function(){return new F_(this)}}])&&N_(n.prototype,r),i&&N_(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(ec);function Y_(t){return(Y_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function K_(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Z_(r.key),r)}}function Z_(t){var e=function(t,e){if("object"!=Y_(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Y_(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Y_(e)?e:e+""}var U_=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.rbush_=new ho.a(e),this.items_={}},(e=[{key:"insert",value:function(t,e){var n={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};this.rbush_.insert(n),this.items_[nt(e)]=n}},{key:"load",value:function(t,e){for(var n=new Array(e.length),r=0,i=e.length;r<i;r++){var o=t[r],a=e[r],u={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:a};n[r]=u,this.items_[nt(a)]=u}this.rbush_.load(n)}},{key:"remove",value:function(t){var e=nt(t),n=this.items_[e];return delete this.items_[e],null!==this.rbush_.remove(n)}},{key:"update",value:function(t,e){var n=this.items_[nt(e)];ve([n.minX,n.minY,n.maxX,n.maxY],t)||(this.remove(e),this.insert(t,e))}},{key:"getAll",value:function(){return this.rbush_.all().map((function(t){return t.value}))}},{key:"getInExtent",value:function(t){var e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(e).map((function(t){return t.value}))}},{key:"forEach",value:function(t){return this.forEach_(this.getAll(),t)}},{key:"forEachInExtent",value:function(t,e){return this.forEach_(this.getInExtent(t),e)}},{key:"forEach_",value:function(t,e){for(var n,r=0,i=t.length;r<i;r++)if(n=e(t[r]))return n;return n}},{key:"isEmpty",value:function(){return k(this.items_)}},{key:"clear",value:function(){this.rbush_.clear(),this.items_={}}},{key:"getExtent",value:function(t){var e=this.rbush_.toJSON();return he(e.minX,e.minY,e.maxX,e.maxY,t)}},{key:"concat",value:function(t){for(var e in this.rbush_.load(t.rbush_.all()),t.items_)this.items_[e]=t.items_[e]}}])&&K_(t.prototype,e),n&&K_(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}();function V_(t,e,n,r,i,o,a){var u,s,l=(n-e)/r;if(1===l)u=e;else if(2===l)u=e,s=i;else if(0!==l){for(var c=t[e],f=t[e+1],h=0,y=[0],d=e+r;d<n;d+=r){var v=t[d],g=t[d+1];h+=Math.sqrt((v-c)*(v-c)+(g-f)*(g-f)),y.push(h),c=v,f=g}var m=i*h,b=function(t,e,n){var r,i;n=n||p;for(var o=0,a=t.length,u=!1;o<a;)(i=+n(t[r=o+(a-o>>1)],e))<0?o=r+1:(a=r,u=!i);return u?o:~o}(y,m);b<0?(s=(m-y[-b-2])/(y[-b-1]-y[-b-2]),u=e+(-b-2)*r):u=e+b*r}a=a>1?a:2,o=o||new Array(a);for(var _=0;_<a;++_)o[_]=void 0===u?NaN:void 0===s?t[u+_]:We(t[u+_],t[u+r+_],s);return o}function q_(t,e,n,r,i,o){if(n==e)return null;var a;if(i<t[e+r-1])return o?((a=t.slice(e,e+r))[r-1]=i,a):null;if(t[n-1]<i)return o?((a=t.slice(n-r,n))[r-1]=i,a):null;if(i==t[e+r-1])return t.slice(e,e+r);for(var u=e/r,s=n/r;u<s;){var l=u+s>>1;i<t[(l+1)*r-1]?s=l:u=l+1}var c=t[u*r-1];if(i==c)return t.slice((u-1)*r,(u-1)*r+r);var f=(i-c)/(t[(u+1)*r-1]-c);a=[];for(var h=0;h<r-1;++h)a.push(We(t[(u-1)*r+h],t[u*r+h],f));return a.push(i),a}function H_(t){return(H_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function J_(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,$_(r.key),r)}}function $_(t){var e=function(t,e){if("object"!=H_(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=H_(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==H_(e)?e:e+""}function Q_(t,e,n){return e=tw(e),function(t,e){if(e&&("object"==H_(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],tw(t).constructor):e.apply(t,n))}function tw(t){return(tw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ew(t,e){return(ew=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var nw=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Q_(this,e)).flatMidpoint_=null,r.flatMidpointRevision_=-1,r.maxDelta_=-1,r.maxDeltaRevision_=-1,void 0===n||Array.isArray(t[0])?r.setCoordinates(t,n):r.setFlatCoordinates(n,t),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ew(t,e)}(e,t),n=e,(r=[{key:"appendCoordinate",value:function(t){g(this.flatCoordinates,t),this.changed()}},{key:"clone",value:function(){var t=new e(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}},{key:"closestPointXY",value:function(t,e,n,r){return r<ae(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(sr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),cr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,e,n,r))}},{key:"forEachSegment",value:function(t){return Xr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}},{key:"getCoordinateAtM",value:function(t,e){return"XYM"!=this.layout&&"XYZM"!=this.layout?null:(e=void 0!==e&&e,q_(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e))}},{key:"getCoordinates",value:function(){return br(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}},{key:"getCoordinateAt",value:function(t,e){return V_(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,this.stride)}},{key:"getLength",value:function(){return Ub(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}},{key:"getFlatMidpoint",value:function(){var t;return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,null!==(t=this.flatMidpoint_)&&void 0!==t?t:void 0),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}},{key:"getSimplifiedGeometryInternal",value:function(t){var n=[];return n.length=pr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,n,0),new e(n,"XY")}},{key:"getType",value:function(){return"LineString"}},{key:"intersectsExtent",value:function(t){return Yr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}},{key:"setCoordinates",value:function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=hr(this.flatCoordinates,0,t,this.stride),this.changed()}}])&&J_(n.prototype,r),i&&J_(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(ar);function rw(t,e,n,r){for(var i=[],o=[1/0,1/0,-1/0,-1/0],a=0,u=n.length;a<u;++a){var s=n[a];o=de(t,e,s[0],r),i.push((o[0]+o[2])/2,(o[1]+o[3])/2),e=s[s.length-1]}return i}function iw(t){return(iw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ow(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,aw(r.key),r)}}function aw(t){var e=function(t,e){if("object"!=iw(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=iw(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==iw(e)?e:e+""}var uw=[1,0,0,1,0,0],sw=function(){function t(e,n,r,i,o,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.styleFunction,this.extent_,this.id_=a,this.type_=e,this.flatCoordinates_=n,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=r||null,this.properties_=o,this.squaredTolerance_,this.stride_=i,this.simplifiedGeometry_}return e=t,(n=[{key:"get",value:function(t){return this.properties_[t]}},{key:"getExtent",value:function(){return this.extent_||(this.extent_="Point"===this.type_?pe(this.flatCoordinates_):de(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}},{key:"getFlatInteriorPoint",value:function(){if(!this.flatInteriorPoints_){var t=Oe(this.getExtent());this.flatInteriorPoints_=Gr(this.flatCoordinates_,0,this.ends_,2,t,0)}return this.flatInteriorPoints_}},{key:"getFlatInteriorPoints",value:function(){if(!this.flatInteriorPoints_){var t=Jr(this.flatCoordinates_,this.ends_),e=rw(this.flatCoordinates_,0,t,2);this.flatInteriorPoints_=Wr(this.flatCoordinates_,0,t,2,e)}return this.flatInteriorPoints_}},{key:"getFlatMidpoint",value:function(){return this.flatMidpoints_||(this.flatMidpoints_=V_(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}},{key:"getFlatMidpoints",value:function(){if(!this.flatMidpoints_){this.flatMidpoints_=[];for(var t=this.flatCoordinates_,e=0,n=this.ends_,r=0,i=n.length;r<i;++r){var o=n[r],a=V_(t,e,o,2,.5);g(this.flatMidpoints_,a),e=o}}return this.flatMidpoints_}},{key:"getId",value:function(){return this.id_}},{key:"getOrientedFlatCoordinates",value:function(){return this.flatCoordinates_}},{key:"getGeometry",value:function(){return this}},{key:"getSimplifiedGeometry",value:function(t){return this}},{key:"simplifyTransformed",value:function(t,e){return this}},{key:"getProperties",value:function(){return this.properties_}},{key:"getPropertiesInternal",value:function(){return this.properties_}},{key:"getStride",value:function(){return this.stride_}},{key:"getStyleFunction",value:function(){return this.styleFunction}},{key:"getType",value:function(){return this.type_}},{key:"transform",value:function(t){var e=(t=an(t)).getExtent(),n=t.getWorldExtent();if(e&&n){var r=Ee(n)/Ee(e);Bn(uw,n[0],n[3],r,-r,0,0,0),Yn(this.flatCoordinates_,0,this.flatCoordinates_.length,2,uw,this.flatCoordinates_)}}},{key:"applyTransform",value:function(t){t(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}},{key:"clone",value:function(){var e;return new t(this.type_,this.flatCoordinates_.slice(),null===(e=this.ends_)||void 0===e?void 0:e.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}},{key:"getEnds",value:function(){return this.ends_}},{key:"enableSimplifyTransformed",value:function(){var e=this;return this.simplifyTransformed=S((function(n,r){if(n===e.squaredTolerance_)return e.simplifiedGeometry_;e.simplifiedGeometry_=e.clone(),r&&e.simplifiedGeometry_.applyTransform(r);var i,o=e.simplifiedGeometry_.getFlatCoordinates();switch(e.type_){case"LineString":o.length=pr(o,0,e.simplifiedGeometry_.flatCoordinates_.length,e.simplifiedGeometry_.stride_,n,o,0),i=[o.length];break;case"MultiLineString":i=[],o.length=dr(o,0,e.simplifiedGeometry_.ends_,e.simplifiedGeometry_.stride_,n,o,0,i);break;case"Polygon":i=[],o.length=mr(o,0,e.simplifiedGeometry_.ends_,e.simplifiedGeometry_.stride_,Math.sqrt(n),o,0,i)}return i&&(e.simplifiedGeometry_=new t(e.type_,o,i,2,e.properties_,e.id_)),e.squaredTolerance_=n,e.simplifiedGeometry_})),this}}])&&ow(e.prototype,n),r&&ow(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n,r}();sw.prototype.getFlatCoordinates=sw.prototype.getOrientedFlatCoordinates;var lw=sw,cw="addfeature",fw="changefeature",hw="clear",yw="removefeature",pw="featuresloadstart",dw="featuresloadend",vw="featuresloaderror";function gw(t,e){return[[-1/0,-1/0,1/0,1/0]]}var mw=!1;function bw(t,e){return function(n,r,i,o,a){var u=this;!function(t,e,n,r,i,o,a){var u=new XMLHttpRequest;u.open("GET","function"==typeof t?t(n,r,i):t,!0),"arraybuffer"==e.getType()&&(u.responseType="arraybuffer"),u.withCredentials=mw,u.onload=function(t){if(!u.status||u.status>=200&&u.status<300){var r=e.getType();try{var s;"text"==r||"json"==r?s=u.responseText:"xml"==r?s=u.responseXML||u.responseText:"arraybuffer"==r&&(s=u.response),s?o(e.readFeatures(s,{extent:n,featureProjection:i}),e.readProjection(s)):a()}catch(t){a()}}else a()},u.onerror=a,u.send()}(t,e,n,r,i,(function(t,e){u.addFeatures(t),void 0!==o&&o(t)}),a||w)}}function _w(t){return(_w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ww(t){return function(t){if(Array.isArray(t))return Sw(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Sw(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Sw(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Sw(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function xw(){return(xw="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=Ow(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}}).apply(null,arguments)}function Ow(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=Tw(t)););return t}function kw(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ew(r.key),r)}}function Pw(t,e,n){return e&&kw(t.prototype,e),n&&kw(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ew(t){var e=function(t,e){if("object"!=_w(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=_w(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==_w(e)?e:e+""}function jw(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Cw(t,e,n){return e=Tw(e),function(t,e){if(e&&("object"==_w(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],Tw(t).constructor):e.apply(t,n))}function Tw(t){return(Tw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Rw(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Iw(t,e)}function Iw(t,e){return(Iw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Mw=function(t){function e(t,n,r){var i;return jw(this,e),(i=Cw(this,e,[t])).feature=n,i.features=r,i}return Rw(e,t),Pw(e)}(s),Lw=function(t){function e(t){var n;jw(this,e),(n=Cw(this,e,[{attributions:(t=t||{}).attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:void 0===t.wrapX||t.wrapX}])).on,n.once,n.un,n.loader_=w,n.format_=t.format||null,n.overlaps_=void 0===t.overlaps||t.overlaps,n.url_=t.url,void 0!==t.loader?n.loader_=t.loader:void 0!==n.url_&&(En(n.format_,"`format` must be set when `url` is set"),n.loader_=bw(n.url_,n.format_)),n.strategy_=void 0!==t.strategy?t.strategy:gw;var r,i,o=void 0===t.useSpatialIndex||t.useSpatialIndex;return n.featuresRtree_=o?new U_:null,n.loadedExtentsRtree_=new U_,n.loadingExtentsCount_=0,n.nullGeometryFeatures_={},n.idIndex_={},n.uidIndex_={},n.featureChangeKeys_={},n.featuresCollection_=null,Array.isArray(t.features)?i=t.features:t.features&&(i=(r=t.features).getArray()),o||void 0!==r||(r=new Ti(i)),void 0!==i&&n.addFeaturesInternal(i),void 0!==r&&n.bindFeaturesCollection_(r),n}return Rw(e,t),Pw(e,[{key:"addFeature",value:function(t){this.addFeatureInternal(t),this.changed()}},{key:"addFeatureInternal",value:function(t){var e=nt(t);if(this.addToIndex_(e,t)){this.setupChangeEvents_(e,t);var n=t.getGeometry();if(n){var r=n.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(r,t)}else this.nullGeometryFeatures_[e]=t;this.dispatchEvent(new Mw(cw,t))}else this.featuresCollection_&&this.featuresCollection_.remove(t)}},{key:"setupChangeEvents_",value:function(t,e){e instanceof lw||(this.featureChangeKeys_[t]=[X(e,M,this.handleFeatureChange_,this),X(e,l,this.handleFeatureChange_,this)])}},{key:"addToIndex_",value:function(t,e){var n=!0;if(void 0!==e.getId()){var r=String(e.getId());if(r in this.idIndex_)if(e instanceof lw){var i=this.idIndex_[r];i instanceof lw?Array.isArray(i)?i.push(e):this.idIndex_[r]=[i,e]:n=!1}else n=!1;else this.idIndex_[r]=e}return n&&(En(!(t in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[t]=e),n}},{key:"addFeatures",value:function(t){this.addFeaturesInternal(t),this.changed()}},{key:"addFeaturesInternal",value:function(t){for(var e=[],n=[],r=[],i=0,o=t.length;i<o;i++){var a=t[i],u=nt(a);this.addToIndex_(u,a)&&n.push(a)}for(var s=0,l=n.length;s<l;s++){var c=n[s],f=nt(c);this.setupChangeEvents_(f,c);var h=c.getGeometry();if(h){var y=h.getExtent();e.push(y),r.push(c)}else this.nullGeometryFeatures_[f]=c}if(this.featuresRtree_&&this.featuresRtree_.load(e,r),this.hasListener(cw))for(var p=0,d=n.length;p<d;p++)this.dispatchEvent(new Mw(cw,n[p]))}},{key:"bindFeaturesCollection_",value:function(t){var e=this,n=!1;this.addEventListener(cw,(function(e){n||(n=!0,t.push(e.feature),n=!1)})),this.addEventListener(yw,(function(e){n||(n=!0,t.remove(e.feature),n=!1)})),t.addEventListener(gi,(function(t){n||(n=!0,e.addFeature(t.element),n=!1)})),t.addEventListener(mi,(function(t){n||(n=!0,e.removeFeature(t.element),n=!1)})),this.featuresCollection_=t}},{key:"clear",value:function(t){var e=this;if(t){for(var n in this.featureChangeKeys_){this.featureChangeKeys_[n].forEach(K)}this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){for(var r in this.featuresRtree_.forEach((function(t){e.removeFeatureInternal(t)})),this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[r])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};var i=new Mw(hw);this.dispatchEvent(i),this.changed()}},{key:"forEachFeature",value:function(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}},{key:"forEachFeatureAtCoordinateDirect",value:function(t,e){var n=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(n,(function(n){var r=n.getGeometry();if(r instanceof lw||r.intersectsCoordinate(t))return e(n)}))}},{key:"forEachFeatureInExtent",value:function(t,e){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}},{key:"forEachFeatureIntersectingExtent",value:function(t,e){return this.forEachFeatureInExtent(t,(function(n){var r=n.getGeometry();if(r instanceof lw||r.intersectsExtent(t)){var i=e(n);if(i)return i}}))}},{key:"getFeaturesCollection",value:function(){return this.featuresCollection_}},{key:"getFeatures",value:function(){var t;return this.featuresCollection_?t=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(t=this.featuresRtree_.getAll(),k(this.nullGeometryFeatures_)||g(t,Object.values(this.nullGeometryFeatures_))),t}},{key:"getFeaturesAtCoordinate",value:function(t){var e=[];return this.forEachFeatureAtCoordinateDirect(t,(function(t){e.push(t)})),e}},{key:"getFeaturesInExtent",value:function(t,e){var n=this;if(this.featuresRtree_){var r;if(!(e&&e.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(t);var i=Fe(t,e);return(r=[]).concat.apply(r,ww(i.map((function(t){return n.featuresRtree_.getInExtent(t)}))))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}},{key:"getClosestFeatureToCoordinate",value:function(t,e){var n=t[0],r=t[1],i=null,o=[NaN,NaN],a=1/0,u=[-1/0,-1/0,1/0,1/0];return e=e||b,this.featuresRtree_.forEachInExtent(u,(function(t){if(e(t)){var s=t.getGeometry(),l=a;if((a=s instanceof lw?0:s.closestPointXY(n,r,o,a))<l){i=t;var c=Math.sqrt(a);u[0]=n-c,u[1]=r-c,u[2]=n+c,u[3]=r+c}}})),i}},{key:"getExtent",value:function(t){return this.featuresRtree_.getExtent(t)}},{key:"getFeatureById",value:function(t){var e=this.idIndex_[t.toString()];return void 0!==e?e:null}},{key:"getFeatureByUid",value:function(t){var e=this.uidIndex_[t];return void 0!==e?e:null}},{key:"getFormat",value:function(){return this.format_}},{key:"getOverlaps",value:function(){return this.overlaps_}},{key:"getUrl",value:function(){return this.url_}},{key:"handleFeatureChange_",value:function(t){var e=t.target,n=nt(e),r=e.getGeometry();if(r){var i=r.getExtent();n in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[n],this.featuresRtree_&&this.featuresRtree_.insert(i,e)):this.featuresRtree_&&this.featuresRtree_.update(i,e)}else n in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(e),this.nullGeometryFeatures_[n]=e);var o=e.getId();if(void 0!==o){var a=o.toString();this.idIndex_[a]!==e&&(this.removeFromIdIndex_(e),this.idIndex_[a]=e)}else this.removeFromIdIndex_(e),this.uidIndex_[n]=e;this.changed(),this.dispatchEvent(new Mw(fw,e))}},{key:"hasFeature",value:function(t){var e=t.getId();return void 0!==e?e in this.idIndex_:nt(t)in this.uidIndex_}},{key:"isEmpty",value:function(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&k(this.nullGeometryFeatures_):!this.featuresCollection_||0===this.featuresCollection_.getLength()}},{key:"loadFeatures",value:function(t,e,n){for(var r=this,i=this.loadedExtentsRtree_,o=this.strategy_(t,e,n),a=function(){var t=o[u];i.forEachInExtent(t,(function(e){return se(e.extent,t)}))||(++r.loadingExtentsCount_,r.dispatchEvent(new Mw(pw)),r.loader_.call(r,t,e,n,(function(t){--r.loadingExtentsCount_,r.dispatchEvent(new Mw(dw,void 0,t))}),(function(){--r.loadingExtentsCount_,r.dispatchEvent(new Mw(vw))})),i.insert(t,{extent:t.slice()}))},u=0,s=o.length;u<s;++u)a();this.loading=!(this.loader_.length<4)&&this.loadingExtentsCount_>0}},{key:"refresh",value:function(){var t,n,r,i,o;this.clear(!0),this.loadedExtentsRtree_.clear(),(t=e,n="refresh",r=this,o=xw(Tw(1&(i=3)?t.prototype:t),n,r),2&i&&"function"==typeof o?function(t){return o.apply(r,t)}:o)([])}},{key:"removeLoadedExtent",value:function(t){var e,n=this.loadedExtentsRtree_;n.forEachInExtent(t,(function(n){if(ve(n.extent,t))return e=n,!0})),e&&n.remove(e)}},{key:"removeFeatures",value:function(t){for(var e=!1,n=0,r=t.length;n<r;++n)e=this.removeFeatureInternal(t[n])||e;e&&this.changed()}},{key:"removeFeature",value:function(t){t&&(this.removeFeatureInternal(t)&&this.changed())}},{key:"removeFeatureInternal",value:function(t){var e=nt(t);if(!(e in this.uidIndex_))return!1;e in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[e]:this.featuresRtree_&&this.featuresRtree_.remove(t);var n=this.featureChangeKeys_[e];null==n||n.forEach(K),delete this.featureChangeKeys_[e];var r=t.getId();if(void 0!==r){var i=r.toString(),o=this.idIndex_[i];o===t?delete this.idIndex_[i]:Array.isArray(o)&&(o.splice(o.indexOf(t),1),1===o.length&&(this.idIndex_[i]=o[0]))}return delete this.uidIndex_[e],this.hasListener(yw)&&this.dispatchEvent(new Mw(yw,t)),!0}},{key:"removeFromIdIndex_",value:function(t){for(var e in this.idIndex_)if(this.idIndex_[e]===t){delete this.idIndex_[e];break}}},{key:"setLoader",value:function(t){this.loader_=t}},{key:"setUrl",value:function(t){En(this.format_,"`format` must be set when `url` is set"),this.url_=t,this.setLoader(bw(t,this.format_))}}])}(Eg);function Aw(t){return(Aw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Fw(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Dw(r.key),r)}}function Dw(t){var e=function(t,e){if("object"!=Aw(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Aw(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Aw(e)?e:e+""}function Nw(t,e,n){return e=zw(e),function(t,e){if(e&&("object"==Aw(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],zw(t).constructor):e.apply(t,n))}function zw(t){return(zw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Bw(t,e){return(Bw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Gw="element",Ww="map",Xw="offset",Yw="position",Kw="positioning",Zw=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Nw(this,e)).on,n.once,n.un,n.options=t,n.id=t.id,n.insertFirst=void 0===t.insertFirst||t.insertFirst,n.stopEvent=void 0===t.stopEvent||t.stopEvent,n.element=document.createElement("div"),n.element.className=void 0!==t.className?t.className:"ol-overlay-container ol-selectable",n.element.style.position="absolute",n.element.style.pointerEvents="auto",n.autoPan=!0===t.autoPan?{}:t.autoPan||void 0,n.rendered={transform_:"",visible:!0},n.mapPostrenderListenerKey=null,n.addChangeListener(Gw,n.handleElementChanged),n.addChangeListener(Ww,n.handleMapChanged),n.addChangeListener(Xw,n.handleOffsetChanged),n.addChangeListener(Yw,n.handlePositionChanged),n.addChangeListener(Kw,n.handlePositioningChanged),void 0!==t.element&&n.setElement(t.element),n.setOffset(void 0!==t.offset?t.offset:[0,0]),n.setPositioning(t.positioning||"top-left"),void 0!==t.position&&n.setPosition(t.position),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Bw(t,e)}(e,t),n=e,(r=[{key:"getElement",value:function(){return this.get(Gw)}},{key:"getId",value:function(){return this.id}},{key:"getMap",value:function(){return this.get(Ww)||null}},{key:"getOffset",value:function(){return this.get(Xw)}},{key:"getPosition",value:function(){return this.get(Yw)}},{key:"getPositioning",value:function(){return this.get(Kw)}},{key:"handleElementChanged",value:function(){aa(this.element);var t=this.getElement();t&&this.element.appendChild(t)}},{key:"handleMapChanged",value:function(){var t;this.mapPostrenderListenerKey&&(null===(t=this.element)||void 0===t||t.remove(),K(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);var e=this.getMap();if(e){this.mapPostrenderListenerKey=X(e,pf,this.render,this),this.updatePixelPosition();var n=this.stopEvent?e.getOverlayContainerStopEvent():e.getOverlayContainer();this.insertFirst?n.insertBefore(this.element,n.childNodes[0]||null):n.appendChild(this.element),this.performAutoPan()}}},{key:"render",value:function(){this.updatePixelPosition()}},{key:"handleOffsetChanged",value:function(){this.updatePixelPosition()}},{key:"handlePositionChanged",value:function(){this.updatePixelPosition(),this.performAutoPan()}},{key:"handlePositioningChanged",value:function(){this.updatePixelPosition()}},{key:"setElement",value:function(t){this.set(Gw,t)}},{key:"setMap",value:function(t){this.set(Ww,t)}},{key:"setOffset",value:function(t){this.set(Xw,t)}},{key:"setPosition",value:function(t){this.set(Yw,t)}},{key:"performAutoPan",value:function(){this.autoPan&&this.panIntoView(this.autoPan)}},{key:"panIntoView",value:function(t){var e=this.getMap();if(e&&e.getTargetElement()&&this.get(Yw)){var n=this.getRect(e.getTargetElement(),e.getSize()),r=this.getElement(),i=this.getRect(r,[ra(r),ia(r)]),o=void 0===(t=t||{}).margin?20:t.margin;if(!se(n,i)){var a=i[0]-n[0],u=n[2]-i[2],s=i[1]-n[1],l=n[3]-i[3],c=[0,0];if(a<0?c[0]=a-o:u<0&&(c[0]=Math.abs(u)+o),s<0?c[1]=s-o:l<0&&(c[1]=Math.abs(l)+o),0!==c[0]||0!==c[1]){var f=e.getView().getCenterInternal(),h=e.getPixelFromCoordinateInternal(f);if(!h)return;var y=[h[0]+c[0],h[1]+c[1]],p=t.animation||{};e.getView().animateInternal({center:e.getCoordinateFromPixelInternal(y),duration:p.duration,easing:p.easing})}}}}},{key:"getRect",value:function(t,e){var n=t.getBoundingClientRect(),r=n.left+window.pageXOffset,i=n.top+window.pageYOffset;return[r,i,r+e[0],i+e[1]]}},{key:"setPositioning",value:function(t){this.set(Kw,t)}},{key:"setVisible",value:function(t){this.rendered.visible!==t&&(this.element.style.display=t?"":"none",this.rendered.visible=t)}},{key:"updatePixelPosition",value:function(){var t=this.getMap(),e=this.getPosition();if(t&&t.isRendered()&&e){var n=t.getPixelFromCoordinate(e),r=t.getSize();this.updateRenderedPosition(n,r)}else this.setVisible(!1)}},{key:"updateRenderedPosition",value:function(t,e){var n=this.element.style,r=this.getOffset(),i=this.getPositioning();this.setVisible(!0);var o=Math.round(t[0]+r[0])+"px",a=Math.round(t[1]+r[1])+"px",u="0%",s="0%";"bottom-right"==i||"center-right"==i||"top-right"==i?u="-100%":"bottom-center"!=i&&"center-center"!=i&&"top-center"!=i||(u="-50%"),"bottom-left"==i||"bottom-center"==i||"bottom-right"==i?s="-100%":"center-left"!=i&&"center-center"!=i&&"center-right"!=i||(s="-50%");var l="translate(".concat(u,", ").concat(s,") translate(").concat(o,", ").concat(a,")");this.rendered.transform_!=l&&(this.rendered.transform_=l,n.transform=l)}},{key:"getOptions",value:function(){return this.options}}])&&Fw(n.prototype,r),i&&Fw(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(yt);function Uw(t){return(Uw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vw(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */Vw=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",u=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function l(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,n){return t[e]=n}}function c(t,e,n,r){var o=e&&e.prototype instanceof v?e:v,a=Object.create(o.prototype),u=new C(r||[]);return i(a,"_invoke",{value:k(t,n,u)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var h="suspendedStart",y="executing",p="completed",d={};function v(){}function g(){}function m(){}var b={};l(b,a,(function(){return this}));var _=Object.getPrototypeOf,w=_&&_(_(T([])));w&&w!==n&&r.call(w,a)&&(b=w);var S=m.prototype=v.prototype=Object.create(b);function x(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function O(t,e){function n(i,o,a,u){var s=f(t[i],t,o);if("throw"!==s.type){var l=s.arg,c=l.value;return c&&"object"==Uw(c)&&r.call(c,"__await")?e.resolve(c.__await).then((function(t){n("next",t,a,u)}),(function(t){n("throw",t,a,u)})):e.resolve(c).then((function(t){l.value=t,a(l)}),(function(t){return n("throw",t,a,u)}))}u(s.arg)}var o;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return o=o?o.then(i,i):i()}})}function k(e,n,r){var i=h;return function(o,a){if(i===y)throw Error("Generator is already running");if(i===p){if("throw"===o)throw a;return{value:t,done:!0}}for(r.method=o,r.arg=a;;){var u=r.delegate;if(u){var s=P(u,r);if(s){if(s===d)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===h)throw i=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=y;var l=f(e,n,r);if("normal"===l.type){if(i=r.done?p:"suspendedYield",l.arg===d)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(i=p,r.method="throw",r.arg=l.arg)}}}function P(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,P(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var o=f(i,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,d;var a=o.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,d):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function T(e){if(e||""===e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(Uw(e)+" is not iterable")}return g.prototype=m,i(S,"constructor",{value:m,configurable:!0}),i(m,"constructor",{value:g,configurable:!0}),g.displayName=l(m,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,l(t,s,"GeneratorFunction")),t.prototype=Object.create(S),t},e.awrap=function(t){return{__await:t}},x(O.prototype),l(O.prototype,u,(function(){return this})),e.AsyncIterator=O,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new O(c(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},x(S),l(S,s,"Generator"),l(S,a,(function(){return this})),l(S,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(j),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return u.type="throw",u.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],u=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),l=r.call(a,"finallyLoc");if(s&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),j(n),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;j(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:T(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),d}},e}function qw(t,e,n,r,i,o,a){try{var u=t[o](a),s=u.value}catch(t){return void n(t)}u.done?e(s):Promise.resolve(s).then(r,i)}function Hw(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,u=[],s=!0,l=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=o.call(n)).done)&&(u.push(r.value),u.length!==e);s=!0);}catch(t){l=!0,i=t}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return u}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Jw(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Jw(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Jw(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}e.default=function(t){var e=Object(r.useRef)(),n=Object(r.useRef)();return Object(r.useEffect)((function(){var r=new vi({center:cn([t.longitude,t.latitude]),zoom:t.zoom}),i=new Gp({target:e.current,layers:[new ag({source:new Cm})],view:r});t.isInteractive?i.getInteractions().forEach((function(t){t.setActive(!0)})):i.getInteractions().forEach((function(t){t.setActive(!1)}));var o=new Lw,a=new X_({source:o});i.addLayer(a);var u=new Zw({element:n.current,positioning:"bottom-center",stopEvent:!1,offset:[0,-50]});i.addOverlay(u),t.pins&&t.pins.forEach((function(e){var r=new Fm({geometry:new Dr(cn([e.longitude,e.latitude])),label:e.label,description:e.description,data:e});r.setStyle(new mu({image:new Ru({anchor:[.5,1],src:"https://openlayers.org/en/v4.6.5/examples/data/icon.png"}),text:new Fu({text:e.label,offsetY:-25,fill:new au({color:"#000"}),stroke:new cu({color:"#fff",width:2})})})),o.addFeature(r),i.on("pointermove",(function(t){if(i.hasFeatureAtPixel(t.pixel)){var e=i.getFeaturesAtPixel(t.pixel)[0];if(e){var r=e.getGeometry().getCoordinates();n.current.innerHTML=e.get("description"),u.setPosition(r)}}else n.current.innerHTML="",u.setPosition(void 0)})),i.on("click",(function(e){if(i.hasFeatureAtPixel(e.pixel)){var n=i.getFeaturesAtPixel(e.pixel)[0];n&&t.onPinClicked(n.get("data"))}}))})),i.getView().on("moveend",(function(){var e=i.getView(),n=e.getZoom(),r=fn(e.getCenter());t.onViewChange({longitude:r[0],latitude:r[1],zoom:n})})),r.on("change:center",(function(){var e=fn(r.getCenter()),n=r.getZoom();t.onViewChange({longitude:e[0],latitude:e[1],zoom:n})})),r.on("change:resolution",(function(){var e=fn(r.getCenter()),n=r.getZoom();t.onViewChange({longitude:e[0],latitude:e[1],zoom:n})})),i.on("singleclick",(function(e){if(!i.hasFeatureAtPixel(e.pixel)){var n=Hw(fn(e.coordinate),2),r=n[0],o=n[1];t.onMapClick({longitude:r,latitude:o})}}));var s=function(){var t,e=(t=Vw().mark((function t(e,n){var r,i,a,u;return Vw().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("http://router.project-osrm.org/route/v1/driving/".concat(e[0],",").concat(e[1],";").concat(n[0],",").concat(n[1],"?overview=full&geometries=geojson"));case 2:return r=t.sent,t.next=5,r.json();case 5:i=t.sent,a=i.routes[0].geometry.coordinates.map((function(t){return cn(t)})),(u=new Fm({geometry:new nw(a)})).setStyle(new mu({stroke:new cu({color:"#ff0000",width:4})})),o.addFeature(u);case 10:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(t){qw(o,r,i,a,u,"next",t)}function u(t){qw(o,r,i,a,u,"throw",t)}a(void 0)}))});return function(t,n){return e.apply(this,arguments)}}();t.pointA&&t.pointB&&s([t.pointA.longitude,t.pointA.latitude],[t.pointB.longitude,t.pointB.latitude]);return function(){return i.setTarget(null)}}),[t]),i.a.createElement("div",{style:{width:"100%",height:"100%"}},i.a.createElement("div",{ref:e,style:{width:"100%",height:"500px"}}),i.a.createElement("div",{ref:n,className:"ol-popup",style:{position:"absolute",backgroundColor:"white",padding:"5px",borderRadius:"5px"}}))}}]);
//# sourceMappingURL=index.js.map